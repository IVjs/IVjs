{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///../node_modules/happy-helpers/lib/main.js","webpack:///../node_modules/mobile-detector/index.js","webpack:///../node_modules/eventemitter3/index.js","webpack:///../node_modules/tslib/tslib.es6.js","webpack:///./lib/command-engine/command-engine.ts","webpack:///./lib/config.ts","webpack:///./test-support/dom-commands.ts","webpack:///./lib/utils.ts","webpack:///./lib/partial-liquid.ts","webpack:///./lib/command-engine/command-runner.ts","webpack:///./lib/command-engine/switch.ts","webpack:///./lib/command-engine/create-engine.ts","webpack:///./lib/node.ts","webpack:///./lib/base-iv.ts","webpack:///./lib/plugins/dom-commands/video/video-commands-builder.ts","webpack:///./lib/plugins/dom-commands/video/video-controller.ts","webpack:///./lib/plugins/dom-commands/video/play-video.ts","webpack:///./lib/plugins/dom-commands/video/clear-video.ts","webpack:///./lib/plugins/dom-commands/video/index.ts","webpack:///./lib/plugins/dom-commands/audio/audio-controller.ts","webpack:///./lib/plugins/dom-commands/audio/index.ts","webpack:///./lib/plugins/dom-commands/audio/audio-commands.ts","webpack:///./lib/plugins/dom-commands/buttons/button-commands-builder.ts","webpack:///./lib/plugins/dom-commands/buttons/buttons-controller.ts","webpack:///./lib/plugins/dom-commands/buttons/button-commands.ts","webpack:///./lib/plugins/dom-commands/buttons/index.ts","webpack:///./lib/plugins/general-commands/variable-modification/calculate.ts","webpack:///./lib/plugins/general-commands/variable-modification/index.ts","webpack:///./lib/plugins/general-commands/variable-modification/set-variable.ts","webpack:///./lib/plugins/general-commands/variable-modification/get-random-number.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/index.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/execution-requests.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/execute-sync.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/execute-async.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/go-to-node.ts","webpack:///./lib/plugins/general-commands/execution-modifiers/wait.ts","webpack:///./lib/command-engine/log-commands/log.ts","webpack:///./lib/command-engine/unserializable-commands/execute-js.ts","webpack:///./lib/iv.ts","webpack:///./entry.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","toType","val","toString","match","toLowerCase","clone","obj","JSON","parse","stringify","isEmpty","type","indexOf","length","getOwnPropertyNames","isObject","x","traverseObject","callback","recursive","preserveOriginal","newObject","returnedObj","argsMinusFirst","Array","from","arguments","slice","recursedObject","apply","this","concat","keyValArray","isArray","Error","nestedPropertyDetails","propertyPath","pathParts","split","currentObject","exists","existingPath","newPart","shift","push","join","finalValidProperty","changePropsInitialCase","whichCase","makeAspVersion","newObj","regex","prop","originals","charAt","firstCharToUpper","firstCharToLower","str","toUpperCase","valuesArrayFromObject","keys","map","objectContainsValue","round","decimals","Number","Math","isNotEmpty","wrapObjectWithProperty","propName","wrapper","nestedPropertyTest","details","nestedPropertyExists","convertPropKeysForAsp","convertPropKeysForJs","objectKeyForValue","reduce","currentKey","forceArray","noCircularRefs","valCache","keyCache","isFirstRun","indexOfFoundValue","options","settings","assign","tabLength","stripQuotes","sort","finalStringification","newObj_1","forEach","replace","deepEqual","objA","objB","stringifyOptions","mediaWidth","max","document","documentElement","clientWidth","innerWidth","mediaHeight","clientHeight","innerHeight","nav","isMobile","check","test","substr","isMobileOrTablet","navigator","userAgent","vendor","opera","has","prefix","Events","addListener","emitter","event","fn","context","once","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","events","names","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","len","removeListener","undefined","j","on","removeAllListeners","off","prefixed","extendStatics","b","setPrototypeOf","__extends","__","constructor","__assign","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","iterator","v","op","pop","IvCommandEngine","nodes","commandRunnerClass","variables","targetFunctions","runners","registerTargetFunction","input","commandEngine","run","createRunners","runNodeByName","runFirstNode","runCommands","commands","createCommandRunner","_this","node","getCommands","getRunnerForNode","defaults","baseElementId","buttonContainerClass","qsaToArray","qsa","index","outArray","getRandomInt","min","floor","random","nearClone","main","safeCloneObject","outgoing","sanitizeUrl","url","location","protocol","origin","partial_liquid_PartialLiquid","PartialLiquid","LIQUID_ONE","LIQUID_ALL","RegExp","implementedFilters","randomFilter","parts","getParts","whole","sendRawVar","replaceAsString","substring","filteredVariable","matches","varName","filter","variable","_a","doFilter","method","values","command_runner_CommandRunner","CommandRunner","eventemitter3","targets","runQueue","nextIndex","replacer","setStatus","getFunctionFor","canRun","doRun","enqueueRun","runNextCommand","willRun","status","resetIndex","advanceIndex","cmd","runCommand","cmdReturn","evaluateReturn","exit","theReturn","requests","asyncCommands","asyncSeries","runNewSeries","evaluateRequests","some","pause","runImmediately","eventualCommands","catch","err","beginningMessage","message","console","error","res","runner","incomingCommand","replaceVariables","targetFunction","incoming","replaceVariableInString","switchFactory","switch","given","winningCommands","do","condition","operator","singleDo","operatorFunctions","unusedProps","unusedProp","determineOperator","operand","opFunc","checkCondition","winningCommandsOrNull","defaultCommands","doSwitch","is","isGreaterThan","isLessThan","isGreaterThanOrEqualTo","isLessThanOrEqualTo","isBetween","arr","lowest","highest","createBaseEngine","engineConstructorInput","functionFactories","_i","engine","Node","pushType","pusher","command","switchDo","pushCommands","if","optionsObj","var","else","endIf","base_iv_BaseIV","BaseIV","initialState","defaultSettings","baseContainer","getElementById","baseVideoUrl","bgAudioUrl","bgAudioLoop","nodeKlassReference","additionalFactories","defineNode","validateDom","extend","registrations","newNodeKlass","_super","class_1","nodeKlass","targetFunctionFactories","plugin","pr","apiExtensions","isApiRegistration","extension","apiName","apiFn","isTargetFnRegistration","class_2","newNode","runOnAnyPlatform","getEngine","createRunButton","btn","createKickoffButton","runViaButton","getSettings","getSetting","mobile_detector","startBtn","createElement","id","innerHTML","appendChild","handleClick","removeEventListener","prepVideosForMobile","remove","addEventListener","querySelectorAll","vid","play","video_commands_builder_VideoCommandsBuilder","VideoCommandsBuilder","playVideo","handleDepricatedArrayInput","handleArrayInput","clearVideo","time","array","warn","objOrStr","guaranteedOptionsObject","mergeMissingUrlsReducer","vo","createPlayCommandFromOptions","reduceRight","reduceOnCompleteIntoPrevious","current","lastObj","onComplete","singleInput","remappedProps","file","commandProps","commandOptionsToCommands","inputObj","addCommands","runAsync","nodeName","js","func","runSync","goTo","createVideoPlayer","player","setAttribute","style","display","videoController","VideoController","baseElement","isFirstPlay","players","standby","getStandbyPlayer","getCurrentPlayer","onloadeddata","src","load","whenPlayerEnds","onEnded","createPlayers","attachPlayers","videoCommandBuilder","clear_video_videoCommandBuilder","videoPlugin","baseEl","videoToPlay","onPlayerEnd","returnObj","completing","rej","url1","url2","urlsMatch","createAudioPlayer","audioController","AudioController","_fadeInterval","bg","sfx","playerName","getPlayerNamed","whenPlayerLoads","loop","volume","fadeOverTime","desiredVolume","startTime","Date","now","startVolume","totalAdjustment","currentPercent","traveled","percentComplete","setTimeout","wait","getBgPlayer","getSfxPlayer","audioCommandsRegistration","target","action","bgAudioCommand","audioVolume","audioSource","ButtonCommandsBuilder","addButton","text","onClick","createCommands","removeAllButtons","buttonsController","ButtonsController","allButtons","createButton","element","button","newButton","addToButtonStore","appendToDocument","removeButton","applySettingsToButton","attrs","onclick","parentEl","getContainer","parent","foundContainer","selector","oldClass","getAttribute","parentNode","directDescendants","newContainer","buttonCommands","buttonsPlugin","operations","add","val1","val2","subtract","multiply","divide","divideThenRemainder","divideThenRoundDown","divideThenRoundUp","ceil","divideThenRound","roundUp","roundDown","variableManipulationPlugin","objSettings","assignTo","storeIn","received","operation","assignVariable","assignFromVariable","calculate","startingValue","theOperation","getOperation","doCalculate","getRandomNumber","executionModifiersPlugin","buildGoToNodeCommandSet","stopExecution","pauseExecution","executeAsync","executeSync","goToNode","logRegistration","anything","log","jsRegistration","executeJs","IV","__webpack_exports__"],"mappings":"CAAA,SAAAA,EAAAC,GACA,oBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,SACA,sBAAAG,eAAAC,IACAD,UAAAH,OACA,CACA,IAAAK,EAAAL,IACA,QAAAM,KAAAD,GAAA,iBAAAJ,gBAAAF,GAAAO,GAAAD,EAAAC,IAPA,CASCC,OAAA,WACD,mBCTA,IAAAC,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAT,QAGA,IAAAC,EAAAM,EAAAE,IACAJ,EAAAI,EACAC,GAAA,EACAV,YAUA,OANAW,EAAAF,GAAAG,KAAAX,EAAAD,QAAAC,IAAAD,QAAAQ,GAGAP,EAAAS,GAAA,EAGAT,EAAAD,QA0DA,OArDAQ,EAAAK,EAAAF,EAGAH,EAAAM,EAAAP,EAGAC,EAAAO,EAAA,SAAAf,EAAAgB,EAAAC,GACAT,EAAAU,EAAAlB,EAAAgB,IACAG,OAAAC,eAAApB,EAAAgB,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CT,EAAAe,EAAA,SAAAvB,GACA,oBAAAwB,eAAAC,aACAN,OAAAC,eAAApB,EAAAwB,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAApB,EAAA,cAAiD0B,OAAA,KAQjDlB,EAAAmB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAlB,EAAAkB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAvB,EAAAe,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAlB,EAAAO,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAtB,EAAA0B,EAAA,SAAAjC,GACA,IAAAgB,EAAAhB,KAAA4B,WACA,WAA2B,OAAA5B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAO,EAAAO,EAAAE,EAAA,IAAAA,GACAA,GAIAT,EAAAU,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD5B,EAAA+B,EAAA,GAIA/B,IAAAgC,EAAA,kCC9DA,SAAAC,EAAAC,GACA,SAAcC,SAAA/B,KAAA8B,GAAAE,MAAA,oBAAAC,cAQd,SAAAC,EAAAC,GACA,OAAAC,KAAAC,MAAAD,KAAAE,UAAAH,IAGA,SAAAI,EAAAT,GACA,IAEAU,EAAAX,EAAAC,GACA,OAHA,oBAGAW,QAAAD,IAAA,IAFA,8CAKAC,QAAAD,IAAA,IACA,WAAAA,EACA,IAAAV,EAAAY,OACA,IAAAnC,OAAAoC,oBAAAb,GAAAY,QAEA,IAAAZ,EAAAY,QAkBA,SAAAE,EAAAC,GACA,iBAAAhB,EAAAgB,GAMA,SAAAC,EAAAX,EAAAY,EAAAC,EAAAC,QACA,IAAAD,IAA+BA,GAAA,QAC/B,IAAAC,IAAsCA,GAAA,GACtC,IAAAC,EAAAD,EAAAf,EAAAC,KACAgB,KACA,QAAA/B,KAAA8B,EACA,QAAAA,EAAAxB,eAAAN,GAAA,CAEA,GAAAwB,EAAAM,EAAA9B,KAAA4B,EAAA,CACA,IACAI,EADAC,MAAAC,KAAAC,WACAC,cAAA,GACAC,EAAAX,EAAAY,MAAAC,MAAAT,EAAA9B,IAAAwC,OAAAR,IACAb,EAAAkB,KACAP,EAAA9B,GAAAqC,GAGA,IAAAI,EAAAd,EAAA3B,EAAA8B,EAAA9B,IACA,GAAAiC,MAAAS,QAAAD,IAAA,IAAAA,EAAAnB,OACAS,EAAAU,EAAA,IAAAA,EAAA,QAEA,IAAAtB,EAAAsB,GACA,UAAAE,MAAA,iKAAAF,GAGA,OAAAV,EAGA,SAAAa,EAAA7B,EAAA8B,GAKA,IAJA,IAAAC,EAAAD,EAAAE,MAAA,KACAC,EAAAjC,EACAkC,GAAA,EACAC,KACAD,GAAAH,EAAAxB,OAAA,IACA,IAAA6B,EAAAL,EAAAM,QACAD,GAAAH,EAAAG,IACAD,EAAAG,KAAAF,GACAH,IAAAG,IAGAF,GAAA,EAGA,OACAA,SACAC,eAAAI,KAAA,KACAC,mBAAAP,GAgBA,SAAAQ,EAAAzC,EAAA0C,EAAA7B,EAAAC,QACA,IAAAD,IAA+BA,GAAA,QAC/B,IAAAC,IAAsCA,GAAA,GACtC,IAAA6B,EAAA,eAAAD,EACAE,EAAA9B,EAAAf,EAAAC,KACA6C,EAAAF,EAAA,gBACA,OAAAhC,EAAAiC,EAAA,SAAA3D,EAAA6D,GACA,IAAAC,GAAA9D,EAAA6D,GACA,uBAAA7D,EACA8D,EACA,OAAA9D,EAAA+D,OAAA,GAAAnD,MAAAgD,GACAE,GACAJ,EAAAM,EAAAhE,GAAAiE,EAAAjE,GACA6D,IACKjC,GAGL,SAAAoC,EAAAE,GACA,OAAAA,EAAAH,OAAA,GAAAI,cAAAD,EAAA9B,MAAA,GAGA,SAAA6B,EAAAC,GACA,OAAAA,EAAAH,OAAA,GAAAlD,cAAAqD,EAAA9B,MAAA,GAWA,SAAAgC,EAAArD,GACA,IAAAS,EAAAT,GACA,UAAA4B,MAAA,gCAAAlC,EAAAM,IAEA,OAAA5B,OAAAkF,KAAAtD,GAAAuD,IAAA,SAAAtE,GAAgD,OAAAe,EAAAf,KAGhD,SAAAuE,EAAA7D,EAAAK,GACA,WAAAqD,EAAArD,GAAAM,QAAAX,GA3KAvB,OAAAC,eAAApB,EAAA,cAA8C0B,OAAA,IAsB9C1B,EAAAyC,SAKAzC,EAAAwG,MAJA,SAAA9E,EAAA+E,GAEA,YADA,IAAAA,IAA8BA,EAAA,GAC9BC,OAAAC,KAAAH,MAAAE,OAAAhF,EAAA,IAAA+E,IAAA,KAAAA,IAMAzG,EAAA8C,QAkBA9C,EAAAmD,UAIAnD,EAAA4G,WAHA,SAAAlE,GACA,OAAAS,EAAAT,IAUA1C,EAAA6G,uBAPA,SAAA9D,EAAA+D,EAAAjD,QACA,IAAAA,IAAsCA,GAAA,GACtC,IAAAkD,KACApB,EAAA9B,EAAAf,EAAAC,KAEA,OADAgE,EAAAD,GAAAnB,EACAoB,GAMA/G,EAAAwD,WA8BAxD,EAAA0D,iBAsBA1D,EAAA4E,wBAQA5E,EAAAgH,mBAPA,SAAAjE,EAAA8B,EAAAlB,GACA,IAAAsD,EAAArC,EAAA7B,EAAA8B,GACA,QAAAoC,EAAAhC,UACAtB,EAAAsD,EAAA1B,qBAQAvF,EAAAkH,qBAHA,SAAAnE,EAAA8B,GACA,OAAAD,EAAA7B,EAAA8B,GAAAI,QAmBAjF,EAAAwF,yBAIAxF,EAAAgG,mBAIAhG,EAAAiG,mBAIAjG,EAAAmH,sBAHA,SAAApE,GACA,OAAAyC,EAAAzC,EAAA,kBAMA/C,EAAAoH,qBAHA,SAAArE,GACA,OAAAyC,EAAAzC,EAAA,kBASA/C,EAAAoG,wBAIApG,EAAAuG,sBAWAvG,EAAAqH,kBAVA,SAAA3E,EAAAK,GACA,QAAAwD,EAAA7D,EAAAK,IAEA5B,OAAAkF,KAAAtD,GAAAuE,OAAA,SAAAlH,EAAAmH,GAIA,OAHAxE,EAAAwE,KAAA7E,IACAtC,EAAAmH,GAEAnH,GACK,KAYLJ,EAAAwH,WATA,SAAA9E,GAEA,YADA,oBACAW,QAAAZ,EAAAC,OAEA,UAAAD,EAAAC,IACAA,GAEAA,GAGA,IAAA+E,EAAA,WACA,IAAAC,KACAC,KACAC,GAAA,EACA,gBAAA5F,EAAAN,GACA,oBAAAA,GAAA,OAAAA,EAAA,CACAkG,IACA5F,EAAA,kBACA4F,GAAA,GAEA,IAAAC,EAAAH,EAAArE,QAAA3B,GACA,QAAAmG,EAEA,gCAAAF,EAAAE,GAAA,IAGAH,EAAArC,KAAA3D,GACAiG,EAAAtC,KAAArD,GAEA,OAAAN,IAGA,SAAAwB,EAAAH,EAAA+E,QACA,IAAAA,IAA6BA,MAC7B,IAKAC,EAAA5G,OAAA6G,WAJAC,UAAA,EACAC,aAAA,EACAC,MAAA,GAEmCL,GACnCG,EAAAF,EAAAE,UAAAC,EAAAH,EAAAG,YACA,GADAH,EAAAI,KACA,CACA,aAAA1F,EAAAM,GAEA,OAAAqF,EADArF,EAAAoF,OACAF,EAAAC,GAEA,cAAAzF,EAAAM,GAAA,CACA,IAAAsF,KAKA,OAJAlH,OAAAkF,KAAAtD,GAAAoF,OACAG,QAAA,SAAAtG,GACAqG,EAAArG,GAAAe,EAAAf,KAEAoG,EAAAC,EAAAJ,EAAAC,GAEA,OAAAE,EAAArF,EAAAkF,EAAAC,GAEA,OAAAE,EAAArF,EAAAkF,EAAAC,GAGA,SAAAE,EAAArF,EAAAkF,EAAAC,GACA,IAAAhC,EAAAlD,KAAAE,UAAAH,EAAA0E,IAAAQ,GAIA,OAHAC,IACAhC,IAAAqC,QAAA,sBAEArC,EANAlG,EAAAkD,YAeAlD,EAAAwI,UAJA,SAAAC,EAAAC,GACA,IAAAC,GAA4BR,MAAA,GAC5B,OAAAjF,EAAAuF,EAAAE,KAAAzF,EAAAwF,EAAAC,IAUA3I,EAAA4I,WAHA,WACA,OAAAjC,KAAAkC,IAAAC,SAAAC,gBAAAC,YAAA1I,OAAA2I,YAAA,IAMAjJ,EAAAkJ,YAHA,WACA,OAAAvC,KAAAkC,IAAAC,SAAAC,gBAAAI,aAAA7I,OAAA8I,aAAA,mBC7QAnJ,EAAAD,QAAA,SAAAqJ,GAiBA,OAhBAC,SAAA,WACA,IAAAC,GAAA,EAIA,OAFA,2TAAAC,KAAAH,IAAA,0kDAAAG,KAAAH,EAAAI,OAAA,SACAF,GAAA,GACAA,GAGAG,iBAAA,WACA,IAAAH,GAAA,EAIA,OAFA,sVAAAC,KAAAH,IAAA,0kDAAAG,KAAAH,EAAAI,OAAA,SACAF,GAAA,GACAA,IAIAD,kBACAI,mCAnBA,CAsBCC,UAAAC,WAAAD,UAAAE,QAAAvJ,OAAAwJ,qCCpBD,IAAAC,EAAA5I,OAAAkB,UAAAC,eACA0H,EAAA,IASA,SAAAC,KA6CA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACA,sBAAAF,EACA,UAAAG,UAAA,mCAGA,IAAAC,EAAA,IAtBA,SAAAJ,EAAAC,EAAAC,GACAhG,KAAA8F,KACA9F,KAAA+F,UACA/F,KAAAgG,SAAA,EAmBA,CAAAF,EAAAC,GAAAH,EAAAI,GACAG,EAAAV,IAAAI,IAMA,OAJAD,EAAAQ,QAAAD,GACAP,EAAAQ,QAAAD,GAAAL,GACAF,EAAAQ,QAAAD,IAAAP,EAAAQ,QAAAD,GAAAD,GADAN,EAAAQ,QAAAD,GAAArF,KAAAoF,IADAN,EAAAQ,QAAAD,GAAAD,EAAAN,EAAAS,gBAIAT,EAUA,SAAAU,EAAAV,EAAAO,GACA,KAAAP,EAAAS,aAAAT,EAAAQ,QAAA,IAAAV,SACAE,EAAAQ,QAAAD,GAUA,SAAAI,IACAvG,KAAAoG,QAAA,IAAAV,EACA1F,KAAAqG,aAAA,EAxEAzJ,OAAAY,SACAkI,EAAA5H,UAAAlB,OAAAY,OAAA,OAMA,IAAAkI,GAAAc,YAAAf,GAAA,IA2EAc,EAAAzI,UAAA2I,WAAA,WACA,IACAC,EACAjK,EAFAkK,KAIA,OAAA3G,KAAAqG,aAAA,OAAAM,EAEA,IAAAlK,KAAAiK,EAAA1G,KAAAoG,QACAZ,EAAAnJ,KAAAqK,EAAAjK,IAAAkK,EAAA7F,KAAA2E,EAAAhJ,EAAAoD,MAAA,GAAApD,GAGA,OAAAG,OAAAgK,sBACAD,EAAA1G,OAAArD,OAAAgK,sBAAAF,IAGAC,GAUAJ,EAAAzI,UAAA+I,UAAA,SAAAhB,GACA,IAAAM,EAAAV,IAAAI,IACAiB,EAAA9G,KAAAoG,QAAAD,GAEA,IAAAW,EAAA,SACA,GAAAA,EAAAhB,GAAA,OAAAgB,EAAAhB,IAEA,QAAAhK,EAAA,EAAAK,EAAA2K,EAAA/H,OAAAgI,EAAA,IAAArH,MAAAvD,GAAyDL,EAAAK,EAAOL,IAChEiL,EAAAjL,GAAAgL,EAAAhL,GAAAgK,GAGA,OAAAiB,GAUAR,EAAAzI,UAAAkJ,cAAA,SAAAnB,GACA,IAAAM,EAAAV,IAAAI,IACAgB,EAAA7G,KAAAoG,QAAAD,GAEA,OAAAU,EACAA,EAAAf,GAAA,EACAe,EAAA9H,OAFA,GAYAwH,EAAAzI,UAAAmJ,KAAA,SAAApB,EAAAqB,EAAAC,EAAAC,EAAAC,EAAAC,GACA,IAAAnB,EAAAV,IAAAI,IAEA,IAAA7F,KAAAoG,QAAAD,GAAA,SAEA,IAEAoB,EACAzL,EAHA+K,EAAA7G,KAAAoG,QAAAD,GACAqB,EAAA5H,UAAAb,OAIA,GAAA8H,EAAAf,GAAA,CAGA,OAFAe,EAAAb,MAAAhG,KAAAyH,eAAA5B,EAAAgB,EAAAf,QAAA4B,GAAA,GAEAF,GACA,cAAAX,EAAAf,GAAAzJ,KAAAwK,EAAAd,UAAA,EACA,cAAAc,EAAAf,GAAAzJ,KAAAwK,EAAAd,QAAAmB,IAAA,EACA,cAAAL,EAAAf,GAAAzJ,KAAAwK,EAAAd,QAAAmB,EAAAC,IAAA,EACA,cAAAN,EAAAf,GAAAzJ,KAAAwK,EAAAd,QAAAmB,EAAAC,EAAAC,IAAA,EACA,cAAAP,EAAAf,GAAAzJ,KAAAwK,EAAAd,QAAAmB,EAAAC,EAAAC,EAAAC,IAAA,EACA,cAAAR,EAAAf,GAAAzJ,KAAAwK,EAAAd,QAAAmB,EAAAC,EAAAC,EAAAC,EAAAC,IAAA,EAGA,IAAAxL,EAAA,EAAAyL,EAAA,IAAA7H,MAAA8H,EAAA,GAAyC1L,EAAA0L,EAAS1L,IAClDyL,EAAAzL,EAAA,GAAA8D,UAAA9D,GAGA+K,EAAAf,GAAA/F,MAAA8G,EAAAd,QAAAwB,OACG,CACH,IACAI,EADA5I,EAAA8H,EAAA9H,OAGA,IAAAjD,EAAA,EAAeA,EAAAiD,EAAYjD,IAG3B,OAFA+K,EAAA/K,GAAAkK,MAAAhG,KAAAyH,eAAA5B,EAAAgB,EAAA/K,GAAAgK,QAAA4B,GAAA,GAEAF,GACA,OAAAX,EAAA/K,GAAAgK,GAAAzJ,KAAAwK,EAAA/K,GAAAiK,SAA2D,MAC3D,OAAAc,EAAA/K,GAAAgK,GAAAzJ,KAAAwK,EAAA/K,GAAAiK,QAAAmB,GAA+D,MAC/D,OAAAL,EAAA/K,GAAAgK,GAAAzJ,KAAAwK,EAAA/K,GAAAiK,QAAAmB,EAAAC,GAAmE,MACnE,OAAAN,EAAA/K,GAAAgK,GAAAzJ,KAAAwK,EAAA/K,GAAAiK,QAAAmB,EAAAC,EAAAC,GAAuE,MACvE,QACA,IAAAG,EAAA,IAAAI,EAAA,EAAAJ,EAAA,IAAA7H,MAAA8H,EAAA,GAA0DG,EAAAH,EAASG,IACnEJ,EAAAI,EAAA,GAAA/H,UAAA+H,GAGAd,EAAA/K,GAAAgK,GAAA/F,MAAA8G,EAAA/K,GAAAiK,QAAAwB,IAKA,UAYAhB,EAAAzI,UAAA8J,GAAA,SAAA/B,EAAAC,EAAAC,GACA,OAAAJ,EAAA3F,KAAA6F,EAAAC,EAAAC,GAAA,IAYAQ,EAAAzI,UAAAkI,KAAA,SAAAH,EAAAC,EAAAC,GACA,OAAAJ,EAAA3F,KAAA6F,EAAAC,EAAAC,GAAA,IAaAQ,EAAAzI,UAAA2J,eAAA,SAAA5B,EAAAC,EAAAC,EAAAC,GACA,IAAAG,EAAAV,IAAAI,IAEA,IAAA7F,KAAAoG,QAAAD,GAAA,OAAAnG,KACA,IAAA8F,EAEA,OADAQ,EAAAtG,KAAAmG,GACAnG,KAGA,IAAA6G,EAAA7G,KAAAoG,QAAAD,GAEA,GAAAU,EAAAf,GAEAe,EAAAf,QACAE,IAAAa,EAAAb,MACAD,GAAAc,EAAAd,aAEAO,EAAAtG,KAAAmG,OAEG,CACH,QAAArK,EAAA,EAAA4K,KAAA3H,EAAA8H,EAAA9H,OAA2DjD,EAAAiD,EAAYjD,KAEvE+K,EAAA/K,GAAAgK,QACAE,IAAAa,EAAA/K,GAAAkK,MACAD,GAAAc,EAAA/K,GAAAiK,cAEAW,EAAA5F,KAAA+F,EAAA/K,IAOA4K,EAAA3H,OAAAiB,KAAAoG,QAAAD,GAAA,IAAAO,EAAA3H,OAAA2H,EAAA,GAAAA,EACAJ,EAAAtG,KAAAmG,GAGA,OAAAnG,MAUAuG,EAAAzI,UAAA+J,mBAAA,SAAAhC,GACA,IAAAM,EAUA,OARAN,GACAM,EAAAV,IAAAI,IACA7F,KAAAoG,QAAAD,IAAAG,EAAAtG,KAAAmG,KAEAnG,KAAAoG,QAAA,IAAAV,EACA1F,KAAAqG,aAAA,GAGArG,MAMAuG,EAAAzI,UAAAgK,IAAAvB,EAAAzI,UAAA2J,eACAlB,EAAAzI,UAAA6H,YAAAY,EAAAzI,UAAA8J,GAKArB,EAAAwB,SAAAtC,EAKAc,iBAMA7K,EAAAD,QAAA8K;;;;;;;;;;;;;;oFC9TAyB,EAAA,SAAAxL,EAAAyL,GAIA,OAHAD,EAAApL,OAAAsL,iBACU1B,wBAAgB9G,OAAA,SAAAlD,EAAAyL,GAAsCzL,EAAAgK,UAAAyB,IAChE,SAAAzL,EAAAyL,GAAyB,QAAAjK,KAAAiK,IAAAlK,eAAAC,KAAAxB,EAAAwB,GAAAiK,EAAAjK,MACzBxB,EAAAyL,IAGO,SAAAE,EAAA3L,EAAAyL,GAEP,SAAAG,IAAmBpI,KAAAqI,YAAA7L,EADnBwL,EAAAxL,EAAAyL,GAEAzL,EAAAsB,UAAA,OAAAmK,EAAArL,OAAAY,OAAAyK,IAAAG,EAAAtK,UAAAmK,EAAAnK,UAAA,IAAAsK,GAGO,IAAAE,EAAA,WAQP,OAPAA,EAAA1L,OAAA6G,QAAA,SAAArG,GACA,QAAAa,EAAAnC,EAAA,EAAA6B,EAAAiC,UAAAb,OAAgDjD,EAAA6B,EAAO7B,IAEvD,QAAAkC,KADAC,EAAA2B,UAAA9D,GACAc,OAAAkB,UAAAC,eAAA1B,KAAA4B,EAAAD,KAAAZ,EAAAY,GAAAC,EAAAD,IAEA,OAAAZ,IAEA2C,MAAAC,KAAAJ,YA4BO,SAAA2I,EAAAC,EAAAC,EAAAC,EAAAC,GACP,WAAAD,MAAAE,UAAA,SAAAC,EAAAC,GACA,SAAAC,EAAA5L,GAAmC,IAAM6L,EAAAL,EAAAM,KAAA9L,IAA+B,MAAA+L,GAAYJ,EAAAI,IACpF,SAAAC,EAAAhM,GAAkC,IAAM6L,EAAAL,EAAA,MAAAxL,IAAmC,MAAA+L,GAAYJ,EAAAI,IACvF,SAAAF,EAAAI,GAA+BA,EAAAC,KAAAR,EAAAO,EAAAjM,OAAA,IAAAuL,EAAA,SAAAG,GAAiEA,EAAAO,EAAAjM,SAAyBmM,KAAAP,EAAAI,GACzHH,GAAAL,IAAA5I,MAAAyI,EAAAC,QAAAQ,UAIO,SAAAM,EAAAf,EAAAgB,GACP,IAAwGC,EAAAC,EAAAtM,EAAAuM,EAAxGC,GAAaC,MAAA,EAAAC,KAAA,WAA6B,KAAA1M,EAAA,SAAAA,EAAA,GAA0B,OAAAA,EAAA,IAAe2M,QAAAC,QACnF,OAAAL,GAAgBV,KAAAgB,EAAA,GAAAC,MAAAD,EAAA,GAAAE,OAAAF,EAAA,IAAqD,mBAAAhN,SAAA0M,EAAA1M,OAAAmN,UAAA,WAAoE,OAAApK,OAAe2J,EACxJ,SAAAM,EAAAtM,GAAsB,gBAAA0M,GAAsB,OAC5C,SAAAC,GACA,GAAAb,EAAA,UAAAxD,UAAA,mCACA,KAAA2D,GAAA,IACA,GAAAH,EAAA,EAAAC,IAAAtM,EAAA,EAAAkN,EAAA,GAAAZ,EAAA,OAAAY,EAAA,GAAAZ,EAAA,SAAAtM,EAAAsM,EAAA,SAAAtM,EAAAf,KAAAqN,GAAA,GAAAA,EAAAT,SAAA7L,IAAAf,KAAAqN,EAAAY,EAAA,KAAAjB,KAAA,OAAAjM,EAEA,OADAsM,EAAA,EAAAtM,IAAAkN,GAAA,EAAAA,EAAA,GAAAlN,EAAAD,QACAmN,EAAA,IACA,cAAAlN,EAAAkN,EAAuC,MACvC,OAAkC,OAAlCV,EAAAC,SAA2C1M,MAAAmN,EAAA,GAAAjB,MAAA,GAC3C,OAAAO,EAAAC,QAAkCH,EAAAY,EAAA,GAAWA,GAAA,GAAU,SACvD,OAAAA,EAAAV,EAAAI,IAAAO,MAAyCX,EAAAG,KAAAQ,MAAc,SACvD,QACA,KAAAnN,KAAAwM,EAAAG,MAAAhL,OAAA,GAAA3B,IAAA2B,OAAA,UAAAuL,EAAA,QAAAA,EAAA,KAA6GV,EAAA,EAAO,SACpH,OAAAU,EAAA,MAAAlN,GAAAkN,EAAA,GAAAlN,EAAA,IAAAkN,EAAA,GAAAlN,EAAA,KAAgFwM,EAAAC,MAAAS,EAAA,GAAiB,MACjG,OAAAA,EAAA,IAAAV,EAAAC,MAAAzM,EAAA,IAAwDwM,EAAAC,MAAAzM,EAAA,GAAgBA,EAAAkN,EAAQ,MAChF,GAAAlN,GAAAwM,EAAAC,MAAAzM,EAAA,IAA8CwM,EAAAC,MAAAzM,EAAA,GAAgBwM,EAAAI,IAAAlJ,KAAAwJ,GAAgB,MAC9ElN,EAAA,IAAAwM,EAAAI,IAAAO,MACAX,EAAAG,KAAAQ,MAAiC,SAEjCD,EAAAd,EAAAnN,KAAAmM,EAAAoB,GACS,MAAAV,GAAYoB,GAAA,EAAApB,GAAaQ,EAAA,EAAS,QAAUD,EAAArM,EAAA,EACrD,KAAAkN,EAAA,SAAAA,EAAA,GAAmC,OAASnN,MAAAmN,EAAA,GAAAA,EAAA,UAAAjB,MAAA,GArBAL,EAAArL,EAAA0M,iBC7E5CG,EAAA,WAIE,SAAAA,EACUhH,EACAiH,EACAC,EACAC,GAHA3K,KAAAwD,WACAxD,KAAAyK,QACAzK,KAAA0K,qBACA1K,KAAA2K,YAPF3K,KAAA4K,mBACA5K,KAAA6K,WAwDV,OA/CSL,EAAA1M,UAAAgN,uBAAP,SAA8BtP,GAC5B,IAAMuP,GAAUvH,SAAUxD,KAAKwD,SAAWmH,UAAW3K,KAAK2K,UAAYK,cAAehL,MACrFpD,OAAO6G,OAAOzD,KAAK4K,gBAAiBpP,EAAQuP,KAGvCP,EAAA1M,UAAAmN,IAAP,SAAWxO,GACTuD,KAAKkL,gBACDzO,EACFuD,KAAKmL,cAAc1O,GAEnBuD,KAAKoL,gBAIFZ,EAAA1M,UAAAuN,YAAP,SAAmBC,GACjB,OAAOtL,KAAKuL,oBAAoBD,GAAUL,OAGpCT,EAAA1M,UAAAoN,cAAR,eAAAM,EAAAxL,KAC0BA,KAAK4K,gBAC7B5K,KAAKyK,MAAM1G,QAAQ,SAAA0H,GACjB,IAAMH,EAAWG,EAAKC,cACtBF,EAAKX,QAAQY,EAAKhP,MAAQ+O,EAAKD,oBAAoBD,MAI/Cd,EAAA1M,UAAAyN,oBAAR,SAA4BD,GAC1B,OAAO,IAAItL,KAAK0K,oBACdC,UAAW3K,KAAK2K,UAChBC,gBAAiB5K,KAAK4K,gBACtBU,SAAQA,KAIJd,EAAA1M,UAAAsN,aAAR,WACMpL,KAAKyK,MAAM,IACbzK,KAAK2L,iBAAiB3L,KAAKyK,MAAM,GAAGhO,MAAMwO,OAIvCT,EAAA1M,UAAAqN,cAAP,SAAqB1O,GACnB,OAAOuD,KAAK2L,iBAAiBlP,GAAMwO,OAG7BT,EAAA1M,UAAA6N,iBAAR,SAAyBlP,GACvB,OAAOuD,KAAK6K,QAAQpO,IAExB+N,EA1DA,iBCAaoB,GACXC,cAAe,UACfC,qBAAsB,uBCAjB,SAASC,EAAWC,GACzB,IAAIC,EAAQ,EACNC,KACN,IAAKD,EAAQ,EAAGA,EAAQD,EAAIjN,OAAQkN,IAClCC,EAASpL,KAAKkL,EAAIC,IAEpB,OAAOC,ECJF,SAASC,EAAaC,EAAa9H,GACxC,OAAOlC,KAAKiK,MAAMjK,KAAKkK,UAAYhI,EAAM8H,EAAM,IAAMA,EAuBhD,SAASG,EAAyB/N,GACvC,IAAMK,EAAOjC,OAAA4P,EAAA,OAAA5P,CAAO4B,GAEpB,OASF,SAAkBA,GAChB,MAAuB,WAAhB5B,OAAA4P,EAAA,OAAA5P,CAAO4B,GAVVS,CAAST,GAjBf,SAASiO,EAAkCjO,GACzC,IAAMkO,KAUN,OATA9P,OAAA4P,EAAA,eAAA5P,CAAe4B,EAAK,SAAC8C,EAAMnE,GACH,UAAlBP,OAAA4P,EAAA,OAAA5P,CAAOO,GACTuP,EAASpL,GAAQiL,EAAUpP,GACA,WAAlBP,OAAA4P,EAAA,OAAA5P,CAAOO,GAChBuP,EAASpL,GAAQmL,EAAgBtP,GAEjCuP,EAASpL,GAAQnE,IAElB,GAAO,GACHuP,EAOED,CAAgBjO,GACL,UAATK,EACFL,EAAIuD,IAAI,SAAA7C,GAAK,OAAAqN,EAAUrN,KAEvBV,EAoBJ,SAASmO,EAAYC,GAC1B,MAAyB,OAArBA,EAAI1H,OAAO,EAAG,GACT,GAAGX,SAASsI,SAASC,SAAWF,EAE1B,MAAXA,EAAI,GACC,GAAGrI,SAASsI,SAASE,OAASH,GAEb,IAAtBA,EAAI9N,QAAQ,KACJyF,SAASsI,SAASE,OAAM,IAAIH,EAEjCA,EC9DT,IAAAI,EAAA,WAQE,SAAAC,EAAoBtC,GAAA3K,KAAA2K,YAPZ3K,KAAAkN,WAAa,8BACblN,KAAAmN,WAAa,IAAIC,OAAOpN,KAAKkN,WAAY,KAE1ClN,KAAAqN,oBACLf,OAAUtM,KAAKsN,aAAa5P,KAAKsC,OA+DrC,OA1DSiN,EAAAnP,UAAAkG,QAAP,SAAerC,GACb,IAAM4L,EAAQvN,KAAKwN,SAAS7L,GAC5B,OAAK4L,EACDA,EAAME,QAAU9L,EACX3B,KAAK0N,WAAW/L,GAEhB3B,KAAK2N,gBAAgBhM,GAJTA,GAQfsL,EAAAnP,UAAA6P,gBAAR,SAAwBhM,GAAxB,IAAA6J,EAAAxL,KACE,OAAO2B,EAAIqC,QAAQhE,KAAKmN,WAAY,SAACS,GACnC,OAAOpC,EAAKqC,iBAAiBD,GAAWxP,cAIpC6O,EAAAnP,UAAA0P,SAAR,SAAiB7L,GACf,IAAMmM,EAAUnM,EAAItD,MAAM2B,KAAKkN,YAC/B,IAAKY,EAAW,OAAO,KAChB,IAAAL,EAAAK,EAAA,GAAOC,EAAAD,EAAA,GAASA,EAAA,GACvB,OAASL,MAAKA,EAAEM,QAAOA,EAAEC,OADUF,EAAA,KAI7Bb,EAAAnP,UAAA4P,WAAR,SAAmB/L,GAAnB,IACMsM,EADNzC,EAAAxL,KAME,OAJA2B,EAAIqC,QAAQhE,KAAKmN,WAAY,SAACS,GAE5B,OADAK,EAAWzC,EAAKqC,iBAAiBD,GAC1BA,IAEFK,GAGDhB,EAAAnP,UAAA+P,iBAAR,SAAyBD,GACjB,IAAAM,EAAAlO,KAAAwN,SAAAI,GAASG,GAAPG,EAAAT,MAAOS,EAAAH,SAASC,EAAAE,EAAAF,OACxB,OAAIA,EACKhO,KAAKmO,SAASJ,EAASC,GAEvBhO,KAAK2K,UAAUoD,IAIlBd,EAAAnP,UAAAqQ,SAAR,SAAiBJ,EAAiBC,GAChC,IAAMI,EAASpO,KAAKqN,mBAAmBW,GACvC,IAAKI,EACH,MAAM,IAAIhO,MAAM,8BAA8B4N,EAAM,KAEtD,OAAOI,EAAOL,IAGRd,EAAAnP,UAAAwP,aAAR,SAAqBS,GACnB,IAAMM,EAASrO,KAAK2K,UAAUoD,GAC9B,GAAuB,UAAnBnR,OAAA4P,EAAA,OAAA5P,CAAOyR,GACT,MAAM,IAAIjO,MAAM,mDAIlB,OAAOiO,EADalC,EAAa,EAAGkC,EAAOtP,OAAS,KAGxDkO,EApEA,GCCAqB,EAAA,WAmBE,SAAAC,EAAYL,OAAC5C,EAAA4C,EAAA5C,SAAUV,EAAAsD,EAAAtD,gBAAiBD,EAAAuD,EAAAvD,UAhBhC3K,KAAA0G,OAAS,IAAI8H,EAAA,aACbxO,KAAAyO,WAIAzO,KAAA0O,YASA1O,KAAA2O,UAAY,EAGlB3O,KAAKsL,SAAWA,EAChBtL,KAAKyO,QAAU7D,EACf5K,KAAK2K,UAAYA,EACjB3K,KAAK4O,SAAW,IAAI5B,EAAchN,KAAK2K,WACvC3K,KAAK6O,UAAU,SAkJnB,OAhKUN,EAAAzQ,UAAAgR,eAAR,SAAuBrS,GACrB,IAAKuD,KAAKyO,QAAQhS,GAChB,MAAM,IAAI2D,MAAM,mDAAmD3D,EAAI,cAEzE,OAAOuD,KAAKyO,QAAQhS,IAaf8R,EAAAzQ,UAAAmN,IAAP,WACE,OAAIjL,KAAK+O,SACA/O,KAAKgP,QAELhP,KAAKiP,cAITV,EAAAzQ,UAAA8J,GAAP,SAAU/B,EAAOK,GACf,OAAOlG,KAAK0G,OAAOkB,GAAG/B,EAAOK,IAGxBqI,EAAAzQ,UAAAkI,KAAP,SAAYH,EAAOK,GACjB,OAAOlG,KAAK0G,OAAOV,KAAKH,EAAOK,IAGzBqI,EAAAzQ,UAAAkR,MAAR,WAGE,OAFAhP,KAAK6O,UAAU,WACf7O,KAAKkP,iBACEtG,QAAQC,QAAQ7I,OAGjBuO,EAAAzQ,UAAAmR,WAAR,eACMD,EADNxD,EAAAxL,KAEQmP,EAAyB,IAAIvG,QAAQ,SAAAC,GACzCmG,EAAQ,WACNnG,EAAQ2C,EAAKwD,YAIjB,OADAhP,KAAK0O,SAAS5N,KAAKkO,GACZG,GAGDZ,EAAAzQ,UAAAiR,OAAR,WACE,MAAuB,YAAhB/O,KAAKoP,QAAwC,YAAhBpP,KAAKoP,QAGnCb,EAAAzQ,UAAA+Q,UAAR,SAAkBO,GAChBpP,KAAK0G,OAAOO,KAAKmI,GACjBpP,KAAKoP,OAASA,GAGRb,EAAAzQ,UAAAuR,WAAR,WACErP,KAAK2O,UAAY,GAGXJ,EAAAzQ,UAAAwR,aAAR,WACEtP,KAAK2O,aAGCJ,EAAAzQ,UAAAoR,eAAR,eAAA1D,EAAAxL,KACE,GAAoB,YAAhBA,KAAKoP,OAAT,CAEA,IAAMG,EAAMvP,KAAKsL,SAAStL,KAAK2O,WAC3BY,GACFvP,KAAKsP,eACLtP,KAAKwP,WAAWD,GACbjG,KAAK,SAAAmG,GAAa,OAAAjE,EAAKkE,eAAeD,KACtCnG,KAAK,WAAM,OAAAkC,EAAK0D,oBAEnBlP,KAAK2P,SAIKpB,EAAAzQ,UAAA4R,eAAd,SAA6BE,4GACpBtE,EAAqCsE,EAAStE,SAApCuE,EAA2BD,EAASC,UAA1BC,EAAiBF,EAASE,gBAChC9P,KAAK+P,YAAYD,GAClCxE,GAAY,EAAMtL,KAAKgQ,aAAa1E,KAApC,YAAY4C,EAAApE,wBAChB,SAAM9J,KAAKiQ,iBAAiBJ,kBAA5B3B,EAAApE,iBAGYyE,EAAAzQ,UAAAmS,iBAAd,SAA+BJ,oEAC7B,OAAKA,EACDA,EAASK,KAAK,SAAAlT,GAAK,MAAM,SAANA,KAAiB,EAAOgD,KAAK2P,QAChDE,EAASK,KAAK,SAAAlT,GAAK,MAAM,UAANA,KAAkB,EAAOgD,KAAKmQ,UACrD,IAHiB,QAMX5B,EAAAzQ,UAAA6R,KAAR,WACE3P,KAAKqP,aACL,IAAMe,EAAiBpQ,KAAK0O,SAAS7N,QACrC,GAAIuP,EAAkB,OAAOA,IAC7BpQ,KAAK6O,UAAU,SAGTN,EAAAzQ,UAAAqS,MAAR,WACEnQ,KAAK6O,UAAU,WAGTN,EAAAzQ,UAAAiS,YAAR,SAAoBM,GAApB,IAAA7E,EAAAxL,KACEqQ,EAAiB/G,KAAK,SAAAgC,GACpBE,EAAKwE,aAAa1E,GACjBgF,MAAM,SAACC,GACN,IAAMC,EAAmBD,EAAIE,QAAQ5Q,MAAM,EAAE,IAAM,MACnD6Q,QAAQC,MAAM,sCAAsCH,EAAgB,iCAGvEF,MAAM,SAAAC,GACO,cAARA,IACJG,QAAQC,MAAM,+HACdD,QAAQC,MAAMJ,OAIVhC,EAAAzQ,UAAAkS,aAAR,SAAqB1E,GAArB,IAAAE,EAAAxL,KACE,OAAO,IAAI4I,QAAQ,SAAAgI,GACjB,IAAMC,EAAS,IAAItC,GACjB3D,gBAAiBY,EAAKiD,QACtBnD,SAAQA,EACRX,UAAWa,EAAKb,YAElBkG,EAAO7K,KAAK,OAAQ4K,GACpBC,EAAO5F,QACNqF,MAAM,SAAAC,GAGP,MAFAG,QAAQC,MAAM,kCACdD,QAAQC,MAAMJ,GACRA,KAIFhC,EAAAzQ,UAAA0R,WAAR,SAAmBsB,GACjB,IAAMvB,EAAMvP,KAAK+Q,iBAAiBD,GAElC,OADuB9Q,KAAK8O,eAAeS,EAAI9S,KACxCuU,CAAezB,IAGhBhB,EAAAzQ,UAAAiT,iBAAR,SAAyBE,GAAzB,IAAAzF,EAAAxL,KACM0M,EAAWH,EAAU0E,GASzB,OAPAvE,EAAW9P,OAAA4P,EAAA,eAAA5P,CAAe8P,EAAU,SAACpL,EAAMnE,GAIzC,MAHsB,WAAlBP,OAAA4P,EAAA,OAAA5P,CAAOO,KACTA,EAAQqO,EAAK0F,wBAAwB/T,KAE/BmE,EAAMnE,KACb,GAAM,IAMHoR,EAAAzQ,UAAAoT,wBAAR,SAAgCvP,GAC9B,OAAO3B,KAAK4O,SAAS5K,QAAQrC,IAEjC4M,EA1KA,GCLa4C,EAAqD,SAACpG,GAEjE,OACEqG,OACE,SAAC7B,GACC,OAAA3G,QAAQC,QAIT,SACLwI,EACA9B,GAEQ,IACJ+B,EADI3G,EAAA0G,EAAA1G,UAOR,OALA4E,EAAIgC,GAAGxN,QAAQ,SAAAyN,GACTF,IACJA,EAMJ,SACEE,EACA7G,GAEA,IAAM8G,EA0BR,SAA2BC,GACzB,IAAK,IAAMpQ,KAAQoQ,EACjB,GAAIC,EAAkB5T,eAAeuD,GACnC,OAAOA,EAIX,IAAMsQ,KACN,IAAK,IAAMC,KAAcH,EACnBA,EAAS3T,eAAe8T,IAC1BD,EAAY9Q,KAAK+Q,GAGrB,MAAM,IAAIzR,MAAM,4EAA4EwR,EAAY7Q,KAAK,OAvC5F+Q,CAAkBN,GAC7BvD,EAAWtD,EAAU6G,EAAUzD,SAC/BgE,EAAUP,EAAUC,GAC1B,OAuCF,SAAwBA,EAAUxD,EAAU8D,GAE1C,OAAOC,EADQL,EAAkBF,IACnBxD,EAAU8D,GAzCpBE,CAAeR,EAAUxD,EAAU8D,GAC9BP,EAAUlG,SAEZ,KAhBa4G,CAAsBV,EAAW7G,OAG7CW,SADSgG,GAAmB/B,EAAI4C,iBAdlBC,CAASrH,EAAOwE,OAuCxC,IAAMoC,GACJU,GAAI,SAACpE,EAAU8D,GAAY,OAAA9D,IAAa8D,GACxCO,cAAe,SAACrE,EAAU8D,GAAY,OAAA9D,EAAW8D,GACjDQ,WAAY,SAACtE,EAAU8D,GAAY,OAAA9D,EAAW8D,GAC9CS,uBAAwB,SAACvE,EAAU8D,GAAY,OAAA9D,GAAY8D,GAC3DU,oBAAqB,SAACxE,EAAU8D,GAAY,OAAA9D,GAAY8D,GACxDW,UAAW,SAACzE,EAAU0E,GAAQ,OAdhC,SAAgBA,GACd,OAAOvQ,KAAKgK,IAAGrM,MAARqC,KAAYuQ,GAaYC,CAAOD,IAAQ1E,GAAcA,GAV9D,SAAiB0E,GACf,OAAOvQ,KAAKkC,IAAGvE,MAARqC,KAAYuQ,GASqDE,CAAQF,KCnC3E,SAASG,EAAiBC,OAAwE,IAAAC,KAAAC,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAAD,EAAAC,EAAA,GAAArT,UAAAqT,GAC/F,IAAAzP,EAAAuP,EAAAvP,SAAUiH,EAAAsI,EAAAtI,MAAOE,EAAAoI,EAAApI,UACnBuI,EAbD,SAAsBH,OAA4C,IAAAC,KAAAC,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAAD,EAAAC,EAAA,GAAArT,UAAAqT,GAC/D,IAAAzP,EAAAuP,EAAAvP,SAAUiH,EAAAsI,EAAAtI,MAAOE,EAAAoI,EAAApI,UAAWD,EAAAqI,EAAArI,mBAC9BwI,EAAS,IAAI1I,EAAgBhH,EAAUiH,EAAOC,EAAoBC,GAMxE,OAJAqI,EAAkBjP,QAAQ,SAAAvI,GACxB0X,EAAOpI,uBAAuBtP,KAGzB0X,GAKoBnT,WAAA,IAAEyD,SAAQA,EAAEiH,MAAKA,EAAEE,UAASA,EAAED,mBAAoB4D,IAAcrO,OAAK+S,IAIhG,OAFAE,EAAOpI,uBAAuBqG,GAEvB+B,EC4BT,IAAAC,EAAA,WAKE,SAAAA,EAAoB1W,GAAAuD,KAAAvD,OAJZuD,KAAAsL,YAEAtL,KAAAoT,SAAmB,OAyE7B,OApESD,EAAArV,UAAA4N,YAAP,WACE,OAAO1L,KAAKsL,UAGN6H,EAAArV,UAAAuV,OAAR,SAAeC,GAAf,IAAA9H,EAAAxL,KACE,GAAIN,MAAMS,QAAQmT,GAAY,OAAOA,EAAQvP,QAAQ,SAAAxH,GAAK,OAAAiP,EAAK6H,OAAO9W,KACjD,cAAlByD,KAAKoT,SAENpT,KAAKuT,SAAShC,GAAGvR,KAAKuT,SAAShC,GAAGxS,OAAS,GAAGuM,SAASxK,KAAKwS,GAEpC,YAAlBtT,KAAKoT,SAEXpT,KAAKuT,SAASpB,gBAAgBrR,KAAKwS,GAInCtT,KAAKsL,SAASxK,KAAKwS,IAIhBH,EAAArV,UAAA0V,aAAP,eAAoB,IAAAlI,KAAA2H,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAA3H,EAAA2H,GAAArT,UAAAqT,GAClBjT,KAAKqT,OAAO/H,IAGP6H,EAAArV,UAAA2V,GAAP,SAAUC,GA+BR,OA7BqB,MAAjB1T,KAAKuT,WAETvT,KAAKuT,UAAY9W,KAAM,SAAU8U,MAAQY,qBAEzCnS,KAAKoT,SAAW,YACVM,EAAWrB,GAEbrS,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKtB,GAAIqB,EAAWrB,GAAI/G,cAE5DoI,EAAWpB,cAElBtS,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKrB,cAAeoB,EAAWpB,cAAehH,cAElFoI,EAAWnB,WAElBvS,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKpB,WAAYmB,EAAWnB,WAAYjH,cAE5EoI,EAAWhB,UAElB1S,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKjB,UAAWgB,EAAWhB,UAAWpH,cAE1EoI,EAAWlB,uBAElBxS,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKnB,uBAAwBkB,EAAWlB,uBAAwBlH,cAEpGoI,EAAWjB,qBAElBzS,KAAKuT,SAAShC,GAAGzQ,MAAMiN,QAAS2F,EAAWC,IAAKnB,uBAAwBkB,EAAWjB,oBAAqBnH,cAErGtL,MAGFmT,EAAArV,UAAA8V,KAAP,WAEE,OADA5T,KAAKoT,SAAW,UACTpT,MAGFmT,EAAArV,UAAA+V,MAAP,WAGE,OAFA7T,KAAKoT,SAAW,OAChBpT,KAAKqT,OAAOrT,KAAKuT,UACVvT,MAEXmT,EA5EA,GCdA,IAAAW,EAAA,WAuCE,SAAAC,EAAYC,QAAA,IAAAA,UAjBLhU,KAAA2K,aACA3K,KAAAwD,YAECxD,KAAAiU,iBACNC,cAAe3P,SAAS4P,eAAevI,EAASC,eAChDuI,aAAc,GACdC,WAAY,KACZC,aAAa,GAKPtU,KAAAyK,SAEEzK,KAAAuU,mBAAqBpB,EACrBnT,KAAAwU,uBAmBHxU,KAAAyU,WAAazU,KAAKyL,KAhBhB,IAAAd,EAAAqJ,EAAArJ,UAAWnH,EAAAwQ,EAAAxQ,SACdmH,IACF3K,KAAK2K,UAAYA,GAEfnH,IACFxD,KAAKwD,SAAWA,GAElBxD,KAAK0U,cA4FT,OA1IgBX,EAAAY,OAAd,eAAqB,MAAAC,KAAA3B,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAA2B,EAAA3B,GAAArT,UAAAqT,GACnB,IACM4B,EAAY,SAAAC,GAAG,SAAAC,mDAAkC,OAApB5M,EAAA4M,EAAAD,GAAoBC,EAArC,CADQ/U,KAAKgV,WAEzBC,KAWN,OAVAL,EAAc7Q,QAAQ,SAAAmR,IAb1B,SAA2BC,GACzB,QAAUA,EAAwCC,eAa1CC,CAAkBH,IACpBA,EAAOE,cAAcrR,QAAQ,SAAAuR,GAC3BT,EAAa/W,UAAUwX,EAAUC,SAAW,WAAqD,OAAxCD,EAAUE,MAAMzV,MAAMC,KAAMJ,WAAmBI,QAZlH,SAAgCmV,GAC9B,QAAUA,EAA2CF,wBAc7CQ,CAAuBP,IACzBD,EAAwBnU,KAAIf,MAA5BkV,EAAgCC,EAAOD,4BAG3C/G,EAAA,SAAA4G,GAAO,SAAAY,IAAA,IAAAlK,EAAA,OAAAsJ,KAAA/U,MAAAC,KAAAJ,YAAAI,YACKwL,EAAAgJ,oBAAsBS,EAEtBzJ,EAAA+I,mBAAqBM,IACjC,OAJqB1M,EAAAuN,EAAAZ,GAIrBY,EAJA,CAAqB1V,OAEFgV,UAAYH,KAiC1Bd,EAAAjW,UAAA2N,KAAP,SAAYhP,GACV,IAAMkZ,EAAU,IAAI3V,KAAKuU,mBAAmB9X,GAE5C,OADAuD,KAAKyK,MAAM3J,KAAK6U,GACTA,GAKF5B,EAAAjW,UAAAmN,IAAP,SAAWxO,GACTuD,KAAK4V,iBAAiB5V,KAAK6V,YAAapZ,IAGnCsX,EAAAjW,UAAAgY,gBAAP,SAAuBrZ,EAAegP,GACpC,IAAMyH,EAASlT,KAAK6V,YACdE,EAAM/V,KAAKgW,oBAAoBvZ,GAErC,OADAuD,KAAKiW,aAAaF,EAAK7C,EAAQzH,GACxBsK,GAGDhC,EAAAjW,UAAA+X,UAAR,WACE,OAAO7V,KAAKkT,OAASlT,KAAKkT,OAASlT,KAAKkT,OAASJ,EAAgB/S,WAAA,IAE7DyD,SAAUxD,KAAKkW,cACfzL,MAAOzK,KAAKyK,MACZE,UAAW3K,KAAK2K,YACjB1K,OACCD,KAAKwU,uBAIHT,EAAAjW,UAAA4W,YAAR,WACE,IAAK1U,KAAKmW,WAAW,iBACnB,MAAM,IAAI/V,MAAM,kCAIZ2T,EAAAjW,UAAAqY,WAAR,SAAmB1Z,GACjB,YAA4BiL,IAAxB1H,KAAKwD,SAAS/G,GAA8BuD,KAAKwD,SAAS/G,GACvDuD,KAAKiU,gBAAgBxX,IAGtBsX,EAAAjW,UAAAoY,YAAR,WAEE,IADA,IAAM1S,KACYyP,EAAA,EAAA/E,EAAAtR,OAAOkF,KAAK9B,KAAKiU,iBAAjBhB,EAAA/E,EAAAnP,OAAAkU,IAAmC,CAAhD,IAAMxV,EAAGyQ,EAAA+E,GACZzP,EAAS/F,GAAOuC,KAAKmW,WAAW1Y,GAElC,OAAO+F,GAGDuQ,EAAAjW,UAAA8X,iBAAR,SAAyB1C,EAAyBzW,GAC5CuD,KAAKmF,mBACPnF,KAAKiW,aAAajW,KAAKgW,sBAAuB9C,EAAQzW,GAEtDyW,EAAOjI,IAAIxO,IAIPsX,EAAAjW,UAAAqH,iBAAR,WACE,OAAOvI,OAAAwZ,EAAA,iBAAAxZ,IAGDmX,EAAAjW,UAAAkY,oBAAR,SAA4BnM,QAAA,IAAAA,MAAA,WAC1B,IAAMwM,EAAW9R,SAAS+R,cAAc,UAKxC,OAJAD,EAASxX,KAAO,SAChBwX,EAASE,GAAK,aACdF,EAASG,UAAY3M,EACpB7J,KAAKkW,cAAchC,cAA8BuC,YAAYJ,GACvDA,GAGDtC,EAAAjW,UAAAmY,aAAR,SAAqBF,EAAkB7C,EAAQzW,GAA/C,IAAA+O,EAAAxL,KACQ0W,EAAc,WAClBX,EAAIY,oBAAoB,QAASD,GACjClL,EAAKoL,sBACLb,EAAIc,SACJ3D,EAAOjI,IAAIxO,IAEbsZ,EAAIe,iBAAiB,QAASJ,IAGxB3C,EAAAjW,UAAA8Y,oBAAR,WAGiB7K,EAAWxH,SAASwS,iBAAiB,UAC7ChT,QAAQ,SAAAiT,GACbA,EAAIC,OACJD,EAAI7G,WArGS4D,EAAAiB,UAAY7B,EAwG/BY,EA3IA,GCtBAmD,EAAA,oBAAAC,KA+GA,OA9GSA,EAAArZ,UAAAsZ,UAAP,eAAiB,IAAArM,KAAAkI,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAAlI,EAAAkI,GAAArT,UAAAqT,GACf,OAAIvT,MAAMS,QAAQ4K,EAAM,IACf/K,KAAKqX,2BAA2BtM,EAAM,IAEtC/K,KAAKsX,iBAAiBvM,IAI1BoM,EAAArZ,UAAAyZ,WAAP,SAAkBC,GAChB,IAAMlM,KAEN,GAAIkM,EAAM,CACR,IACMlE,GAA2B7W,KAAM,OAAQ+a,KADzB,IAAPA,GAEflM,EAASxK,KAAKwS,GAMhB,OAFAhI,EAASxK,MADwCrE,KAAM,eAGhD6O,GAGD6L,EAAArZ,UAAAuZ,2BAAR,SAAmCI,GAEjC,OADA/G,QAAQgH,KAAK,oKACN1X,KAAKoX,UAASrX,MAAdC,KAAkByX,IAGnBN,EAAArZ,UAAAwZ,iBAAR,SAAyBvM,GAAzB,IAAAS,EAAAxL,KAOE,OANsB+K,EACnBhJ,IAAI,SAAA4V,GAAY,OAAAnM,EAAKoM,wBAAwBD,KAC7C5U,OAAO/C,KAAK6X,4BACZ9V,IAAI,SAAA+V,GAAM,OAAAtM,EAAKuM,6BAA6BD,KAC5CE,YAAYhY,KAAKiY,6BAA8B,QAK5Cd,EAAArZ,UAAA+Z,wBAAR,SAAgChc,EAAmBqc,GACjD,GAAIA,EAAQtL,IACV/Q,EAAEiF,KAAKoX,OACF,CACL,IAAMC,EAAUtc,EAAEA,EAAEkD,OAAS,GAC7B,IAAKoZ,EACH,MAAM,IAAI/X,MAAM,0HAElBxD,OAAO6G,OAAO0U,EAASD,GAEzB,OAAOrc,GAGDsb,EAAArZ,UAAAma,6BAAR,SACEpc,EACAyX,GAEA,OAAKzX,GACLyX,EAAQ8E,WAAa9E,EAAQ8E,eAC7B9E,EAAQ8E,WAAWtX,KAAKjF,GACjByX,GAHUA,GAMX6D,EAAArZ,UAAA8Z,wBAAR,SAAgCS,GAC9B,MAA2B,iBAAhBA,EACFA,GAECzL,IAAKyL,IAITlB,EAAArZ,UAAAia,6BAAR,SAAqCvZ,GACnC,IACM8Z,GAAiBC,KAAM/Z,EAAIoO,KAC3B4L,EAAexY,KAAKyY,yBAAyBja,GAEnD,OADc8J,MAHO7L,KAAM,aAG6B6b,EAAkBE,IAIpErB,EAAArZ,UAAA2a,yBAAR,SAAiCC,GAC/B,IAAIN,KACJ,SAASO,EAAYrN,GACnB8M,EAAaA,EAAWnY,OAAOqL,GA4BjC,OAzBIoN,EAASE,UACXD,GACElc,KAAM,eACNoc,SAAUH,EAASE,WAGnBF,EAASI,IACXH,GACElc,KAAM,YACNsc,KAAML,EAASI,KAGfJ,EAASM,SACXL,GACElc,KAAM,cACNoc,SAAUH,EAASM,UAGnBN,EAASO,MACXN,IACIlc,KAAM,WAAYoc,SAAUH,EAASO,OACrCxc,KAAM,mBAIL2b,EAAWrZ,OAAS,GAAKqZ,WAAUA,OAE9CjB,EA/GA,GCbA,SAAS+B,EAAkB3C,GACzB,IAAM4C,EAAS5U,SAAS+R,cAAc,SACtC6C,EAAO5C,GAAKA,EACZ4C,EAAOC,aAAa,cAAe,QACnCD,EAAOC,aAAa,wBAAyB,QAG7C,OADAD,EAAOE,MAAMC,QADC,QAEPH,EAGT,IAmDaI,EAAkB,IAnD/B,oBAAAC,IACUxZ,KAAAyZ,YAA2BlV,SAASiF,KACpCxJ,KAAA0Z,aAAc,EAEd1Z,KAAA2Z,SACNzB,QAASgB,EAAkB,qBAC3BU,QAASV,EAAkB,sBA2C/B,OAxCSM,EAAA1b,UAAAsZ,UAAP,SAAiBxK,GACf,IAAMgN,EAAU5Z,KAAK6Z,mBACf3B,EAAUlY,KAAK8Z,mBAQrB,OAPAF,EAAQG,aAAe,WACrB7B,EAAQ8B,IAAMpN,EACdsL,EAAQjB,OACR2C,EAAQG,aAAe,cAEzBH,EAAQI,IAAMpN,EACdgN,EAAQK,OACDja,KAAKka,eAAehC,IAGrBsB,EAAA1b,UAAAoc,eAAR,SAAuBf,GACrB,OAAO,IAAIvQ,QAAQ,SAACC,GAClB,IAAMsR,EAAU,WACdtR,EAAQ,eACRsQ,EAAOxC,oBAAoB,QAASwD,IAEtChB,EAAOrC,iBAAiB,QAASqD,MAI9BX,EAAA1b,UAAAsc,cAAP,SAAqBX,GACnBzZ,KAAKyZ,YAAcA,EACnBzZ,KAAKqa,iBAGCb,EAAA1b,UAAAuc,cAAR,WACEra,KAAKyZ,YAAYhD,YAAYzW,KAAK2Z,QAAQC,SAC1C5Z,KAAKyZ,YAAYhD,YAAYzW,KAAK2Z,QAAQzB,UAGrCsB,EAAA1b,UAAAgc,iBAAP,WACE,OAAO9Z,KAAK2Z,QAAQzB,SAGfsB,EAAA1b,UAAA+b,iBAAP,WACE,OAAO7Z,KAAK2Z,QAAQC,SAExBJ,EAjDA,ICsBMc,EAAsB,IAAIpD,EChChC,IAgBMqD,EAAsB,IAAIrD,ECZzB,IAAMsD,GACXpF,gBACEG,QAAS,YACTC,MF2BG,eAAiC,IAAAzK,KAAAkI,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAAlI,EAAAkI,GAAArT,UAAAqT,GACtCjT,KAAKwT,aAAYzT,MAAjBC,KAAqBsa,EAAoBlD,UAASrX,MAA7Bua,EAAiCvP,OE1BpDwK,QAAS,aACTC,MDQG,SAAkCgC,GACvCxX,KAAKwT,aAAYzT,MAAjBC,KAAqBua,EAAoBhD,WAAWC,OCPlDjC,QAAS,YACTC,MFyBG,eAAiC,IAAAzK,KAAAkI,EAAA,EAAAA,EAAArT,UAAAb,OAAAkU,IAAAlI,EAAAkI,GAAArT,UAAAqT,GACtCvC,QAAQgH,KAAK,iEACb1X,KAAKwT,aAAYzT,MAAjBC,KAAqBsa,EAAoBlD,UAASrX,MAA7Bua,EAAiCvP,OEzBtDkK,yBFVmE,SAAClK,GAEpE,IAAM0P,EAAS1P,EAAMvH,SAAS0Q,cAG9B,OAFAqF,EAAgBa,cAAcK,IAEtBrD,UAAa,SAAC7H,GACpB,IAAMmL,EAAc,GAAG3P,EAAMvH,SAAS4Q,aAAe7E,EAAIgJ,KACnDoC,EAAcpB,EAAgBnC,UAAUsD,GACxCE,KAEN,GAAIrL,EAAI6I,WAAY,CAClB,IAAMyC,EAAa,IAAIjS,QAAQ,SAACgI,EAAKkK,GACnCH,EAAYrR,KAAK,YTmClB,SAAmByR,EAAcC,GACtC,OAAOrO,EAAYoO,KAAUpO,EAAYqO,GSnC7BC,CAAU1B,EAAgBO,mBAAmBE,IAAKU,GAGpDI,EAAI,aAFJlK,EAAIrB,EAAI6I,gBAOdwC,EAAU9K,cAAgB+K,EAE5B,OAAOjS,QAAQC,QAAQ+R,MCxB2C,SAAC7P,GAErE,IAAM0P,EAAS1P,EAAMvH,SAAS0Q,cAG9B,OAFAqF,EAAgBa,cAAcK,IAG5BlD,WAAc,SAAOhI,GAAuB,OAAAhH,OAVhDb,OAUgD,8CAC1C,SAAOkB,QAAQC,sBETrB,SAASqS,EAAkB3E,GACzB,IAAM4C,EAAS5U,SAAS+R,cAAc,SAEtC,OADA6C,EAAO5C,GAAKA,EACL4C,EAGT,IA4GagC,EAAkB,IA5G/B,oBAAAC,IACSpb,KAAAqb,cAAgB,IACfrb,KAAAyZ,YAA2BlV,SAASiF,KAEpCxJ,KAAA2Z,SACN2B,GAAIJ,EAAkB,sBACtBK,IAAKL,EAAkB,wBAoG3B,OAjGSE,EAAAtd,UAAAmZ,KAAP,SAAYuE,EAA4C5O,GACtD,IAAMuM,EAASnZ,KAAKyb,eAAeD,GAKnC,OAJI5O,GAAOuM,EAAOa,MAAQpN,IACxBuM,EAAOa,IAAMpN,GAEfuM,EAAOlC,OACAjX,KAAKka,eAAef,IAGtBiC,EAAAtd,UAAAqS,MAAP,SAAaqL,GAGX,OAFexb,KAAKyb,eAAeD,GAC5BrL,QACAvH,QAAQC,QAAQ,iBAGlBuS,EAAAtd,UAAAmc,KAAP,SAAYuB,EAA4C5O,GACtD,IAAMuM,EAASnZ,KAAKyb,eAAeD,GAInC,OAHI5O,GAAOuM,EAAOa,MAAQpN,IACxBuM,EAAOa,IAAMpN,GAER5M,KAAK0b,gBAAgBvC,IAGvBiC,EAAAtd,UAAA6d,KAAP,SAAYH,EAA4CG,GACtD3b,KAAKyb,eAAeD,GAAYG,KAAOA,GAGlCP,EAAAtd,UAAA8d,OAAP,SAAcJ,EAAYI,EAAQpE,GAChC,IAAM2B,EAASnZ,KAAKyb,eAAeD,GAMnC,OALIhE,GAAQA,EAAOxX,KAAKqb,cACtBrb,KAAK6b,aAAa1C,EAAQyC,EAAQpE,GAElC2B,EAAOyC,OAASA,EAEXhT,QAAQC,QAAQ,0BAGXuS,EAAAtd,UAAA+d,aAAd,SAA2B1C,EAAQ2C,EAAetE,uGAC1CuE,EAAYC,KAAKC,MACjBC,EAAc/C,EAAOyC,OACrBO,EAAkBL,EAAgBI,EACpCE,EAAiB,0BAQdA,EAAiB,GACtBjD,EAAOyC,OAASM,EAAeC,EAPjC,WACE,IAAME,EAAWL,KAAKC,MAAQF,EAE9B,OADAK,EAAiBha,KAAKgK,IAAIiQ,EAAW7E,EAAM,GAKM8E,GAC1B,IAAnBF,IAAwBjD,EAAOyC,OAASE,IAC5C,EZ7DC,SAActE,GACnB,OAAO,IAAI5O,QAAQ,SAAAgI,GACjB2L,WAAW3L,EAAK4G,KY2DRgF,CAAKxc,KAAKqb,kBAHO,mBAGvBnN,EAAApE,oCAIIsR,EAAAtd,UAAAoc,eAAR,SAAuBf,GACrB,OAAO,IAAIvQ,QAAQ,SAACC,GAClB,IAAMsR,EAAU,WACdtR,EAAQ,eACRsQ,EAAOxC,oBAAoB,QAASwD,IAEtChB,EAAOrC,iBAAiB,QAASqD,MAI7BiB,EAAAtd,UAAA4d,gBAAR,SAAwBvC,GACtB,OAAO,IAAIvQ,QAAQ,SAACC,GAClB,IAAMsR,EAAU,WACdtR,EAAQ,gBACRsQ,EAAOxC,oBAAoB,aAAcwD,IAE3ChB,EAAOrC,iBAAiB,aAAcqD,MAInCiB,EAAAtd,UAAAsc,cAAP,SAAqBX,GACnBzZ,KAAKyZ,YAAcA,EACnBzZ,KAAKqa,iBAGCe,EAAAtd,UAAAuc,cAAR,WACEra,KAAKyZ,YAAYhD,YAAYzW,KAAK2Z,QAAQ2B,IAC1Ctb,KAAKyZ,YAAYhD,YAAYzW,KAAK2Z,QAAQ4B,MAGrCH,EAAAtd,UAAA2e,YAAP,WACE,OAAOzc,KAAK2Z,QAAQ2B,IAGfF,EAAAtd,UAAA4e,aAAP,WACE,OAAO1c,KAAK2Z,QAAQ4B,KAGfH,EAAAtd,UAAA2d,eAAP,SAAgEhf,GAC9D,OAAOuD,KAAK2Z,QAAQld,EAAK6B,gBAE7B8c,EA1GA,ICLO,IAAMuB,GACXvH,gBAEIG,QAAS,UACTC,MC8CC,SAA+BzK,GACpC/K,KAAKwT,aAGP,SAAwBzI,GACtB,GAAqB,iBAAVA,EACT,OACEtO,KAAM,cACNmgB,OAAQ,KACRrL,GAAc,SAAVxG,EAAmB,KAAOA,EAC9B4Q,KAAgB,SAAV5Q,QAA0BrD,GAGlC,GAAKqD,EAAsB8R,OACzB,OACEpgB,KAAM,cACNmgB,OAAQ,KACRrL,GAAKxG,EAAsB8R,OAC3BtE,KAAOxN,EAAsB6B,IAC7B+O,KAAO5Q,EAAsB4Q,MAGzB,IAAAzN,EAAAnD,EAAEkM,EAAA/I,EAAA+I,KAAMgD,EAAA/L,EAAA+L,KAAM0B,EAAAzN,EAAAyN,KACpB,OAAI1E,GAEAxa,KAAM,cACNmgB,OAAQ,KACRrL,GAAI,OACJgH,KAAMtB,EACN0E,KAAIA,GAEG1B,GAEPxd,KAAM,cACNmgB,OAAQ,KACRrL,GAAI,OACJgH,KAAM0B,EACN0B,KAAIA,IAIJlf,KAAM,cACNmgB,OAAQ,KACRrL,GAAI,KACJgH,KAAM0B,EACN0B,KAAIA,GA5CMmB,CAAe/R,OD5C7BwK,QAAS,YACTC,MCkHC,SAAmBzK,GAChB,IAAA6Q,EAAA7Q,EAAA6Q,OAAQgB,EAAA7R,EAAA6R,OAAQpF,EAAAzM,EAAAyM,KAClBlE,GACJ7W,KAAM,cACNmgB,OAAQA,EAAOhb,cACfga,OAAMA,EACNpE,KAAMA,EAAc,IAAPA,EAAcA,GAG7B,OADAxX,KAAKqT,OAAOC,GACLtT,QDxHPiV,yBC2FqE,SAAClK,GAEtE,IAAM0P,EAAS1P,EAAMvH,SAAS0Q,cAG9B,OAFAiH,EAAgBf,cAAcK,IAG5BsC,YAAe,SAACxN,GASd,OANIA,EAAIiI,KACN2D,EAAgBS,OAAOrM,EAAIqN,OAAQrN,EAAIqM,OAAQrM,EAAIiI,MAEnD2D,EAAgBS,OAAOrM,EAAIqN,OAAQrN,EAAIqM,QAGlChT,QAAQC,eAvGkD,SAACkC,GAEtE,IAAM0P,EAAS1P,EAAMvH,SAAS0Q,cAQ9B,OAPAiH,EAAgBf,cAAcK,GAE1B1P,EAAMvH,SAAS6Q,YACjB8G,EAAgBlB,KAAK,KAAMlP,EAAMvH,SAAS6Q,YAE5C8G,EAAgBQ,KAAK,KAAM5Q,EAAMvH,SAAS8Q,cAElC0I,YAAe,SAACzN,GACf,IAAAqN,EAAArN,EAAAqN,OAAQrE,EAAAhJ,EAAAgJ,KAAMoD,EAAApM,EAAAoM,KACrB,OAAQpM,EAAIgC,IACV,IAAK,OACH4J,EAAgBlE,KAAK2F,EAAQrE,GAC7B,MACF,IAAK,OACH4C,EAAgBlB,KAAK2C,EAAQrE,GAC7B,MACF,IAAK,QACH4C,EAAgBhL,MAAMyM,GACtB,MACF,QACE,MAAM,IAAIxc,MAAM,yCAAyCmP,EAAIgC,GAAE,KASnE,YANa7J,IAATiU,GACFR,EAAgBQ,KAAKiB,EAAQjB,GAKxB/S,QAAQC,iBCxCnBoU,EAAA,oBAAAA,KAmDA,OAlDSA,EAAAnf,UAAAof,UAAP,SAAiBnS,GAQf,OALEtO,KAAM,YACN8Z,GAHMxL,EAAAwL,GAIN4G,KAJUpS,EAAAoS,KAKVC,QAASpd,KAAKqd,eAAetS,KAK1BkS,EAAAnf,UAAAwf,iBAAP,WACE,OACE7gB,KAAM,qBAIFwgB,EAAAnf,UAAAuf,eAAR,SAAuBtS,GACb,IAAA6N,EAAA7N,EAAA6N,SAAUK,EAAAlO,EAAAkO,KAAMH,EAAA/N,EAAA+N,GAAIjC,EAAA9L,EAAA8L,OAAQN,EAAAxL,EAAAwL,GAC9BjL,KA6BN,OA3BIsN,GACFtN,EAASxK,MACPrE,KAAM,eACNoc,SAAUD,IAGVE,GACFxN,EAASxK,MACPrE,KAAM,YACNsc,KAAMD,IAGNjC,GACFvL,EAASxK,MACPrE,KAAM,eACN8Z,GAAEA,IAGF0C,GACF3N,EAASxK,MACPrE,KAAM,WACNoc,SAAUI,IAEVxc,KAAM,kBAIH6O,GAEX2R,EAnDA,GCwEaM,EAAoB,IAvEjC,oBAAAC,IACUxd,KAAAyd,cAoEV,OAlESD,EAAA1f,UAAA4f,aAAP,SACEla,EACAma,GAEA,IAAMC,EAAS5d,KAAK6d,UAAUra,GAG9B,OAFAxD,KAAK8d,iBAAiBF,GACtB5d,KAAK+d,iBAAiBH,EAAQD,GACvBC,GAGFJ,EAAA1f,UAAAwf,iBAAP,WACEtd,KAAKyd,WAAazd,KAAKyd,WAAW1a,OAAO,SAAClH,EAAGoM,GAE3C,OADAA,EAAE4O,SACKhb,QAIJ2hB,EAAA1f,UAAAkgB,aAAP,SAAoBzH,GAClBvW,KAAKyd,WAAWzP,OAAO,SAAA/F,GAAK,OAAAA,EAAEsO,KAAOA,IAClCxS,QAAQ,SAAAkE,GAAK,OAAAA,EAAE4O,YAGZ2G,EAAA1f,UAAA+f,UAAR,SAAkBra,GAChB,IAAMoa,EAASrZ,SAAS+R,cAAc,UAEtC,OADAtW,KAAKie,sBAAsBL,EAAQpa,GAC5Boa,GAGDJ,EAAA1f,UAAAmgB,sBAAR,SAA8BL,EAA2Bpa,GACvD,IAAM0a,EAAa3R,EAAU/I,GAE7B0a,EAAMC,QAAUD,EAAMd,eACfc,EAAMd,QAEbQ,EAAOpH,UAAY0H,EAAMf,YAClBe,EAAMf,KAEbvgB,OAAA4P,EAAA,eAAA5P,CAAeshB,EAAO,SAAC5c,EAAMnE,GAC3BygB,EAAOtc,GAAQnE,IACd,GAAO,IAGJqgB,EAAA1f,UAAAggB,iBAAR,SAAyBF,GACvB5d,KAAKyd,WAAW3c,KAAK8c,IAGfJ,EAAA1f,UAAAigB,iBAAR,SAAyBH,EAA2BQ,GAChCpe,KAAKqe,aAAaD,GAC1B3H,YAAYmH,IAGhBJ,EAAA1f,UAAAugB,aAAR,SAAqBD,GACnB,IAAME,EAASF,GAAYpe,KAAKyZ,cAC1B8E,EhBtBH,SAA2BZ,EAAsBa,GACtD,IAAMC,EAAWd,EAAQe,aAAa,SACtCf,EAAQvE,aAAa,QAASqF,EAAW,iBACzC,IAAMzS,EAAgC2R,EAAQgB,WAA2B5H,iBAAiB,mBAAqByH,GAE/G,OADAb,EAAQvE,aAAa,QAASqF,GACvB1S,EAAWC,GgBiBO4S,CAAkBN,EAAQ,IAAI1S,EAASE,sBAAwB,GACtF,GAAIyS,EAAkB,OAAOA,EAE7B,IAAMM,EAAeta,SAAS+R,cAAc,OAG5C,OAFAuI,EAAazF,aAAa,QAASxN,EAASE,sBAC5CwS,EAAO7H,YAAYoI,GACZA,GAGDrB,EAAA1f,UAAA2b,YAAR,WACE,OAAOlV,SAAS4P,eAAevI,EAASC,gBAG5C2R,EArEA,ICNMsB,EAAiB,IAAI7B,ECDpB,IAAM8B,GACX3J,gBAEIG,QAAS,YACTC,MDcC,SAAiCzK,GACtC,IAAMwE,EAAMuP,EAAe5B,UAAUnS,GACrC/K,KAAKwT,aAAajE,MCbdgG,QAAS,mBACTC,MDmCC,WACL,IAAMjG,EAAMuP,EAAexB,mBAC3Btd,KAAKwT,aAAajE,MClClB0F,yBDRmE,SAAClK,GAEpE,IAAM0P,EAAS1P,EAAMvH,SAAS0Q,cAE9B,OAAQgJ,UAAa,SAAC3N,GACpB,IAAM/L,GACJ4Z,QAAS,WAAM,OAAArS,EAAMC,cAAcK,YAAYkE,EAAI6N,UACnDD,KAAM5N,EAAI4N,KACV5G,GAAIhH,EAAIgH,IAGV,OADAgH,EAAkBG,aAAala,EAAUiX,GAClC7R,QAAQC,eAmByD,SAACkC,GAE5DA,EAAMvH,SAAS0Q,cAE9B,OAAQoJ,iBAAoB,SAAC/N,GAE3B,OADAgO,EAAkBD,mBACX1U,QAAQC,eAhBqD,SAACkC,GAExDA,EAAMvH,SAAS0Q,cAE9B,OAAQ8J,aAAgB,SAACzO,GAEvB,OADAgO,EAAkBS,aAAazO,EAAIgH,IAC5B3N,QAAQC,iBEoBnB,IAAMmW,GACJC,IAAK,SAACC,EAAMC,GAAS,OAAAD,EAAOC,GAC5BC,SAAU,SAACF,EAAMC,GAAS,OAAAD,EAAOC,GACjCE,SAAU,SAACH,EAAMC,GAAS,OAAAD,EAAOC,GACjCG,OAAQ,SAACJ,EAAMC,GAAS,OAAAD,EAAOC,GAC/BI,oBAAqB,SAACL,EAAMC,GAAS,OAAAD,EAAOC,GAC5CK,oBAAqB,SAACN,EAAMC,GAAS,OAAA/c,KAAKiK,MAAM6S,EAAOC,IACvDM,kBAAmB,SAACP,EAAMC,GAAS,OAAA/c,KAAKsd,KAAKR,EAAOC,IACpDQ,gBAAiB,SAACT,EAAMC,GAAS,OAAA/c,KAAKH,MAAMid,EAAOC,IACnDld,MAAO,SAACid,GAAS,OAAA9c,KAAKH,MAAMid,IAC5BU,QAAS,SAACV,GAAS,OAAA9c,KAAKsd,KAAKR,IAC7BW,UAAW,SAACX,GAAS,OAAA9c,KAAKiK,MAAM6S,KC1D3B,IAAMY,GACX1K,gBACEG,QAAS,cACTC,MC0BG,SAAmCuK,GACxC,GAAIA,EAAYpM,IAChB,CACE,IAAML,GAAyC7W,KAAK,qBAAsBsR,QAAUgS,EAAYpM,IAAMqM,SAAUD,EAAYE,SAC5HjgB,KAAKwT,aAAaF,QAIfyM,EAAY5iB,QAEPmW,GAAqC7W,KAAK,iBAAkBU,MAAO4iB,EAAY5iB,MAAQ6iB,SAAUD,EAAYE,SACnHjgB,KAAKwT,aAAaF,IAItB,OAAOtT,QDvCLuV,QAAS,YACTC,MD+DG,SAAiC9B,GACtC,IAAIpJ,EAAa,GACbnM,EAAc,EAClB,GAAIuV,EAAWuL,IACb3U,EAAK,MACLnM,EAAMuV,EAAWuL,SAEd,GAAIvL,EAAW0L,SAClB9U,EAAK,WACLnM,EAAMuV,EAAW0L,cAEd,GAAI1L,EAAW2L,SAClB/U,EAAK,WACLnM,EAAMuV,EAAW2L,aAEd,KAAI3L,EAAW4L,OAIf,CACH,IAAMY,KACN,IAAK,IAAM5e,KAAQoS,EACbA,EAAW3V,eAAeuD,IAC5B4e,EAASpf,KAAK,IAAIQ,EAAI,KAG1B,IAAMmP,EAAU,iJAAiJyP,EAASnf,KAAK,MAAK,IACpL,MAAM,IAAIX,MAAMqQ,GAXhBnG,EAAK,SACLnM,EAAMuV,EAAW4L,OAanB,IAAMhM,GACJ7W,KAAM,YACNsR,QAAS2F,EAAWC,IACpBwM,UAAW7V,EACXnN,MAAOgB,EACP6hB,SAAUtM,EAAWuM,SAEvBjgB,KAAKwT,aAAaF,MClGhBiC,QAAS,YACTC,MEaG,SAA0CuK,GAC/C,IAAMzM,GAAsC7W,KAAK,kBAAmB2P,IAAK2T,EAAY3T,IAAK9H,IAAKyb,EAAYzb,IAAK0b,SAAUD,EAAYE,SACtIjgB,KAAKwT,aAAaF,MFblB2B,yBCSwE,SAAClK,GACzE,OACEqV,eAAkB,SAAC7Q,GAEjB,OADAxE,EAAMJ,UAAU4E,EAAIyQ,UAAYzQ,EAAIpS,MAC7ByL,QAAQC,eAbyD,SAACkC,GAC7E,OACEsV,mBAAsB,SAAC9Q,GAErB,OADAxE,EAAMJ,UAAU4E,EAAIyQ,UAAYjV,EAAMJ,UAAU4E,EAAIxB,SAC7CnF,QAAQC,eFWgD,SAACkC,GAEpE,OACEuV,UACE,SAAC/Q,GACC,OAAA3G,QAAQC,QAIT,SACLwI,EACA9B,GAEQ,IAAA5E,EAAA0G,EAAA1G,UACAwV,EAAA5Q,EAAA4Q,UAAWpS,EAAAwB,EAAAxB,QAAS5Q,EAAAoS,EAAApS,MAAO6iB,EAAAzQ,EAAAyQ,SAC7BO,EAAgB5V,EAAUoD,GAGhC,OAFApD,EAAUqV,GAmBZ,SAAsBvO,GACpB,IAAM+O,EAAexB,EAAWvN,GAChC,IAAK+O,EACH,MAAM,IAAIpgB,MAAM,gBAAgBqR,EAAQ,uCAE1C,OAAO+O,EAvBLC,CAAaN,EAAbM,CAAwBF,EAAepjB,MAZnBujB,CAAY3V,EAAOwE,OG3BgC,SAACxE,GAE1E,OACE4V,gBACE,SAACpR,GACC,OAAA3G,QAAQC,QAIT,SACLwI,EACA9B,GAIA,OADA8B,EAAM1G,UAAU4E,EAAIyQ,UAAY7T,EAAaoD,EAAInD,IAAKmD,EAAIjL,QATpCqc,CAAgB5V,EAAOwE,SCPxC,IAAMqR,GACXxL,gBACEG,QAAS,SACTC,MCcG,WAELxV,KAAKwT,cADwC/W,KAAK,qBDbhD8Y,QAAS,QACTC,MECG,SAAmCqD,GACxC,IAAMvF,GAAiC7W,KAAK,cAAeoc,SAAQA,GACnE7Y,KAAKwT,aAAaF,MFDhBiC,QAAS,UACTC,MGHG,SAAoCqD,GACzC,IAAMvF,GAAkC7W,KAAK,eAAgBoc,SAAQA,GACrE7Y,KAAKwT,aAAaF,MHGhBiC,QAAS,OACTC,MIRG,SAA4BqD,GACjC,IAAMvN,EAIR,SAAiCuN,GAI/B,QACIpc,KAAM,WAAYoc,SAAQA,IAC1Bpc,KAAM,kBAVOokB,CAAwBhI,GACzC7Y,KAAKwT,aAAYzT,MAAjBC,KAAqBsL,MJQnBiK,QAAS,OACTC,MKPG,SAA4BgC,GACjC,IACMlE,GAA2B7W,KAAK,OAAQ+a,KADxB,IAAPA,GAEfxX,KAAKwT,aAAaF,MLMlB2B,yBCtBuE,SAAClK,GACxE,OACE+V,cAAiB,SAACvR,GAIhB,OAAO3G,QAAQC,SAFbgH,UAAW,aAOuD,SAAC9E,GACzE,OACEgW,eAAkB,SAACxR,GAIjB,OAAO3G,QAAQC,SAFbgH,UAAW,cEfqD,SAAC9E,GAEvE,OACEiW,aAAgB,SAACzR,GAGf,OADAxE,EAAMC,cAAcG,cAAcoE,EAAIsJ,UAC/BjQ,QAAQC,eDNkD,SAACkC,GAEtE,OACEkW,YAAe,SAAC1R,GACd,IAAMqL,KACN,OAAO,IAAIhS,QAAQ,SAAOC,GAAO,OAAAN,OAPvCb,OAOuC,qEAC9B,SAAMqD,EAAMC,cAAcG,cAAcoE,EAAIsJ,yBAA5C3K,EAAApE,OAAuD9D,KAAK,OAAQ,WAAM,OAAA6C,EAAQ+R,mBENvB,SAAC7P,GACnE,OACEmW,SAAY,SAAC3R,GAEX,OADAxE,EAAMC,cAAcG,cAAcoE,EAAIsJ,UAC/BjQ,QAAQC,eCJ2C,SAACkC,GAE/D,OACEyR,KAAQ,SAACjN,GACP,IAAMqL,KAEN,OAAO,IAAIhS,QAAQ,SAAAC,GACjB0T,WAAW,WAAM,OAAA1T,EAAQ+R,IAAYrL,EAAIiI,aCe1C,IAAM2J,GACX/L,gBACEG,QAAS,MACTC,MAXJ,SAA2B4L,GACzB,IAAM9N,GACJ7W,KAAM,MACNU,MAAOikB,GAETphB,KAAKwT,aAAaF,MAQlB2B,yBA1B6D,SAAClK,GAC9D,OACEsW,IAAO,SAAC9R,GAMN,OALiB,MAAbA,EAAIpS,MACNuT,QAAQ2Q,IAAItW,EAAMJ,WAElB+F,QAAQ2Q,IAAI9R,EAAIpS,OAEXyL,QAAQC,iBCGRyY,GACXlM,gBACEG,QAAS,KACTC,MAAK,SAAeuD,GAClB/Y,KAAKwT,cAAc/W,KAAM,YAAasc,KAAIA,OAG9C9D,yBAlBmE,SAAClK,GACpE,OACEwW,UAAa,SAAOhS,GAAuB,OAAAhH,OAL/Cb,OAK+C,qEACzC,SAAMkB,QAAQC,QAAQ0G,EAAIwJ,gBAC1B,OADA7K,EAAApE,QACA,gBCMO0X,EAAK1N,EAAOa,OACvB2M,EACA9G,EACAmC,EACAoC,EACAoC,EACArB,EACAc,GCpBF3kB,EAAAO,EAAAilB,EAAA,uBAAAD","file":"iv.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// see https://javascriptweblog.wordpress.com/2011/08/08/fixing-the-javascript-typeof-operator/\r\n// via http://stackoverflow.com/a/7390612/1386201\r\n/*\r\n    toType({a: 4}); //\"object\"\r\n    toType([1, 2, 3]); //\"array\"\r\n    (function() {console.log(toType(arguments))})(); //\"arguments\"\r\n    toType(new ReferenceError); //\"error\"\r\n    toType(new Date); //\"date\"\r\n    toType(/a-z/); //\"regexp\"\r\n    toType(Math); //\"math\"\r\n    toType(JSON); //\"json\"\r\n    toType(new Number(4)); //\"number\"\r\n    toType(new String(\"abc\")); //\"string\"\r\n    toType(new Boolean(true)); //\"boolean\"\r\n    toType(null); //\"null\"\r\n    toType(); //\"undefined\"\r\n    toType( () => {} ); //\"function\"\r\n*/\r\nfunction toType(val) {\r\n    return ({}).toString.call(val).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\r\n}\r\nexports.toType = toType;\r\nfunction round(value, decimals) {\r\n    if (decimals === void 0) { decimals = 2; }\r\n    return Number(Math.round(Number(value + 'e' + decimals)) + 'e-' + decimals);\r\n}\r\nexports.round = round;\r\nfunction clone(obj) {\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\nexports.clone = clone;\r\nfunction isEmpty(val) {\r\n    var emptyTypes = ['null', 'undefined'];\r\n    var checkableTypes = ['object', 'array', 'arguments', 'json', 'string'];\r\n    var type = toType(val);\r\n    if (emptyTypes.indexOf(type) > -1) {\r\n        return true;\r\n    }\r\n    if (checkableTypes.indexOf(type) > -1) {\r\n        if (type === 'string')\r\n            return val.length === 0; // IE fails on the next line if a string.\r\n        if (Object.getOwnPropertyNames(val).length === 0)\r\n            return true;\r\n        return val.length === 0;\r\n    }\r\n    // other types return false because they are, by nature, filled ()\r\n    return false;\r\n}\r\nexports.isEmpty = isEmpty;\r\nfunction isNotEmpty(val) {\r\n    return !isEmpty(val);\r\n}\r\nexports.isNotEmpty = isNotEmpty;\r\nfunction wrapObjectWithProperty(obj, propName, preserveOriginal) {\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var wrapper = {};\r\n    var newObj = preserveOriginal ? clone(obj) : obj;\r\n    wrapper[propName] = newObj;\r\n    return wrapper;\r\n}\r\nexports.wrapObjectWithProperty = wrapObjectWithProperty;\r\nfunction isObject(x) {\r\n    return (toType(x) === 'object');\r\n}\r\nexports.isObject = isObject;\r\n// Traverses an object.\r\n// callback should return an array with a key, then a value if constructing a\r\n// new object is desired. Kind of like Array.map, but for objects\r\nfunction traverseObject(obj, callback, recursive, preserveOriginal) {\r\n    if (recursive === void 0) { recursive = false; }\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var newObject = preserveOriginal ? clone(obj) : obj;\r\n    var returnedObj = {};\r\n    for (var key in newObject) {\r\n        if (newObject.hasOwnProperty(key) === false)\r\n            continue;\r\n        if (isObject(newObject[key]) && recursive) {\r\n            var args = Array.from(arguments);\r\n            var argsMinusFirst = args.slice().slice(1);\r\n            var recursedObject = traverseObject.apply(this, [newObject[key]].concat(argsMinusFirst));\r\n            if (!isEmpty(recursedObject)) {\r\n                newObject[key] = recursedObject;\r\n            }\r\n        }\r\n        var keyValArray = callback(key, newObject[key]);\r\n        if (Array.isArray(keyValArray) && keyValArray.length === 2) {\r\n            returnedObj[keyValArray[0]] = keyValArray[1];\r\n        }\r\n        else if (!isEmpty(keyValArray)) {\r\n            throw new Error(\"It looks like you might have been trying to construct a new object, but you returned something other than an array that looks like [key, value]. You returned \" + keyValArray);\r\n        }\r\n    }\r\n    return returnedObj;\r\n}\r\nexports.traverseObject = traverseObject;\r\nfunction nestedPropertyDetails(obj, propertyPath) {\r\n    var pathParts = propertyPath.split('.');\r\n    var currentObject = obj;\r\n    var exists = true;\r\n    var existingPath = [];\r\n    while (exists && pathParts.length > 0) {\r\n        var newPart = pathParts.shift();\r\n        if (newPart && currentObject[newPart]) {\r\n            existingPath.push(newPart);\r\n            currentObject = currentObject[newPart];\r\n        }\r\n        else {\r\n            exists = false;\r\n        }\r\n    }\r\n    return {\r\n        exists: exists,\r\n        existingPath: existingPath.join('.'),\r\n        finalValidProperty: currentObject,\r\n    };\r\n}\r\nexports.nestedPropertyDetails = nestedPropertyDetails;\r\nfunction nestedPropertyTest(obj, propertyPath, callback) {\r\n    var details = nestedPropertyDetails(obj, propertyPath);\r\n    if (details.exists) {\r\n        return !!callback(details.finalValidProperty);\r\n    }\r\n    return false;\r\n}\r\nexports.nestedPropertyTest = nestedPropertyTest;\r\nfunction nestedPropertyExists(obj, propertyPath) {\r\n    return nestedPropertyDetails(obj, propertyPath).exists;\r\n}\r\nexports.nestedPropertyExists = nestedPropertyExists;\r\nfunction changePropsInitialCase(obj, whichCase, recursive, preserveOriginal) {\r\n    if (recursive === void 0) { recursive = false; }\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var makeAspVersion = (whichCase === 'UpperFirst') ? true : false;\r\n    var newObj = preserveOriginal ? clone(obj) : obj;\r\n    var regex = makeAspVersion ? /[a-z]/ : /[A-z]/;\r\n    return traverseObject(newObj, function (key, prop) {\r\n        var originals = [key, prop];\r\n        if (typeof key !== 'string')\r\n            return originals;\r\n        if (key.charAt(0).match(regex) === null)\r\n            return originals;\r\n        var newKey = makeAspVersion ? firstCharToUpper(key) : firstCharToLower(key);\r\n        return [newKey, prop];\r\n    }, recursive);\r\n}\r\nexports.changePropsInitialCase = changePropsInitialCase;\r\nfunction firstCharToUpper(str) {\r\n    return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\nexports.firstCharToUpper = firstCharToUpper;\r\nfunction firstCharToLower(str) {\r\n    return str.charAt(0).toLowerCase() + str.slice(1);\r\n}\r\nexports.firstCharToLower = firstCharToLower;\r\nfunction convertPropKeysForAsp(obj) {\r\n    return changePropsInitialCase(obj, 'UpperFirst', true);\r\n}\r\nexports.convertPropKeysForAsp = convertPropKeysForAsp;\r\nfunction convertPropKeysForJs(obj) {\r\n    return changePropsInitialCase(obj, 'lowerFirst', true);\r\n}\r\nexports.convertPropKeysForJs = convertPropKeysForJs;\r\nfunction valuesArrayFromObject(obj) {\r\n    if (!isObject(obj)) {\r\n        throw new Error(\"'obj' was not an object. Was \" + toType(obj));\r\n    }\r\n    return Object.keys(obj).map(function (key) { return obj[key]; });\r\n}\r\nexports.valuesArrayFromObject = valuesArrayFromObject;\r\nfunction objectContainsValue(val, obj) {\r\n    return valuesArrayFromObject(obj).indexOf(val) !== -1;\r\n}\r\nexports.objectContainsValue = objectContainsValue;\r\nfunction objectKeyForValue(val, obj) {\r\n    if (!objectContainsValue(val, obj))\r\n        return false;\r\n    return Object.keys(obj).reduce(function (a, currentKey) {\r\n        if (obj[currentKey] === val) {\r\n            a = currentKey;\r\n        }\r\n        return a;\r\n    }, '');\r\n}\r\nexports.objectKeyForValue = objectKeyForValue;\r\nfunction forceArray(val) {\r\n    var emptyReturns = ['null', 'undefined'];\r\n    if (emptyReturns.indexOf(toType(val)) !== -1)\r\n        return [];\r\n    if (toType(val) !== 'array') {\r\n        return [val];\r\n    }\r\n    return val;\r\n}\r\nexports.forceArray = forceArray;\r\nvar noCircularRefs = function () {\r\n    var valCache = [];\r\n    var keyCache = [];\r\n    var isFirstRun = true;\r\n    return function (key, value) {\r\n        if (typeof value === 'object' && value !== null) {\r\n            if (isFirstRun) {\r\n                key = '__BASE_OBJECT__'; // eslint-disable-line no-param-reassign\r\n                isFirstRun = false;\r\n            }\r\n            var indexOfFoundValue = valCache.indexOf(value);\r\n            if (indexOfFoundValue !== -1) {\r\n                // Circular reference found, discard key\r\n                return \"[circular reference of \" + keyCache[indexOfFoundValue] + \"]\";\r\n            }\r\n            // Store value in our collection\r\n            valCache.push(value);\r\n            keyCache.push(key);\r\n        }\r\n        return value; // eslint-disable-line consistent-return\r\n    };\r\n};\r\nfunction stringify(obj, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var defaults = {\r\n        tabLength: 2,\r\n        stripQuotes: false,\r\n        sort: false,\r\n    };\r\n    var settings = Object.assign({}, defaults, options);\r\n    var tabLength = settings.tabLength, stripQuotes = settings.stripQuotes, sort = settings.sort;\r\n    if (sort) {\r\n        if (toType(obj) === 'array') {\r\n            var newObj = obj.sort();\r\n            return finalStringification(newObj, tabLength, stripQuotes);\r\n        }\r\n        else if (toType(obj) === 'object') {\r\n            var newObj_1 = {};\r\n            var keys = Object.keys(obj).sort();\r\n            keys.forEach(function (key) {\r\n                newObj_1[key] = obj[key];\r\n            });\r\n            return finalStringification(newObj_1, tabLength, stripQuotes);\r\n        }\r\n        return finalStringification(obj, tabLength, stripQuotes);\r\n    }\r\n    return finalStringification(obj, tabLength, stripQuotes);\r\n}\r\nexports.stringify = stringify;\r\nfunction finalStringification(obj, tabLength, stripQuotes) {\r\n    var str = JSON.stringify(obj, noCircularRefs(), tabLength);\r\n    if (stripQuotes) {\r\n        str = str.replace(/\"(.*?)\": /g, '$1: ');\r\n    }\r\n    return str;\r\n}\r\n/**\r\n * Returns true if the deep values of an object are equal.\r\n */\r\nfunction deepEqual(objA, objB) {\r\n    var stringifyOptions = { sort: true };\r\n    return stringify(objA, stringifyOptions) === stringify(objB, stringifyOptions);\r\n}\r\nexports.deepEqual = deepEqual;\r\n/*\r\n  The following are not tested with `npm test` and are unreliable for certain situations.\r\n  see http://stackoverflow.com/a/8876069\r\n*/\r\nfunction mediaWidth() {\r\n    return Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\r\n}\r\nexports.mediaWidth = mediaWidth;\r\nfunction mediaHeight() {\r\n    return Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\r\n}\r\nexports.mediaHeight = mediaHeight;\r\n//# sourceMappingURL=main.js.map","module.exports = (function (nav) {\n    isMobile = function () {\n        var check = false;\n        if (\n            /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(nav) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(nav.substr(0, 4))\n        ) check = true;\n        return check;\n    };\n\n    isMobileOrTablet = function () {\n        var check = false;\n        if (\n            /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(nav) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(nav.substr(0, 4))\n        ) check = true;\n        return check;\n    };\n\n    return {\n        isMobile: isMobile,\n        isMobileOrTablet: isMobileOrTablet\n    }\n\n}(navigator.userAgent || navigator.vendor || window.opera));","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export class IvCommandEngine implements CommandEngine.Class {\r\n  private targetFunctions: Runner.TargetFunctionObject = {};\r\n  private runners: {[x: string]: Runner.Class} = {};\r\n\r\n  constructor(\r\n    private settings: CommandEngine.ctor['settings'],\r\n    private nodes: CommandEngine.ctor['nodes'],\r\n    private commandRunnerClass: CommandEngine.ctor['commandRunnerClass'],\r\n    private variables: CommandEngine.ctor['variables'],\r\n  ) { }\r\n\r\n  public registerTargetFunction(factory: CommandEngine.TargetFunctionFactory) {\r\n    const input = { settings: this.settings , variables: this.variables , commandEngine: this };\r\n    Object.assign(this.targetFunctions, factory(input));\r\n  }\r\n\r\n  public run(name?: string) {\r\n    this.createRunners();\r\n    if (name) {\r\n      this.runNodeByName(name);\r\n    } else {\r\n      this.runFirstNode();\r\n    }\r\n  }\r\n\r\n  public runCommands(commands: ICommand.AnyCommand[]) {\r\n    return this.createCommandRunner(commands).run();\r\n  }\r\n\r\n  private createRunners() {\r\n    const targetFunctions = this.targetFunctions;\r\n    this.nodes.forEach(node => {\r\n      const commands = node.getCommands();\r\n      this.runners[node.name] = this.createCommandRunner(commands);\r\n    })\r\n  }\r\n\r\n  private createCommandRunner(commands: ICommand.AnyCommand[]): Runner.Class {\r\n    return new this.commandRunnerClass({\r\n      variables: this.variables,\r\n      targetFunctions: this.targetFunctions,\r\n      commands\r\n    })\r\n  }\r\n\r\n  private runFirstNode() {\r\n    if (this.nodes[0]) {\r\n      this.getRunnerForNode(this.nodes[0].name).run();\r\n    }\r\n  }\r\n\r\n  public runNodeByName(name: string): Promise<Runner.Class> {\r\n    return this.getRunnerForNode(name).run();\r\n  }\r\n\r\n  private getRunnerForNode(name: string) {\r\n    return this.runners[name];\r\n  }\r\n}\r\n","export const defaults = {\r\n  baseElementId: 'IV-view',\r\n  buttonContainerClass: 'IV-button-container',\r\n}\r\n","import { defaults } from '../lib/config'\r\n\r\nexport function qsaToArray(qsa: NodeListOf<HTMLElement>): HTMLElement[] {\r\n  let index = 0;\r\n  const outArray: HTMLElement[] = []\r\n  for (index = 0; index < qsa.length; index++) {\r\n    outArray.push(qsa[index])\r\n  }\r\n  return outArray;\r\n}\r\n\r\nexport function querySelectorAll(selector: string) {\r\n  return qsaToArray(document.querySelectorAll(selector));\r\n}\r\n\r\nexport function getAllVideos(): HTMLVideoElement[] {\r\n  return qsaToArray(document.querySelectorAll(`#${defaults.baseElementId} video`)) as HTMLVideoElement[];\r\n}\r\n\r\nexport function getCurrentVideo() {\r\n  return document.getElementById('IV-video-player-1') as HTMLVideoElement;\r\n}\r\n\r\nexport function getNextVideo() {\r\n  return document.getElementById('IV-video-player-2') as HTMLVideoElement;\r\n}\r\n\r\nexport function getAllAudioPlayers(): HTMLAudioElement[] {\r\n  return qsaToArray(document.querySelectorAll(`#${defaults.baseElementId} audio`)) as HTMLAudioElement[];\r\n}\r\n\r\nexport function getAudioPlayerNamed(name: string) {\r\n  return document.getElementById(`IV-audio-player-${name.toLowerCase()}`) as HTMLAudioElement;\r\n}\r\n\r\nexport function getBgAudioPlayer() {\r\n  return getAudioPlayerNamed('BG');\r\n}\r\n\r\nexport function getSfxAudioPlayer() {\r\n  return getAudioPlayerNamed('SFX');\r\n}\r\n","import { toType, traverseObject } from 'happy-helpers';\r\nimport { qsaToArray } from '../test-support/dom-commands';\r\nexport { qsaToArray }\r\n\r\nexport function getRandomInt(min: number, max: number): number {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nexport function wait(time?: number) {\r\n  return new Promise(res => {\r\n    setTimeout(res, time);\r\n  })\r\n}\r\n\r\nfunction safeCloneObject<T extends object>(obj: T): T {\r\n  const outgoing = {};\r\n  traverseObject(obj, (prop, value) => {\r\n    if (toType(value) === 'array') {\r\n      outgoing[prop] = nearClone(value);\r\n    } else if (toType(value) === 'object') {\r\n      outgoing[prop] = safeCloneObject(value);\r\n    } else {\r\n      outgoing[prop] = value;\r\n    }\r\n  }, false, false);\r\n  return outgoing as T;\r\n}\r\n\r\nexport function nearClone<T extends any>(obj: T): T {\r\n  const type = toType(obj);\r\n\r\n  if (isObject(obj)) {\r\n    return safeCloneObject(obj);\r\n  } else if (type === 'array') {\r\n    return obj.map(x => nearClone(x))\r\n  } else {\r\n    return obj;\r\n  }\r\n}\r\n\r\nfunction isObject(obj: any): obj is object {\r\n  return toType(obj) === 'object';\r\n}\r\n\r\nexport function directDescendants(element: HTMLElement, selector): HTMLElement[] | [null] {\r\n  const oldClass = element.getAttribute('class');\r\n  element.setAttribute('class', oldClass + \" IV-searching\");\r\n  const qsa: NodeListOf<HTMLElement> = (element.parentNode as HTMLElement).querySelectorAll('.IV-searching > ' + selector);\r\n  element.setAttribute('class', oldClass);\r\n  return qsaToArray(qsa);\r\n}\r\n\r\nexport function urlsMatch(url1: string, url2: string): boolean {\r\n  return sanitizeUrl(url1) === sanitizeUrl(url2);\r\n}\r\n\r\nexport function sanitizeUrl(url: string): string {\r\n  if (url.substr(0, 2) === '//') {\r\n    return `${document.location.protocol}${url}`;\r\n  }\r\n  if (url[0] === '/') {\r\n    return `${document.location.origin}${url}`;\r\n  }\r\n  if (url.indexOf('/') === -1) {\r\n    return `${document.location.origin}/${url}`;    \r\n  }\r\n  return url;\r\n}","// Liquid markup (https://shopify.github.io/liquid/) inspired\r\nimport { toType } from 'happy-helpers';\r\nimport { getRandomInt } from './utils';\r\n\r\nexport class PartialLiquid {\r\n  private LIQUID_ONE = /\\{\\{(.*?)( ?\\| ?(.*)?)?\\}\\}/\r\n  private LIQUID_ALL = new RegExp(this.LIQUID_ONE, 'g');\r\n\r\n  public implementedFilters = {\r\n    'random': this.randomFilter.bind(this)\r\n  }\r\n\r\n  constructor(private variables: IV.Variables) { }\r\n\r\n  public replace(str: string): any {\r\n    const parts = this.getParts(str);\r\n    if (!parts) { return str; }\r\n    if (parts.whole === str) {\r\n      return this.sendRawVar(str);\r\n    } else {\r\n      return this.replaceAsString(str);\r\n    }\r\n  }\r\n\r\n  private replaceAsString(str): string {\r\n    return str.replace(this.LIQUID_ALL, (substring: string) => {\r\n      return this.filteredVariable(substring).toString();\r\n    });\r\n  }\r\n\r\n  private getParts(str: string): {whole: string, varName: string, filter: string} | null {\r\n    const matches = str.match(this.LIQUID_ONE);\r\n    if (!matches) { return null; }\r\n    const [whole, varName, pipePhrase, filter] = matches;\r\n    return { whole, varName, filter };\r\n  }\r\n\r\n  private sendRawVar(str: string): any {\r\n    let variable;\r\n    str.replace(this.LIQUID_ALL, (substring) => {\r\n      variable = this.filteredVariable(substring)\r\n      return substring;\r\n    });\r\n    return variable;\r\n  }\r\n\r\n  private filteredVariable(substring: string): any {\r\n    const { whole, varName, filter } = this.getParts(substring);\r\n    if (filter) {\r\n      return this.doFilter(varName, filter);\r\n    } else {\r\n      return this.variables[varName];\r\n    }\r\n  }\r\n\r\n  private doFilter(varName: string, filter: string) {\r\n    const method = this.implementedFilters[filter];\r\n    if (!method) {\r\n      throw new Error(`There is no filter called \"${filter}\"`)\r\n    }\r\n    return method(varName)\r\n  }\r\n\r\n  private randomFilter(varName: string): any {\r\n    const values = this.variables[varName] as any[];\r\n    if (toType(values) !== 'array') {\r\n      throw new Error('You cannot use the random filter on a non-array');\r\n    }\r\n\r\n    const randomIndex = getRandomInt(0, values.length - 1);\r\n    return values[randomIndex];\r\n  }\r\n}","import { EventEmitter } from 'eventemitter3';\r\nimport { toType, traverseObject } from 'happy-helpers';\r\nimport { PartialLiquid } from '../../lib/partial-liquid';\r\nimport { nearClone } from '../utils';\r\n\r\nexport class CommandRunner implements Runner.Class {\r\n  public status: Runner.Status;\r\n\r\n  private events = new EventEmitter();\r\n  private targets: Runner.ConstructorInput['targetFunctions'] = {};\r\n  private commands: Runner.ConstructorInput['commands'];\r\n  private variables: Runner.ConstructorInput['variables']\r\n  private replacer: PartialLiquid;\r\n  private runQueue: Array<() => void> = [];\r\n\r\n  private getFunctionFor(name: string) {\r\n    if (!this.targets[name]) {\r\n      throw new Error(`There is no registered function to execute the \"${name}\" command.`);\r\n    }\r\n    return this.targets[name];\r\n  }\r\n\r\n  private nextIndex = 0;\r\n\r\n  constructor({commands, targetFunctions, variables}: Runner.ConstructorInput) {\r\n    this.commands = commands;\r\n    this.targets = targetFunctions;\r\n    this.variables = variables;\r\n    this.replacer = new PartialLiquid(this.variables);\r\n    this.setStatus('ready');\r\n  }\r\n\r\n  public run(): Promise<this> {\r\n    if (this.canRun()) {\r\n      return this.doRun();\r\n    } else {\r\n      return this.enqueueRun();\r\n    }\r\n  }\r\n\r\n  public on(event, listener) {\r\n    return this.events.on(event, listener);\r\n  }\r\n\r\n  public once(event, listener) {\r\n    return this.events.once(event, listener);\r\n  }\r\n\r\n  private doRun(): Promise<this> {\r\n    this.setStatus('running');\r\n    this.runNextCommand();\r\n    return Promise.resolve(this);\r\n  }\r\n\r\n  private enqueueRun(): Promise<this> {\r\n    let doRun: () => void;\r\n    const willRun: Promise<this> = new Promise(resolve => {\r\n      doRun = () => {\r\n        resolve(this.doRun())\r\n      }\r\n    })\r\n    this.runQueue.push(doRun)\r\n    return willRun;\r\n  }\r\n\r\n  private canRun(): boolean {\r\n    return this.status !== 'running' && this.status !== 'waiting'\r\n  }\r\n\r\n  private setStatus(status: Runner.Status) {\r\n    this.events.emit(status);\r\n    this.status = status;\r\n  }\r\n\r\n  private resetIndex() {\r\n    this.nextIndex = 0;\r\n  }\r\n\r\n  private advanceIndex() {\r\n    this.nextIndex++;\r\n  }\r\n\r\n  private runNextCommand() {\r\n    if (this.status !== 'running') { return; }\r\n\r\n    const cmd = this.commands[this.nextIndex]\r\n    if (cmd) {\r\n      this.advanceIndex()\r\n      this.runCommand(cmd)\r\n        .then(cmdReturn => this.evaluateReturn(cmdReturn))\r\n        .then(() => this.runNextCommand())\r\n    } else {\r\n      this.exit();\r\n    }\r\n  }\r\n\r\n  private async evaluateReturn(theReturn: Runner.CommandReturn) {\r\n    const {commands, requests, asyncCommands} = theReturn;\r\n    if (asyncCommands) { this.asyncSeries(asyncCommands); }\r\n    if (commands) { await this.runNewSeries(commands); }\r\n    await this.evaluateRequests(requests);\r\n  }\r\n\r\n  private async evaluateRequests(requests: Runner.CommandReturn['requests']) {\r\n    if (!requests) { return; }\r\n    if (requests.some(r => r === 'exit')) { return this.exit(); }\r\n    if (requests.some(r => r === 'pause')) { return this.pause(); }\r\n    return;\r\n  }\r\n\r\n  private exit() {\r\n    this.resetIndex();\r\n    const runImmediately = this.runQueue.shift();\r\n    if (runImmediately) { return runImmediately(); }\r\n    this.setStatus('done');\r\n  }\r\n\r\n  private pause() {\r\n    this.setStatus('paused');\r\n  }\r\n\r\n  private asyncSeries(eventualCommands: Promise<Runner.Command[]>) {\r\n    eventualCommands.then(commands => {\r\n      this.runNewSeries(commands)\r\n      .catch((err: Error) => {\r\n        const beginningMessage = err.message.slice(0,10) + '...'\r\n        console.error(`the error thrown above (beginning \"${beginningMessage}\") was in an async branch`);\r\n      })\r\n    })\r\n    .catch(err => {\r\n      if (err === 'cancelled') { return; }\r\n      console.error('An error occurred inside a promise for an asyncCommands object. This occurred before the commands were invoked on a runner:');\r\n      console.error(err);\r\n    })\r\n  }\r\n\r\n  private runNewSeries(commands: Runner.Command[]) {\r\n    return new Promise(res => {\r\n      const runner = new CommandRunner({\r\n        targetFunctions: this.targets,\r\n        commands,\r\n        variables: this.variables\r\n      });\r\n      runner.once('done', res);\r\n      runner.run();\r\n    }).catch(err => {\r\n      console.error('a child runner threw an error:')\r\n      console.error(err)\r\n      throw err;\r\n    })\r\n  }\r\n\r\n  private runCommand(incomingCommand: Runner.Command) {\r\n    const cmd = this.replaceVariables(incomingCommand);\r\n    const targetFunction = this.getFunctionFor(cmd.name);\r\n    return targetFunction(cmd);\r\n  }\r\n\r\n  private replaceVariables(incoming: Runner.Command): Runner.Command {\r\n    let outgoing = nearClone(incoming);\r\n\r\n    outgoing = traverseObject(outgoing, (prop, value) => {\r\n      if (toType(value) === 'string') {\r\n        value = this.replaceVariableInString(value);\r\n      }\r\n      return [prop, value];\r\n    }, true, false);\r\n\r\n    return outgoing;\r\n  }\r\n\r\n\r\n  private replaceVariableInString(str: string): string {\r\n    return this.replacer.replace(str);\r\n  }\r\n}\r\n","export const switchFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'switch':\r\n      (cmd: ICommand.Switch) =>\r\n        Promise.resolve(doSwitch(input, cmd))\r\n  }\r\n}\r\n\r\nexport function doSwitch(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.Switch\r\n): Runner.CommandReturn {\r\n  const { variables } = given;\r\n  let winningCommands;\r\n  cmd.do.forEach(condition => {\r\n    if (winningCommands) { return; }\r\n    winningCommands = winningCommandsOrNull(condition, variables)\r\n  })\r\n  const commands = winningCommands || cmd.defaultCommands\r\n  return {commands};\r\n}\r\n\r\nfunction winningCommandsOrNull(\r\n  condition: SwitchDo.Any,\r\n  variables: CommandEngine.TargetFunctionFactoryInput['variables'],\r\n): SwitchDo.Base['commands'] | null {\r\n  const operator = determineOperator(condition);\r\n  const variable = variables[condition.varName];\r\n  const operand = condition[operator]\r\n  if (checkCondition(operator, variable, operand)) {\r\n    return condition.commands;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction lowest(arr: number[]) {\r\n  return Math.min(...arr)\r\n}\r\n\r\nfunction highest(arr: number[]) {\r\n  return Math.max(...arr)\r\n}\r\n\r\nconst operatorFunctions = {\r\n  is: (variable, operand) => variable === operand,\r\n  isGreaterThan: (variable, operand) => variable > operand,\r\n  isLessThan: (variable, operand) => variable < operand,\r\n  isGreaterThanOrEqualTo: (variable, operand) => variable >= operand,\r\n  isLessThanOrEqualTo: (variable, operand) => variable <= operand,\r\n  isBetween: (variable, arr) => (lowest(arr) <= variable) && (variable <= highest(arr))\r\n}\r\n\r\nfunction determineOperator(singleDo: SwitchDo.Any): string {\r\n  for (const prop in singleDo) {\r\n    if (operatorFunctions.hasOwnProperty(prop)) {\r\n      return prop;\r\n    }\r\n  }\r\n\r\n  const unusedProps = [];\r\n  for (const unusedProp in singleDo) {\r\n    if (singleDo.hasOwnProperty(unusedProp)) {\r\n      unusedProps.push(unusedProp);\r\n    }\r\n  }\r\n  throw new Error(`could not find a valid operator in switch.do. Given these possibilities: ${unusedProps.join(', ')}`)\r\n}\r\n\r\nfunction checkCondition(operator, variable, operand): boolean {\r\n  const opFunc = operatorFunctions[operator];\r\n  return opFunc(variable, operand);\r\n}\r\n","import { IvCommandEngine } from './command-engine';\r\nimport { CommandRunner } from './command-runner';\r\nimport { switchFactory } from './switch';\r\n\r\nexport function createEngine(engineConstructorInput: CommandEngine.ctor, ...functionFactories) {\r\n  const { settings, nodes, variables, commandRunnerClass } = engineConstructorInput;\r\n  const engine = new IvCommandEngine(settings, nodes, commandRunnerClass, variables);\r\n  \r\n  functionFactories.forEach(factory => {\r\n    engine.registerTargetFunction(factory);\r\n  })\r\n\r\n  return engine;\r\n}\r\n\r\nexport function createBaseEngine(engineConstructorInput: Omit<CommandEngine.ctor, 'commandRunnerClass'>, ...functionFactories) {\r\n  const { settings, nodes, variables } = engineConstructorInput;\r\n  const engine = createEngine({settings, nodes, variables, commandRunnerClass: CommandRunner}, ...functionFactories);\r\n  \r\n  engine.registerTargetFunction(switchFactory) // This powers the if statements that are necessary for base-node\r\n  \r\n  return engine;\r\n}\r\n","interface SwitchBase {\r\n  var: string;\r\n}\r\n\r\ninterface Is extends SwitchBase {\r\n  is: string | number | boolean;\r\n}\r\n\r\ninterface IsGreaterThan extends SwitchBase {\r\n  isGreaterThan: number;\r\n}\r\n\r\ninterface IsLessThan extends SwitchBase {\r\n  isLessThan: number;\r\n}\r\n\r\ninterface IsBetween extends SwitchBase {\r\n  isBetween: number[];\r\n}\r\n\r\n\r\ninterface IsGreaterThanOrEqualTo extends SwitchBase {\r\n  isGreaterThanOrEqualTo: number;\r\n}\r\n\r\ninterface IsLessThanOrEqualTo extends SwitchBase {\r\n  isLessThanOrEqualTo: number;\r\n}\r\n\r\ntype ifOptions = Partial<\r\n    Is\r\n  & IsGreaterThan\r\n  & IsLessThan\r\n  & IsGreaterThanOrEqualTo\r\n  & IsLessThanOrEqualTo\r\n  & IsBetween\r\n>\r\n\r\nexport interface NodeExtensions {} // tslint:disable-line no-empty-interface\r\n\r\ntype ArgumentTypes<T> = T extends (...args: infer U) => infer R ? U : never;\r\ntype ReplaceReturnType<T, TNewReturn> = (...a: ArgumentTypes<T>) => TNewReturn;\r\n\r\ntype NodeExtended = {\r\n  [P in keyof NodeExtensions]: ReplaceReturnType<NodeExtensions[P], IvNode>\r\n};\r\n\r\nexport type IvNode = Node & NodeExtended\r\n\r\nexport class Node implements BaseNode {\r\n  private commands: ICommand.AnyCommand[] = [];\r\n  private switchDo: ICommand.Switch;\r\n  private pushType: string = 'main';\r\n\r\n  constructor( public name: string ) { }\r\n\r\n\r\n  public getCommands() {\r\n    return this.commands;\r\n  }\r\n\r\n  private pusher(command: ICommand.AnyCommand[] | ICommand.AnyCommand){\r\n    if (Array.isArray(command)) { return command.forEach(c => this.pusher(c)) }\r\n    if(this.pushType === 'condition')\r\n    {\r\n      this.switchDo.do[this.switchDo.do.length - 1].commands.push(command);\r\n    }\r\n    else if(this.pushType === 'default')\r\n    {\r\n      this.switchDo.defaultCommands.push(command);\r\n    }\r\n    else\r\n    {\r\n      this.commands.push(command);\r\n    }\r\n  }\r\n\r\n  public pushCommands(...commands: ICommand.AnyCommand[]): void {\r\n    this.pusher(commands);\r\n  }\r\n\r\n  public if(optionsObj: ifOptions): IvNode {\r\n    // TODO: need to instantiate a new for each if.\r\n    if (this.switchDo == null)\r\n    {\r\n    this.switchDo = {name: 'switch', do: [], defaultCommands: []};\r\n    }\r\n    this.pushType = 'condition';\r\n      if (optionsObj.is)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, is: optionsObj.is, commands: []});\r\n      }\r\n      else if (optionsObj.isGreaterThan)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThan: optionsObj.isGreaterThan, commands: []});\r\n      }\r\n      else if (optionsObj.isLessThan)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isLessThan: optionsObj.isLessThan, commands: []});\r\n      }\r\n      else if (optionsObj.isBetween)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isBetween: optionsObj.isBetween, commands: []});\r\n      }\r\n      else if (optionsObj.isGreaterThanOrEqualTo)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThanOrEqualTo: optionsObj.isGreaterThanOrEqualTo, commands: []});\r\n      }\r\n      else if (optionsObj.isLessThanOrEqualTo)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThanOrEqualTo: optionsObj.isLessThanOrEqualTo, commands: []});\r\n      }\r\n    return this as any as IvNode;\r\n  }\r\n\r\n  public else(): IvNode {\r\n    this.pushType = 'default';\r\n    return this as any as IvNode;\r\n  }\r\n\r\n  public endIf(): IvNode {\r\n    this.pushType = 'main';\r\n    this.pusher(this.switchDo);\r\n    return this as any as IvNode;\r\n  }\r\n}\r\n","import { isMobileOrTablet } from 'mobile-detector';\r\nimport { createBaseEngine, IvCommandEngine } from './command-engine';\r\nimport { defaults } from './config';\r\nimport { IvNode, Node } from './node';\r\nimport { qsaToArray } from './utils';\r\n\r\ninterface ConstructorInput {\r\n  variables?: Partial<IV.Variables>;\r\n  settings?: Partial<IV.Settings>;\r\n}\r\n\r\ninterface ApiFunctionRegistration {\r\n  apiExtensions: Array<{\r\n    apiName: string;\r\n    apiFn: (this: IvNode, ...userArgs: any[]) => void;\r\n  }>;\r\n}\r\n\r\ninterface TargetFunctionRegistration {\r\n  targetFunctionFactories: CommandEngine.TargetFunctionFactory[],\r\n}\r\n\r\nexport type PluginRegistration = \r\n    ApiFunctionRegistration\r\n  | TargetFunctionRegistration\r\n  | (TargetFunctionRegistration & ApiFunctionRegistration)\r\n\r\nfunction isApiRegistration(pr: PluginRegistration): pr is ApiFunctionRegistration {\r\n  return !!(pr as Partial<ApiFunctionRegistration>).apiExtensions\r\n}\r\n\r\nfunction isTargetFnRegistration(pr: PluginRegistration): pr is TargetFunctionRegistration {\r\n  return !!(pr as Partial<TargetFunctionRegistration>).targetFunctionFactories\r\n}\r\n\r\nexport class BaseIV {\r\n  public static extend(...registrations: PluginRegistration[]): typeof BaseIV {\r\n    const originalNodeKlass = this.nodeKlass;\r\n    const newNodeKlass = class extends originalNodeKlass { }; // tslint:disable-line max-classes-per-file\r\n    const targetFunctionFactories: CommandEngine.TargetFunctionFactory[] = [];\r\n    registrations.forEach(plugin => {\r\n      if (isApiRegistration(plugin)) {\r\n        plugin.apiExtensions.forEach(extension => {\r\n          newNodeKlass.prototype[extension.apiName] = function() { extension.apiFn.apply(this, arguments); return this; };\r\n        });\r\n      }\r\n      if (isTargetFnRegistration(plugin)) {\r\n        targetFunctionFactories.push(...plugin.targetFunctionFactories);\r\n      }\r\n    });\r\n    return class extends this { // tslint:disable-line max-classes-per-file\r\n      protected additionalFactories = targetFunctionFactories;\r\n      protected static nodeKlass = newNodeKlass;\r\n      protected nodeKlassReference = newNodeKlass;\r\n    };\r\n  }\r\n\r\n  public variables: Partial<IV.Variables> = {};\r\n  public settings: Partial<IV.Settings> = {};\r\n\r\n  private defaultSettings: IV.Settings = {\r\n    baseContainer: document.getElementById(defaults.baseElementId),\r\n    baseVideoUrl: '',\r\n    bgAudioUrl: null,\r\n    bgAudioLoop: true,\r\n  }\r\n\r\n  private engine: IvCommandEngine;\r\n\r\n  private nodes: IvNode[] = []\r\n  protected static nodeKlass = Node;\r\n  protected nodeKlassReference = Node;\r\n  protected additionalFactories: CommandEngine.TargetFunctionFactory[] = [];\r\n\r\n  constructor(initialState: ConstructorInput = {}) {\r\n    const {variables, settings} = initialState;\r\n    if (variables) {\r\n      this.variables = variables;\r\n    }\r\n    if (settings) {\r\n      this.settings = settings;\r\n    }\r\n    this.validateDom();\r\n  }\r\n\r\n  public node(name: string): IvNode {\r\n    const newNode = new this.nodeKlassReference(name) as IvNode;\r\n    this.nodes.push(newNode);\r\n    return newNode;\r\n  }\r\n\r\n  public defineNode = this.node; // tslint:disable-line member-ordering\r\n\r\n  public run(name?: string) {\r\n    this.runOnAnyPlatform(this.getEngine(), name);\r\n  }\r\n\r\n  public createRunButton(name?: string, node?: string): HTMLButtonElement {\r\n    const engine = this.getEngine();\r\n    const btn = this.createKickoffButton(name)\r\n    this.runViaButton(btn, engine, node);\r\n    return btn;\r\n  }\r\n\r\n  private getEngine(): IvCommandEngine {\r\n    return this.engine ? this.engine : this.engine = createBaseEngine(\r\n      {\r\n        settings: this.getSettings(),\r\n        nodes: this.nodes,\r\n        variables: this.variables,\r\n      },\r\n     ...this.additionalFactories,\r\n    );\r\n  }\r\n\r\n  private validateDom() {\r\n    if (!this.getSetting('baseContainer')) {\r\n      throw new Error(`No valid node present in HTML`)\r\n    }\r\n  }\r\n\r\n  private getSetting(name: keyof IV.Settings) {\r\n    if (this.settings[name] !== undefined) { return this.settings[name]; }\r\n    return this.defaultSettings[name];\r\n  }\r\n\r\n  private getSettings() {\r\n    const settings = {};\r\n    for (const key of Object.keys(this.defaultSettings)) {\r\n      settings[key] = this.getSetting(key as keyof IV.Settings);\r\n    }\r\n    return settings as IV.Settings;\r\n  }\r\n\r\n  private runOnAnyPlatform(engine: IvCommandEngine, name?: string) {\r\n    if (this.isMobileOrTablet()) {\r\n      this.runViaButton(this.createKickoffButton(), engine, name);\r\n    } else {\r\n      engine.run(name);\r\n    }\r\n  }\r\n\r\n  private isMobileOrTablet() {\r\n    return isMobileOrTablet();\r\n  }\r\n\r\n  private createKickoffButton(label = 'Kickoff') {\r\n    const startBtn = document.createElement('button');\r\n    startBtn.type = 'button';\r\n    startBtn.id = 'IV-kickoff';\r\n    startBtn.innerHTML = label;\r\n    (this.getSettings().baseContainer as HTMLElement).appendChild(startBtn);\r\n    return startBtn;\r\n  }\r\n\r\n  private runViaButton(btn: HTMLElement, engine, name?: string) {\r\n    const handleClick = () => {\r\n      btn.removeEventListener('click', handleClick);\r\n      this.prepVideosForMobile();\r\n      btn.remove();\r\n      engine.run(name);\r\n    }\r\n    btn.addEventListener('click', handleClick);\r\n  }\r\n\r\n  private prepVideosForMobile() {\r\n    // TODO: move this method to VideoController\r\n    // and call from here, or with registered kickoff event\r\n    const videos = qsaToArray(document.querySelectorAll('video')) as HTMLVideoElement[]\r\n    videos.forEach(vid => {\r\n      vid.play();\r\n      vid.pause();\r\n    })\r\n  }\r\n}\r\n","interface VideoSettings {\r\n  url: string;\r\n  // loop: boolean; // TODO: implement\r\n  goTo: string;\r\n  runSync: string;\r\n  runAsync: string;\r\n  js: (...args) => any\r\n}\r\n\r\ntype VideoOptions = Partial<VideoSettings>\r\n\r\nexport type PlayVideoInput = (string | VideoOptions);\r\n\r\nexport class VideoCommandsBuilder {\r\n  public playVideo(...input: PlayVideoInput[]): ICommand.PlayVideo[] {\r\n    if (Array.isArray(input[0])) {\r\n      return this.handleDepricatedArrayInput(input[0] as PlayVideoInput[]);\r\n    } else {\r\n      return this.handleArrayInput(input);\r\n    }\r\n  }\r\n\r\n  public clearVideo(time?: number): Array<ICommand.Wait | ICommand.ClearVideo> {\r\n    const commands = []\r\n\r\n    if (time) {\r\n      const msTime = time * 1000;\r\n      const command: ICommand.Wait = { name: 'wait', time: msTime };\r\n      commands.push(command);\r\n    }\r\n\r\n    const clearVideoCommand: ICommand.ClearVideo = { name: 'clearVideo' };\r\n    commands.push(clearVideoCommand);\r\n\r\n    return commands;\r\n  }\r\n\r\n  private handleDepricatedArrayInput(array: PlayVideoInput[]) {\r\n    console.warn('Passing an array to playVideo (or the alias \"videoPlay\") is deprecated. Just pass values as individual arguments. (Remove the `[` and `]` from the method call.)')\r\n    return this.playVideo(...array);\r\n  }\r\n\r\n  private handleArrayInput(input: Array<string | VideoOptions>): ICommand.PlayVideo[] {\r\n    const singleCommand = input\r\n      .map(objOrStr => this.guaranteedOptionsObject(objOrStr))\r\n      .reduce(this.mergeMissingUrlsReducer, [])\r\n      .map(vo => this.createPlayCommandFromOptions(vo))\r\n      .reduceRight(this.reduceOnCompleteIntoPrevious, null)\r\n\r\n    return [singleCommand]\r\n  }\r\n\r\n  private mergeMissingUrlsReducer(a: VideoOptions[], current: VideoOptions): VideoOptions[] {\r\n    if (current.url) {\r\n      a.push(current);\r\n    } else {\r\n      const lastObj = a[a.length - 1];\r\n      if (!lastObj) {\r\n        throw new Error('Previous object does not exist. This error can occur if the first object passed to `playVideo` does not contain a url.');\r\n      }\r\n      Object.assign(lastObj, current);\r\n    }\r\n    return a;\r\n  }\r\n\r\n  private reduceOnCompleteIntoPrevious(\r\n    a: ICommand.PlayVideo | null,\r\n    command: ICommand.PlayVideo\r\n  ) {\r\n    if (!a) { return command; }\r\n    command.onComplete = command.onComplete || [];\r\n    command.onComplete.push(a);\r\n    return command;\r\n  }\r\n\r\n  private guaranteedOptionsObject(singleInput: PlayVideoInput): VideoOptions {\r\n    if (typeof singleInput === 'object') {\r\n      return singleInput;\r\n    } else {\r\n      return {url: singleInput};\r\n    }\r\n  }\r\n\r\n  private createPlayCommandFromOptions(obj: VideoOptions) {\r\n    const addedProps = { name: 'playVideo' as 'playVideo' };\r\n    const remappedProps = {file: obj.url};\r\n    const commandProps = this.commandOptionsToCommands(obj);\r\n    const finalObj: ICommand.PlayVideo = {...addedProps, ...remappedProps, ...commandProps};\r\n    return finalObj;\r\n  }\r\n\r\n  private commandOptionsToCommands(inputObj: VideoOptions): Partial<ICommand.PlayVideo> {\r\n    let onComplete: ICommand.AnyCommand[] = [];\r\n    function addCommands(commands: ICommand.AnyCommand | ICommand.AnyCommand[]) {\r\n      onComplete = onComplete.concat(commands)\r\n    }\r\n\r\n    if (inputObj.runAsync) {\r\n      addCommands({\r\n        name: 'executeAsync',\r\n        nodeName: inputObj.runAsync\r\n      });\r\n    }\r\n    if (inputObj.js) {\r\n      addCommands({\r\n        name: 'executeJs',\r\n        func: inputObj.js\r\n      });\r\n    }\r\n    if (inputObj.runSync) {\r\n      addCommands({\r\n        name: 'executeSync',\r\n        nodeName: inputObj.runSync\r\n      });\r\n    }\r\n    if (inputObj.goTo) {\r\n      addCommands([\r\n        { name: 'goToNode', nodeName: inputObj.goTo },\r\n        { name: 'stopExecution' }\r\n      ]);\r\n    }\r\n\r\n    return onComplete.length > 0 ? {onComplete} : {};\r\n  }\r\n}\r\n","function createVideoPlayer(id: string) {\r\n  const player = document.createElement('video');\r\n  player.id = id;\r\n  player.setAttribute('playsinline', 'true');\r\n  player.setAttribute('disableRemotePlayback', 'true');\r\n  const style = 'block';  // fixes the android black frame issue.  Aparently it does not like 'inline'\r\n  player.style.display = style;\r\n  return player;\r\n}\r\n\r\nclass VideoController {\r\n  private baseElement: HTMLElement = document.body;\r\n  private isFirstPlay = true;\r\n\r\n  private players = {\r\n    current: createVideoPlayer('IV-video-player-1'),\r\n    standby: createVideoPlayer('IV-video-player-2'),\r\n  }\r\n\r\n  public playVideo(url: string): Promise<any> {\r\n    const standby = this.getStandbyPlayer();\r\n    const current = this.getCurrentPlayer();\r\n    standby.onloadeddata = () => {\r\n      current.src = url;\r\n      current.play();\r\n      standby.onloadeddata = () => {}; // tslint:disable-line\r\n    }\r\n    standby.src = url;\r\n    standby.load() // essential for mobile safari\r\n    return this.whenPlayerEnds(current);\r\n  }\r\n\r\n  private whenPlayerEnds(player: HTMLVideoElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('video ended');\r\n        player.removeEventListener('ended', onEnded);\r\n      }\r\n      player.addEventListener('ended', onEnded);\r\n    })\r\n  }\r\n\r\n  public createPlayers(baseElement?: HTMLElement): void {\r\n    this.baseElement = baseElement;\r\n    this.attachPlayers(); // multiple calls are fine... does not duplicate\r\n  }\r\n\r\n  private attachPlayers() {\r\n    this.baseElement.appendChild(this.players.standby)\r\n    this.baseElement.appendChild(this.players.current)\r\n  }\r\n\r\n  public getCurrentPlayer() {\r\n    return this.players.current;\r\n  }\r\n\r\n  public getStandbyPlayer() {\r\n    return this.players.standby;\r\n  }\r\n}\r\n\r\nexport const videoController = new VideoController();","import { IvNode } from '../../../node';\r\nimport { PlayVideoInput, VideoCommandsBuilder } from './video-commands-builder';\r\nimport { urlsMatch } from '../../../utils';\r\nimport { videoController } from './video-controller';\r\n\r\nexport const playVideoFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  videoController.createPlayers(baseEl);\r\n\r\n  return {'playVideo': (cmd: ICommand.PlayVideo) => {\r\n    const videoToPlay = `${input.settings.baseVideoUrl}${cmd.file}`;\r\n    const onPlayerEnd = videoController.playVideo(videoToPlay);\r\n    const returnObj: Runner.CommandReturn = {};\r\n\r\n    if (cmd.onComplete) {\r\n      const completing = new Promise((res, rej) => {\r\n        onPlayerEnd.then(() => {\r\n          if (urlsMatch(videoController.getCurrentPlayer().src, videoToPlay)) {\r\n            res(cmd.onComplete);\r\n          } else {\r\n            rej('cancelled');\r\n          }\r\n        })\r\n      }) as Promise<Runner.Command[]>\r\n\r\n      returnObj.asyncCommands = completing;\r\n    }\r\n    return Promise.resolve(returnObj);\r\n  }}\r\n}\r\n\r\nconst videoCommandBuilder = new VideoCommandsBuilder();\r\n\r\nexport function playVideo(this: IvNode, ...input: PlayVideoInput[]) : void {\r\n  this.pushCommands(...videoCommandBuilder.playVideo(...input));\r\n}\r\n\r\nexport function videoPlay(this: IvNode, ...input: PlayVideoInput[]): void {\r\n  console.warn('The `videoPlay` command is deprecated. Please Use `playVideo`')\r\n  this.pushCommands(...videoCommandBuilder.playVideo(...input))\r\n}\r\n","import { IvNode } from '../../../node';\r\nimport { VideoCommandsBuilder } from './video-commands-builder';\r\nimport { videoController } from './video-controller';\r\n\r\nexport const clearVideoFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  videoController.createPlayers(baseEl);\r\n\r\n  return {\r\n    'clearVideo': async (cmd: ICommand.PlayVideo) => {\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nconst videoCommandBuilder = new VideoCommandsBuilder();\r\n\r\nexport function clearVideo(this: IvNode, time?: number): void {\r\n  this.pushCommands(...videoCommandBuilder.clearVideo(time));\r\n}\r\n","import { playVideo, playVideoFactory, videoPlay } from './play-video'\r\nimport { clearVideo, clearVideoFactory } from './clear-video';\r\nimport { PluginRegistration } from '../../../base-iv';\r\n\r\nexport const videoPlugin: PluginRegistration = {\r\n  apiExtensions: [{\r\n    apiName: 'playVideo',\r\n    apiFn: playVideo,\r\n  }, {\r\n    apiName: 'clearVideo',\r\n    apiFn: clearVideo,\r\n  }, {\r\n    apiName: 'videoPlay', // Deprecated\r\n    apiFn: videoPlay,\r\n  }],\r\n  targetFunctionFactories: [\r\n    playVideoFactory,\r\n    clearVideoFactory\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions {\r\n    clearVideo: typeof clearVideo\r\n    playVideo: typeof playVideo\r\n    videoPlay: typeof videoPlay\r\n  }\r\n}\r\n","import { wait } from '../../../utils';\r\n\r\nfunction createAudioPlayer(id: string): HTMLAudioElement {\r\n  const player = document.createElement('audio');\r\n  player.id = id;\r\n  return player;\r\n}\r\n\r\nclass AudioController {\r\n  public _fadeInterval = 200;\r\n  private baseElement: HTMLElement = document.body;\r\n\r\n  private players = {\r\n    bg: createAudioPlayer('IV-audio-player-bg'),\r\n    sfx: createAudioPlayer('IV-audio-player-sfx'),\r\n  }\r\n\r\n  public play(playerName: ICommand.AudioSource['target'], url?: string): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (url && player.src !== url) {\r\n      player.src = url;\r\n    }\r\n    player.play();\r\n    return this.whenPlayerEnds(player);\r\n  }\r\n\r\n  public pause(playerName: ICommand.AudioSource['target']): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    player.pause();\r\n    return Promise.resolve('audio paused');\r\n  }\r\n\r\n  public load(playerName: ICommand.AudioSource['target'], url: string): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (url && player.src !== url) {\r\n      player.src = url;\r\n    }\r\n    return this.whenPlayerLoads(player);\r\n  }\r\n\r\n  public loop(playerName: ICommand.AudioSource['target'], loop: boolean): void {\r\n    this.getPlayerNamed(playerName).loop = loop;\r\n  }\r\n\r\n  public volume(playerName, volume, time?): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (time && time > this._fadeInterval) {\r\n      this.fadeOverTime(player, volume, time);\r\n    } else {\r\n      player.volume = volume;\r\n    }\r\n    return Promise.resolve('audio volume adjusted');\r\n  }\r\n\r\n  private async fadeOverTime(player, desiredVolume, time) {\r\n    const startTime = Date.now();\r\n    const startVolume = player.volume;\r\n    const totalAdjustment = desiredVolume - startVolume;\r\n    let currentPercent = 0;\r\n\r\n    function percentComplete() {\r\n      const traveled = Date.now() - startTime;\r\n      currentPercent = Math.min(traveled / time, 1);\r\n      return currentPercent;\r\n    }\r\n\r\n    while (currentPercent < 1) {\r\n      player.volume = startVolume + (totalAdjustment * percentComplete());\r\n      if (currentPercent === 1) { player.volume = desiredVolume; }\r\n      await wait(this._fadeInterval)\r\n    }\r\n  }\r\n\r\n  private whenPlayerEnds(player: HTMLAudioElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('audio ended');\r\n        player.removeEventListener('ended', onEnded);\r\n      }\r\n      player.addEventListener('ended', onEnded);\r\n    })\r\n  }\r\n\r\n  private whenPlayerLoads(player: HTMLAudioElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('audio loaded');\r\n        player.removeEventListener('loadeddata', onEnded);\r\n      }\r\n      player.addEventListener('loadeddata', onEnded);\r\n    })\r\n  }\r\n\r\n  public createPlayers(baseElement?: HTMLElement): void {\r\n    this.baseElement = baseElement;\r\n    this.attachPlayers(); // multiple calls are fine... does not duplicate\r\n  }\r\n\r\n  private attachPlayers() {\r\n    this.baseElement.appendChild(this.players.bg)\r\n    this.baseElement.appendChild(this.players.sfx)\r\n  }\r\n\r\n  public getBgPlayer() {\r\n    return this.players.bg;\r\n  }\r\n\r\n  public getSfxPlayer() {\r\n    return this.players.sfx;\r\n  }\r\n\r\n  public getPlayerNamed<T extends ICommand.AudioSource['target']>(name: T): HTMLAudioElement {\r\n    return this.players[name.toLowerCase()]\r\n  }\r\n}\r\n\r\nexport const audioController = new AudioController();\r\n","import { audioSourceFactory, audioVolumeFactory, bgAudio, setVolume } from './audio-commands';\r\nimport { PluginRegistration } from '../../../base-iv';\r\n\r\nexport const audioCommandsRegistration: PluginRegistration = {\r\n  apiExtensions: [\r\n    {\r\n      apiName: 'bgAudio',\r\n      apiFn: bgAudio,\r\n    },\r\n    {\r\n      apiName: 'setVolume',\r\n      apiFn: setVolume,\r\n    }\r\n  ],\r\n  targetFunctionFactories: [\r\n    audioVolumeFactory,\r\n    audioSourceFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions {\r\n    bgAudio: typeof bgAudio;\r\n    setVolume: typeof setVolume;\r\n  }\r\n}","import { IvNode } from '../../../node';\r\nimport { audioController } from './audio-controller';\r\n\r\ninterface AudioAction {\r\n  action: 'play' | 'pause' | 'load';\r\n  url?: string;\r\n  loop?: boolean;\r\n}\r\n\r\ninterface AudioShorthand {\r\n  play?: string;\r\n  load?: string;\r\n  loop?: boolean;\r\n}\r\n\r\ntype AudioInput = 'play' | 'pause' | 'loop' | AudioShorthand | AudioAction;\r\n\r\nexport const audioSourceFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  audioController.createPlayers(baseEl);\r\n\r\n  if (input.settings.bgAudioUrl) {\r\n    audioController.load('BG', input.settings.bgAudioUrl)\r\n  }\r\n  audioController.loop('BG', input.settings.bgAudioLoop)\r\n\r\n  return {'audioSource': (cmd: ICommand.AudioSource) => {\r\n    const {target, file, loop} = cmd;\r\n    switch (cmd.do) {\r\n      case 'play':\r\n        audioController.play(target, file);\r\n        break;\r\n      case 'load':\r\n        audioController.load(target, file);\r\n        break;\r\n      case 'pause':\r\n        audioController.pause(target)\r\n        break;\r\n      default:\r\n        throw new Error(`unexpected command for audio source: \"${cmd.do}\"`);\r\n    }\r\n\r\n    if (loop !== undefined) {\r\n      audioController.loop(target, loop);\r\n    }\r\n\r\n    const returnObj: Runner.CommandReturn = {};\r\n\r\n    return Promise.resolve(returnObj);\r\n  }}\r\n}\r\n\r\nexport function bgAudio(this: IvNode, input: AudioInput) {\r\n  this.pushCommands(bgAudioCommand(input));\r\n}\r\n\r\nfunction bgAudioCommand(input: AudioInput): ICommand.AudioSource {\r\n  if (typeof input === 'string') {\r\n    return {\r\n      name: 'audioSource',\r\n      target: 'BG',\r\n      do: input === 'loop' ? null : input,\r\n      loop: input === 'loop' ? true : undefined,\r\n    }\r\n  } else {\r\n    if ((input as AudioAction).action) {\r\n      return {\r\n        name: 'audioSource',\r\n        target: 'BG',\r\n        do: (input as AudioAction).action,\r\n        file: (input as AudioAction).url,\r\n        loop: (input as AudioAction).loop,\r\n      }\r\n    } else {\r\n      const { play, load, loop } = input as AudioShorthand;\r\n      if (play) {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: 'play',\r\n          file: play,\r\n          loop\r\n        }\r\n      } else if (load) {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: 'load',\r\n          file: load,\r\n          loop\r\n        }\r\n      } else {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: null,\r\n          file: load,\r\n          loop\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const audioVolumeFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  audioController.createPlayers(baseEl);\r\n\r\n  return {\r\n    'audioVolume': (cmd: ICommand.AudioVolume) => {\r\n      const returnObj: Runner.CommandReturn = {};\r\n\r\n      if (cmd.time) {\r\n        audioController.volume(cmd.target, cmd.volume, cmd.time)\r\n      } else {\r\n        audioController.volume(cmd.target, cmd.volume)\r\n      }\r\n\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport function setVolume(input: { target: 'bg' | 'sfx', volume: number, time?: number }): IvNode {\r\n  const { volume, target, time } = input;\r\n  const command: ICommand.AudioVolume = {\r\n    name: 'audioVolume',\r\n    target: target.toUpperCase() as 'BG' | 'SFX',\r\n    volume,\r\n    time: time ? time * 1000 : time,\r\n  }\r\n  this.pusher(command);\r\n  return this as any as IvNode;\r\n}\r\n","export interface ButtonOptions {\r\n  id: string;\r\n  text: string;\r\n  goTo?: string;\r\n  runAsync?: string;\r\n  remove?: boolean;\r\n  js?: () => any,\r\n}\r\n\r\nexport class ButtonCommandsBuilder {\r\n  public addButton(input: ButtonOptions) {\r\n    const { id, text } = input;\r\n    const cmd: ICommand.AddButton = {\r\n      name: 'addButton',\r\n      id,\r\n      text,\r\n      onClick: this.createCommands(input)\r\n    }\r\n    return cmd;\r\n  }\r\n\r\n  public removeAllButtons(): ICommand.RemoveAllButtons {\r\n    return {\r\n      name: 'removeAllButtons'\r\n    }\r\n  }\r\n\r\n  private createCommands(input: ButtonOptions): ICommand.AnyCommand[] {\r\n    const { runAsync, goTo, js, remove, id } = input;\r\n    const commands: ICommand.AnyCommand[] = [];\r\n\r\n    if (runAsync) {\r\n      commands.push({\r\n        name: 'executeAsync',\r\n        nodeName: runAsync,\r\n      })\r\n    }\r\n    if (js) {\r\n      commands.push({\r\n        name: 'executeJs',\r\n        func: js\r\n      })\r\n    }\r\n    if (remove) {\r\n      commands.push({\r\n        name: 'removeButton',\r\n        id\r\n      })\r\n    }\r\n    if (goTo) {\r\n      commands.push({\r\n        name: 'goToNode',\r\n        nodeName: goTo\r\n      },{\r\n        name: 'stopExecution'\r\n      })\r\n    }\r\n\r\n    return commands;\r\n  }\r\n}\r\n","import { traverseObject } from 'happy-helpers';\r\nimport { defaults } from '../../../config';\r\nimport { directDescendants, nearClone } from '../../../utils'\r\n\r\nexport interface IButtonSettings {\r\n  text: string;\r\n  onClick(): any;\r\n  [s:string]: any;\r\n}\r\n\r\nclass ButtonsController {\r\n  private allButtons: HTMLButtonElement[] = [];\r\n\r\n  public createButton(\r\n    settings: IButtonSettings,\r\n    element?: HTMLElement\r\n  ): HTMLButtonElement {\r\n    const button = this.newButton(settings);\r\n    this.addToButtonStore(button);\r\n    this.appendToDocument(button, element);\r\n    return button;\r\n  }\r\n\r\n  public removeAllButtons() {\r\n    this.allButtons = this.allButtons.reduce((a, b) => {\r\n      b.remove();\r\n      return a;\r\n    }, [])\r\n  }\r\n\r\n  public removeButton(id: string) {\r\n    this.allButtons.filter(b => b.id === id)\r\n      .forEach(b => b.remove());\r\n  }\r\n\r\n  private newButton(settings: IButtonSettings): HTMLButtonElement {\r\n    const button = document.createElement('button');\r\n    this.applySettingsToButton(button, settings);\r\n    return button;\r\n  }\r\n\r\n  private applySettingsToButton(button: HTMLButtonElement, settings: IButtonSettings) {\r\n    const attrs: any = nearClone(settings);\r\n\r\n    attrs.onclick = attrs.onClick;\r\n    delete attrs.onClick;\r\n\r\n    button.innerHTML = attrs.text\r\n    delete attrs.text;\r\n\r\n    traverseObject(attrs, (prop, value) => {\r\n      button[prop] = value\r\n    }, false, false)\r\n  }\r\n\r\n  private addToButtonStore(button: HTMLButtonElement) {\r\n    this.allButtons.push(button);\r\n  }\r\n\r\n  private appendToDocument(button: HTMLButtonElement, parentEl?: HTMLElement) {\r\n    const container = this.getContainer(parentEl);\r\n    container.appendChild(button);\r\n  }\r\n\r\n  private getContainer(parentEl?: HTMLElement): HTMLElement {\r\n    const parent = parentEl || this.baseElement();\r\n    const foundContainer = directDescendants(parent, `.${defaults.buttonContainerClass}`)[0]\r\n    if (foundContainer) { return foundContainer; }\r\n\r\n    const newContainer = document.createElement('div');\r\n    newContainer.setAttribute('class', defaults.buttonContainerClass);\r\n    parent.appendChild(newContainer);\r\n    return newContainer;\r\n  }\r\n\r\n  private baseElement(): HTMLElement {\r\n    return document.getElementById(defaults.baseElementId);\r\n  }\r\n\r\n}\r\n\r\nexport const buttonsController = new ButtonsController();\r\n","import { IvNode } from '../../../node';\r\nimport { ButtonCommandsBuilder, ButtonOptions } from './button-commands-builder';\r\nimport { buttonsController, IButtonSettings } from './buttons-controller';\r\n\r\nconst buttonCommands = new ButtonCommandsBuilder();\r\n\r\nexport const addButtonFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'addButton': (cmd: ICommand.AddButton) => {\r\n    const settings: IButtonSettings = {\r\n      onClick: () => input.commandEngine.runCommands(cmd.onClick),\r\n      text: cmd.text,\r\n      id: cmd.id,\r\n    };\r\n    buttonsController.createButton(settings, baseEl)\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport function addButton(this: IvNode, input: ButtonOptions): void {\r\n  const cmd = buttonCommands.addButton(input);\r\n  this.pushCommands(cmd);\r\n}\r\n\r\nexport const removeButtonFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'removeButton': (cmd: ICommand.RemoveButton) => {\r\n    buttonsController.removeButton(cmd.id)\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport const removeAllButtonsFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'removeAllButtons': (cmd: ICommand.RemoveAllButtons) => {\r\n    buttonsController.removeAllButtons();\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport function removeAllButtons(this: IvNode): void {\r\n  const cmd = buttonCommands.removeAllButtons();\r\n  this.pushCommands(cmd);\r\n}\r\n","import { PluginRegistration } from '../../../base-iv';\r\nimport { addButton, removeAllButtons, addButtonFactory, removeAllButtonsFactory, removeButtonFactory } from './button-commands';\r\n\r\nexport const buttonsPlugin: PluginRegistration = {\r\n  apiExtensions: [\r\n    {\r\n      apiName: 'addButton',\r\n      apiFn: addButton,\r\n    },\r\n    {\r\n      apiName: 'removeAllButtons',\r\n      apiFn: removeAllButtons,    \r\n    },\r\n  ],\r\n  targetFunctionFactories: [\r\n    addButtonFactory,\r\n    removeAllButtonsFactory,\r\n    removeButtonFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions {\r\n    addButton: typeof addButton;\r\n    removeAllButtons: typeof removeAllButtons;\r\n  }\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\ninterface CalculateBase {\r\n  var: string;\r\n  storeIn: string;\r\n}\r\n\r\ninterface CalculateAdd extends CalculateBase {\r\n  add: number;\r\n}\r\n\r\ninterface CalculateSubtract extends CalculateBase {\r\n  subtract: number;\r\n}\r\n\r\ninterface CalculateMultiply extends CalculateBase {\r\n  multiply: number;\r\n}\r\n\r\ninterface CalculateDivide extends CalculateBase {\r\n  divide: number;\r\n}\r\n\r\ntype CalculateOptions = Partial<\r\n  CalculateAdd\r\n  & CalculateSubtract\r\n  & CalculateMultiply\r\n  & CalculateDivide\r\n  >\r\n\r\n\r\nexport const calculateFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'calculate':\r\n      (cmd: ICommand.Calculate) =>\r\n        Promise.resolve(doCalculate(input, cmd))\r\n  }\r\n}\r\n\r\nexport function doCalculate(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.Calculate\r\n): Runner.CommandReturn {\r\n  const { variables } = given;\r\n  const { operation, varName, value, assignTo } = cmd;\r\n  const startingValue = variables[varName]\r\n  variables[assignTo] = \r\n    getOperation(operation)(startingValue, value)\r\n  return {};\r\n}\r\n\r\nconst operations = {\r\n  add: (val1, val2) => val1 + val2,\r\n  subtract: (val1, val2) => val1 - val2,\r\n  multiply: (val1, val2) => val1 * val2,\r\n  divide: (val1, val2) => val1 / val2,\r\n  divideThenRemainder: (val1, val2) => val1 % val2,\r\n  divideThenRoundDown: (val1, val2) => Math.floor(val1 / val2),\r\n  divideThenRoundUp: (val1, val2) => Math.ceil(val1 / val2),\r\n  divideThenRound: (val1, val2) => Math.round(val1 / val2),\r\n  round: (val1) => Math.round(val1),\r\n  roundUp: (val1) => Math.ceil(val1),\r\n  roundDown: (val1) => Math.floor(val1),\r\n}\r\n\r\nfunction getOperation(operator: string) {\r\n  const theOperation = operations[operator];\r\n  if (!theOperation) {\r\n    throw new Error(`There is no \"${operator}\" operator in the calculate command`);\r\n  }\r\n  return theOperation;\r\n}\r\n\r\nexport function calculate(this: IvNode, optionsObj: CalculateOptions): void {\r\n  let op: string = '';\r\n  let val: number = 0;\r\n  if (optionsObj.add) {\r\n    op = 'add';\r\n    val = optionsObj.add;\r\n  }\r\n  else if (optionsObj.subtract) {\r\n    op = 'subtract';\r\n    val = optionsObj.subtract;\r\n  }\r\n  else if (optionsObj.multiply) {\r\n    op = 'multiply';\r\n    val = optionsObj.multiply;\r\n  }\r\n  else if (optionsObj.divide) {\r\n    op = 'divide';\r\n    val = optionsObj.divide;\r\n  }\r\n  else {\r\n    const received = [];\r\n    for (const prop in optionsObj) {\r\n      if (optionsObj.hasOwnProperty(prop)) {\r\n        received.push(`\"${prop}\"`);\r\n      }\r\n    }\r\n    const message = `Unknown options passed into Calculate(). Was expecting \"var\", \"storeIn\" and then one of \"add\", \"subtract\", \"multiply\", or \"delete\". Received [${received.join(', ')}]`\r\n    throw new Error(message)\r\n  }\r\n\r\n  const command: ICommand.Calculate = {\r\n    name: 'calculate',\r\n    varName: optionsObj.var,\r\n    operation: op as ICommand.Calculate['operation'],\r\n    value: val,\r\n    assignTo: optionsObj.storeIn\r\n  };\r\n  this.pushCommands(command);\r\n}\r\n","import { PluginRegistration } from '../../../base-iv';\r\nimport { assignVariableFactory, assignFromVariableFactory, setVariable } from './set-variable';\r\nimport { calculate, calculateFactory } from '../variable-modification/calculate';\r\nimport { getRandomNumberApi, getRandomNumberFactory } from './get-random-number';\r\n\r\nexport const variableManipulationPlugin: PluginRegistration = {\r\n  apiExtensions: [{\r\n    apiName: 'setVariable',\r\n    apiFn: setVariable,\r\n  }, {\r\n    apiName: 'calculate',\r\n    apiFn: calculate,\r\n  }, {\r\n    apiName: 'getRandom',\r\n    apiFn: getRandomNumberApi,\r\n  }],\r\n  targetFunctionFactories: [\r\n    assignVariableFactory,\r\n    assignFromVariableFactory,\r\n    calculateFactory,\r\n    getRandomNumberFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions {\r\n    setVariable: typeof setVariable;\r\n    calculate: typeof calculate;\r\n    getRandom: typeof getRandomNumberApi;\r\n  }\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\ninterface BaseAssignVariable {\r\n  storeIn: string;\r\n}\r\n\r\ninterface AssignVariableWithVar extends BaseAssignVariable {\r\n  var: string;\r\n}\r\n\r\ninterface AssignVariableWithValue extends BaseAssignVariable  {\r\n  value: string | number | Array<string | number>;\r\n}\r\n\r\ntype AssignVariableOptions =  BaseAssignVariable & Partial<AssignVariableWithVar & AssignVariableWithValue>;\r\n\r\nexport const assignFromVariableFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'assignFromVariable': (cmd: ICommand.AssignFromVariable) => {\r\n      input.variables[cmd.assignTo] = input.variables[cmd.varName];\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport const assignVariableFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'assignVariable': (cmd: ICommand.AssignVariable) => {\r\n      input.variables[cmd.assignTo] = cmd.value;\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport function setVariable(this: IvNode, objSettings: AssignVariableOptions) : IvNode {\r\n  if (objSettings.var)\r\n  {\r\n    const command: ICommand.AssignFromVariable = { name:'assignFromVariable', varName : objSettings.var,  assignTo: objSettings.storeIn };\r\n    this.pushCommands(command);\r\n  }\r\n  else\r\n  {\r\n    if(objSettings.value)\r\n    {\r\n      const command: ICommand.AssignVariable = { name:'assignVariable', value: objSettings.value , assignTo: objSettings.storeIn };\r\n      this.pushCommands(command);\r\n    }\r\n\r\n  }\r\n  return this as any as IvNode;\r\n}\r\n","import { IvNode } from '../../../node';\r\nimport { getRandomInt } from '../../../utils';\r\n\r\ninterface RandomOptions {\r\n  min: number;\r\n  max: number;\r\n  storeIn: string;\r\n}\r\n\r\nexport const getRandomNumberFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'getRandomNumber':\r\n      (cmd: ICommand.GetRandomNumber) =>\r\n        Promise.resolve(getRandomNumber(input, cmd))\r\n  }\r\n}\r\n\r\nexport function getRandomNumber(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.GetRandomNumber\r\n): Runner.CommandReturn {\r\n\r\n  given.variables[cmd.assignTo] = getRandomInt(cmd.min, cmd.max);\r\n  return {};\r\n}\r\n\r\nexport function getRandomNumberApi(this: IvNode, objSettings: RandomOptions) : void {\r\n  const command: ICommand.GetRandomNumber = { name:'getRandomNumber', min: objSettings.min, max: objSettings.max, assignTo: objSettings.storeIn };\r\n  this.pushCommands(command);\r\n}\r\n","import { PluginRegistration } from '../../../base-iv';\r\nimport { executeAsync, executeAsyncFactory } from './execute-async';\r\nimport { executeSync, executeSyncFactory } from './execute-sync';\r\nimport { stopExecution, stopExecutionFactory, pauseExecutionFactory } from './execution-requests';\r\nimport { goto, goToNodeFactory } from './go-to-node';\r\nimport { wait, waitFactory } from './wait';\r\n\r\nexport const executionModifiersPlugin: PluginRegistration = {\r\n  apiExtensions: [{\r\n    apiName: 'return',\r\n    apiFn: stopExecution,\r\n  }, {\r\n    apiName: 'goSub',\r\n    apiFn: executeSync,\r\n  }, {\r\n    apiName: 'execute',\r\n    apiFn: executeAsync,\r\n  }, {\r\n    apiName: 'goto',\r\n    apiFn: goto,\r\n  }, {\r\n    apiName: 'wait',\r\n    apiFn: wait,\r\n  }],\r\n  targetFunctionFactories: [\r\n    stopExecutionFactory,\r\n    pauseExecutionFactory,\r\n    executeAsyncFactory,\r\n    executeSyncFactory,\r\n    goToNodeFactory,\r\n    waitFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions {\r\n    return: typeof stopExecution;\r\n    execute: typeof executeAsync;\r\n    goSub: typeof executeSync;\r\n    goto: typeof goto;\r\n    wait: typeof wait;\r\n  }\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const stopExecutionFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'stopExecution': (cmd: ICommand.StopExecution) => {\r\n      const returnObj: Runner.CommandReturn = {\r\n        requests: ['exit'],\r\n      };\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport const pauseExecutionFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'pauseExecution': (cmd: ICommand.PauseExecution) => {\r\n      const returnObj: Runner.CommandReturn = {\r\n        requests: ['pause'],\r\n      };\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport function stopExecution(this: IvNode) : void {\r\n  const commandStop: ICommand.StopExecution = {name:'stopExecution'};\r\n  this.pushCommands(commandStop);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const executeSyncFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'executeSync': (cmd: ICommand.ExecuteSync) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      return new Promise(async (resolve) => {\r\n        (await input.commandEngine.runNodeByName(cmd.nodeName)).once('done', () => resolve(returnObj))\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport function executeSync(this: IvNode, nodeName: string) : void {\r\n  const command: ICommand.ExecuteSync = {name:'executeSync', nodeName};\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const executeAsyncFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'executeAsync': (cmd: ICommand.ExecuteAsync) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      input.commandEngine.runNodeByName(cmd.nodeName)\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport function executeAsync(this: IvNode, nodeName: string) : void {\r\n  const command: ICommand.ExecuteAsync = {name:'executeAsync', nodeName};\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const goToNodeFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'goToNode': (cmd: ICommand.GoToNode) => {\r\n      input.commandEngine.runNodeByName(cmd.nodeName);\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport function goto(this: IvNode, nodeName: string) : void {\r\n  const commands = buildGoToNodeCommandSet(nodeName);\r\n  this.pushCommands(...commands);\r\n}\r\n\r\nfunction buildGoToNodeCommandSet(nodeName: string): [\r\n  ICommand.GoToNode,\r\n  ICommand.StopExecution\r\n] {\r\n  return [\r\n    { name: 'goToNode', nodeName },\r\n    { name: 'stopExecution' }\r\n  ];\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const waitFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'wait': (cmd: ICommand.Wait) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      \r\n      return new Promise(resolve => {\r\n        setTimeout(() => resolve(returnObj), cmd.time)\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport function wait(this: IvNode, time: number) : void {\r\n  const msTime = time * 1000;\r\n  const command: ICommand.Wait = { name:'wait', time: msTime };\r\n  this.pushCommands(command);\r\n}\r\n\r\n","import { PluginRegistration } from '../../base-iv';\r\nimport { IvNode } from '../../node';\r\n\r\nexport const logFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'log': (cmd: ICommand.Log) => {\r\n      if (cmd.value == null) {\r\n        console.log(input.variables);\r\n      } else {\r\n        console.log(cmd.value)\r\n      }\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nfunction log(this: IvNode, anything: any): void {\r\n  const command: ICommand.Log = {\r\n    name: 'log',\r\n    value: anything,\r\n  };\r\n  this.pushCommands(command);\r\n}\r\n\r\nexport const logRegistration: PluginRegistration = {\r\n  apiExtensions: [{\r\n    apiName: 'log',\r\n    apiFn: log,\r\n  }],\r\n  targetFunctionFactories: [logFactory],\r\n};\r\n\r\ndeclare module '../../node' {\r\n  interface NodeExtensions {\r\n    log: typeof log;\r\n  }\r\n}","import { PluginRegistration } from '../../base-iv';\r\nimport { IvNode } from '../../node';\r\n\r\nexport const executeJsFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'executeJs': async (cmd: ICommand.ExecuteJs) => {\r\n      await Promise.resolve(cmd.func());\r\n      return ({});\r\n    }\r\n  }\r\n}\r\n\r\ntype AnyArgsReturnVoid = (...args: any[]) => void\r\n\r\nexport const jsRegistration: PluginRegistration = {\r\n  apiExtensions: [{\r\n    apiName: 'js',\r\n    apiFn(this: IvNode, func: AnyArgsReturnVoid) {\r\n      this.pushCommands({name: 'executeJs', func});\r\n    },\r\n  }],\r\n  targetFunctionFactories: [executeJsFactory],\r\n}\r\n\r\ndeclare module '../../node' {\r\n  interface NodeExtensions {\r\n    js: AnyArgsReturnVoid\r\n  }\r\n}","import { BaseIV } from './base-iv';\r\nimport {\r\n  buttonsPlugin,\r\n  videoPlugin,\r\n  audioCommandsRegistration,\r\n} from './plugins/dom-commands';\r\nimport {\r\n  variableManipulationPlugin,\r\n  executionModifiersPlugin,\r\n} from './plugins/general-commands';\r\nimport { logRegistration } from './command-engine/log-commands';\r\nimport { jsRegistration } from './command-engine/unserializable-commands';\r\n\r\nexport const IV = BaseIV.extend(\r\n  jsRegistration,\r\n  videoPlugin,\r\n  audioCommandsRegistration,\r\n  buttonsPlugin,\r\n  logRegistration,\r\n  variableManipulationPlugin,\r\n  executionModifiersPlugin,\r\n)\r\n\r\nexport type IV = BaseIV;\r\n","import './styles/base.scss';\r\nexport * from './lib/iv';\r\n"],"sourceRoot":""}