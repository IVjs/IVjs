{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/happy-helpers/lib/main.js","webpack:///./node_modules/mobile-detector/index.js","webpack:///./node_modules/eventemitter3/index.js","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./src/lib/command-engine/command-engine.ts","webpack:///./src/lib/config.ts","webpack:///./src/test-support/dom-commands.ts","webpack:///./src/lib/utils.ts","webpack:///./src/lib/partial-liquid.ts","webpack:///./src/lib/command-engine/command-runner.ts","webpack:///./src/lib/command-engine/switch.ts","webpack:///./src/lib/command-engine/create-engine.ts","webpack:///./src/lib/node.ts","webpack:///./src/lib/base-iv.ts","webpack:///./src/lib/plugins/dom-commands/video/video-commands-builder.ts","webpack:///./src/lib/plugins/dom-commands/video/video-controller.ts","webpack:///./src/lib/plugins/dom-commands/video/play-video.ts","webpack:///./src/lib/plugins/dom-commands/video/clear-video.ts","webpack:///./src/lib/plugins/dom-commands/video/index.ts","webpack:///./src/lib/plugins/dom-commands/audio/audio-controller.ts","webpack:///./src/lib/plugins/dom-commands/audio/audio-commands.ts","webpack:///./src/lib/plugins/dom-commands/audio/index.ts","webpack:///./src/lib/plugins/dom-commands/buttons/button-commands-builder.ts","webpack:///./src/lib/plugins/dom-commands/buttons/buttons-controller.ts","webpack:///./src/lib/plugins/dom-commands/buttons/button-commands.ts","webpack:///./src/lib/plugins/dom-commands/index.ts","webpack:///./src/lib/plugins/dom-commands/buttons/index.ts","webpack:///./src/lib/plugins/general-commands/variable-modification/calculate.ts","webpack:///./src/lib/plugins/general-commands/variable-modification/get-random-number.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/execute-async.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/execute-sync.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/execution-requests.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/wait.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/index.ts","webpack:///./src/lib/plugins/general-commands/index.ts","webpack:///./src/lib/plugins/general-commands/variable-modification/index.ts","webpack:///./src/lib/plugins/general-commands/variable-modification/set-variable.ts","webpack:///./src/lib/plugins/general-commands/execution-modifiers/go-to-node.ts","webpack:///./src/lib/plugins/logging-commands/index.ts","webpack:///./src/lib/plugins/logging-commands/log.ts","webpack:///./src/lib/plugins/unserializable-plugins/index.ts","webpack:///./src/lib/plugins/unserializable-plugins/execute-js/execute-js.ts","webpack:///./src/lib/plugins/index.ts","webpack:///./src/lib/iv.ts","webpack:///./src/entry.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","toType","val","toString","match","toLowerCase","clone","obj","JSON","parse","stringify","isEmpty","type","indexOf","length","getOwnPropertyNames","isObject","x","traverseObject","callback","recursive","preserveOriginal","newObject","returnedObj","argsMinusFirst","Array","from","arguments","slice","recursedObject","apply","this","concat","keyValArray","isArray","Error","nestedPropertyDetails","propertyPath","pathParts","split","currentObject","exists","existingPath","newPart","shift","push","join","finalValidProperty","changePropsInitialCase","whichCase","makeAspVersion","newObj","regex","prop","originals","charAt","firstCharToUpper","firstCharToLower","str","toUpperCase","valuesArrayFromObject","keys","map","objectContainsValue","round","decimals","Number","Math","isNotEmpty","wrapObjectWithProperty","propName","wrapper","nestedPropertyTest","details","nestedPropertyExists","convertPropKeysForAsp","convertPropKeysForJs","objectKeyForValue","reduce","currentKey","forceArray","noCircularRefs","valCache","keyCache","isFirstRun","indexOfFoundValue","options","settings","assign","tabLength","stripQuotes","sort","finalStringification","newObj_1","forEach","replace","deepEqual","objA","objB","stringifyOptions","mediaWidth","max","document","documentElement","clientWidth","innerWidth","mediaHeight","clientHeight","innerHeight","nav","navigator","userAgent","vendor","opera","isMobile","check","test","substr","isMobileOrTablet","has","prefix","Events","EE","fn","context","once","addListener","emitter","event","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","events","names","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","len","removeListener","undefined","j","on","removeAllListeners","off","prefixed","extendStatics","b","setPrototypeOf","__extends","__","constructor","__assign","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","iterator","v","op","pop","IvCommandEngine","nodes","commandRunnerClass","variables","targetFunctions","runners","registerTargetFunction","input","commandEngine","run","createRunners","runNodeByName","runFirstNode","runCommands","commands","createCommandRunner","_this","node","getCommands","getRunnerForNode","defaults","baseElementId","buttonContainerClass","qsaToArray","qsa","index","outArray","getRandomInt","min","floor","random","nearClone","main","safeCloneObject","outgoing","sanitizeUrl","url","location","protocol","origin","partial_liquid_PartialLiquid","PartialLiquid","LIQUID_ONE","LIQUID_ALL","RegExp","implementedFilters","randomFilter","parts","getParts","whole","sendRawVar","replaceAsString","substring","filteredVariable","matches","varName","filter","variable","_a","doFilter","method","values","command_runner_CommandRunner","CommandRunner","eventemitter3","targets","runQueue","nextIndex","replacer","setStatus","getFunctionFor","canRun","doRun","enqueueRun","runNextCommand","willRun","status","resetIndex","advanceIndex","cmd","runCommand","cmdReturn","evaluateReturn","exit","theReturn","requests","asyncCommands","asyncSeries","runNewSeries","evaluateRequests","some","pause","nextEnqueuedRun","eventualCommands","catch","err","beginningMessage","message","console","error","res","runner","incomingCommand","replaceVariables","targetFunction","incoming","replaceVariableInString","switchFactory","switch","given","winningCommands","do","condition","operator","singleDo","operatorFunctions","unusedProps","unusedProp","determineOperator","operand","opFunc","checkCondition","winningCommandsOrNull","defaultCommands","doSwitch","is","isGreaterThan","isLessThan","isGreaterThanOrEqualTo","isLessThanOrEqualTo","isBetween","arr","lowest","highest","createBaseEngine","engineConstructorInput","functionFactories","_i","engine","Node","pushType","pusher","command","switchDo","pushCommands","if","optionsObj","var","else","endIf","base_iv_BaseIV","BaseIV","initialState","defaultSettings","baseContainer","getElementById","baseVideoUrl","bgAudioUrl","bgAudioLoop","nodeKlassReference","additionalFactories","defineNode","validateDom","extend","registrations","newNodeKlass","_super","class_1","nodeKlass","targetFunctionFactories","plugin","apiExtension","fnName","pr","isTargetFnRegistration","aliases","isAliasRegistration","alias","target","aliasAs","class_2","newNode","runOnAnyPlatform","getEngine","createRunButton","btn","createKickoffButton","runViaButton","getSettings","getSetting","mobile_detector","startBtn","createElement","id","innerHTML","appendChild","handleClick","removeEventListener","prepVideosForMobile","remove","addEventListener","querySelectorAll","vid","play","video_commands_builder_VideoCommandsBuilder","VideoCommandsBuilder","playVideo","handleDepricatedArrayInput","handleArrayInput","clearVideo","time","array","warn","objOrStr","guaranteedOptionsObject","mergeMissingUrlsReducer","vo","createPlayCommandFromOptions","reduceRight","reduceOnCompleteIntoPrevious","current","lastObj","onComplete","singleInput","remappedProps","file","commandProps","commandOptionsToCommands","inputObj","addCommands","runAsync","nodeName","js","func","runSync","goToNode","createVideoPlayer","player","setAttribute","style","display","videoController","VideoController","container","baseElement","playerContainer","className","players","standby","getStandbyPlayer","getCurrentPlayer","onloadeddata","src","load","whenPlayerEnds","onEnded","createPlayers","attachPlayers","videoCommandBuilder","clear_video_videoCommandBuilder","videoPlugin","baseEl","videoToPlay","onPlayerEnd","returnObj","completing","rej","url1","url2","createAudioPlayer","audioController","AudioController","_fadeInterval","bg","sfx","playerName","getPlayerNamed","whenPlayerLoads","loop","volume","fadeOverTime","desiredVolume","startTime","Date","now","startVolume","totalAdjustment","currentPercent","traveled","setTimeout","getBgPlayer","getSfxPlayer","audioPlugin","bgAudio","action","bgAudioCommand","setVolume","audioVolume","audioSource","ButtonCommandsBuilder","addButton","text","onClick","createCommands","removeAllButtons","buttonsController","ButtonsController","allButtons","createButton","element","button","newButton","addToButtonStore","appendToDocument","removeButton","applySettingsToButton","attrs","onclick","parentEl","getContainer","parent","foundContainer","selector","oldClass","getAttribute","parentNode","directDescendants","newContainer","buttonCommands","dom_commands","operations","add","val1","val2","subtract","multiply","divide","remainderAfterDivideBy","roundDownAfterDivideBy","roundUpAfterDivideBy","ceil","roundAfterDivideBy","roundUp","roundDown","stopExecution","deprecate","oldName","newName","general_commands","calculate","failures","availableOperations","passedProps","chosenOperations","unknownProps","passed","unknownPropsList","keyValueStrings","theValue","availableOperationsList","opName","testUserInput","operation","assignTo","storeIn","setVariable","objSettings","getRandom","assignVariable","assignFromVariable","tempValue","parseFloat","isNaN","startingValue","theOperation","getOperation","doCalculate","getRandomNumber","goSub","execute","endAllNodes","buildGoToNodeCommandSet","wait","pauseExecution","executeAsync","executeSync","logging_commands","log","anything","unserializable_plugins","executeJs","lib_plugins","IV","__webpack_exports__"],"mappings":"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","file":"iv.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// see https://javascriptweblog.wordpress.com/2011/08/08/fixing-the-javascript-typeof-operator/\r\n// via http://stackoverflow.com/a/7390612/1386201\r\n/*\r\n    toType({a: 4}); //\"object\"\r\n    toType([1, 2, 3]); //\"array\"\r\n    (function() {console.log(toType(arguments))})(); //\"arguments\"\r\n    toType(new ReferenceError); //\"error\"\r\n    toType(new Date); //\"date\"\r\n    toType(/a-z/); //\"regexp\"\r\n    toType(Math); //\"math\"\r\n    toType(JSON); //\"json\"\r\n    toType(new Number(4)); //\"number\"\r\n    toType(new String(\"abc\")); //\"string\"\r\n    toType(new Boolean(true)); //\"boolean\"\r\n    toType(null); //\"null\"\r\n    toType(); //\"undefined\"\r\n    toType( () => {} ); //\"function\"\r\n*/\r\nfunction toType(val) {\r\n    return ({}).toString.call(val).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\r\n}\r\nexports.toType = toType;\r\nfunction round(value, decimals) {\r\n    if (decimals === void 0) { decimals = 2; }\r\n    return Number(Math.round(Number(value + 'e' + decimals)) + 'e-' + decimals);\r\n}\r\nexports.round = round;\r\nfunction clone(obj) {\r\n    return JSON.parse(JSON.stringify(obj));\r\n}\r\nexports.clone = clone;\r\nfunction isEmpty(val) {\r\n    var emptyTypes = ['null', 'undefined'];\r\n    var checkableTypes = ['object', 'array', 'arguments', 'json', 'string'];\r\n    var type = toType(val);\r\n    if (emptyTypes.indexOf(type) > -1) {\r\n        return true;\r\n    }\r\n    if (checkableTypes.indexOf(type) > -1) {\r\n        if (type === 'string')\r\n            return val.length === 0; // IE fails on the next line if a string.\r\n        if (Object.getOwnPropertyNames(val).length === 0)\r\n            return true;\r\n        return val.length === 0;\r\n    }\r\n    // other types return false because they are, by nature, filled ()\r\n    return false;\r\n}\r\nexports.isEmpty = isEmpty;\r\nfunction isNotEmpty(val) {\r\n    return !isEmpty(val);\r\n}\r\nexports.isNotEmpty = isNotEmpty;\r\nfunction wrapObjectWithProperty(obj, propName, preserveOriginal) {\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var wrapper = {};\r\n    var newObj = preserveOriginal ? clone(obj) : obj;\r\n    wrapper[propName] = newObj;\r\n    return wrapper;\r\n}\r\nexports.wrapObjectWithProperty = wrapObjectWithProperty;\r\nfunction isObject(x) {\r\n    return (toType(x) === 'object');\r\n}\r\nexports.isObject = isObject;\r\n// Traverses an object.\r\n// callback should return an array with a key, then a value if constructing a\r\n// new object is desired. Kind of like Array.map, but for objects\r\nfunction traverseObject(obj, callback, recursive, preserveOriginal) {\r\n    if (recursive === void 0) { recursive = false; }\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var newObject = preserveOriginal ? clone(obj) : obj;\r\n    var returnedObj = {};\r\n    for (var key in newObject) {\r\n        if (newObject.hasOwnProperty(key) === false)\r\n            continue;\r\n        if (isObject(newObject[key]) && recursive) {\r\n            var args = Array.from(arguments);\r\n            var argsMinusFirst = args.slice().slice(1);\r\n            var recursedObject = traverseObject.apply(this, [newObject[key]].concat(argsMinusFirst));\r\n            if (!isEmpty(recursedObject)) {\r\n                newObject[key] = recursedObject;\r\n            }\r\n        }\r\n        var keyValArray = callback(key, newObject[key]);\r\n        if (Array.isArray(keyValArray) && keyValArray.length === 2) {\r\n            returnedObj[keyValArray[0]] = keyValArray[1];\r\n        }\r\n        else if (!isEmpty(keyValArray)) {\r\n            throw new Error(\"It looks like you might have been trying to construct a new object, but you returned something other than an array that looks like [key, value]. You returned \" + keyValArray);\r\n        }\r\n    }\r\n    return returnedObj;\r\n}\r\nexports.traverseObject = traverseObject;\r\nfunction nestedPropertyDetails(obj, propertyPath) {\r\n    var pathParts = propertyPath.split('.');\r\n    var currentObject = obj;\r\n    var exists = true;\r\n    var existingPath = [];\r\n    while (exists && pathParts.length > 0) {\r\n        var newPart = pathParts.shift();\r\n        if (newPart && currentObject[newPart]) {\r\n            existingPath.push(newPart);\r\n            currentObject = currentObject[newPart];\r\n        }\r\n        else {\r\n            exists = false;\r\n        }\r\n    }\r\n    return {\r\n        exists: exists,\r\n        existingPath: existingPath.join('.'),\r\n        finalValidProperty: currentObject,\r\n    };\r\n}\r\nexports.nestedPropertyDetails = nestedPropertyDetails;\r\nfunction nestedPropertyTest(obj, propertyPath, callback) {\r\n    var details = nestedPropertyDetails(obj, propertyPath);\r\n    if (details.exists) {\r\n        return !!callback(details.finalValidProperty);\r\n    }\r\n    return false;\r\n}\r\nexports.nestedPropertyTest = nestedPropertyTest;\r\nfunction nestedPropertyExists(obj, propertyPath) {\r\n    return nestedPropertyDetails(obj, propertyPath).exists;\r\n}\r\nexports.nestedPropertyExists = nestedPropertyExists;\r\nfunction changePropsInitialCase(obj, whichCase, recursive, preserveOriginal) {\r\n    if (recursive === void 0) { recursive = false; }\r\n    if (preserveOriginal === void 0) { preserveOriginal = true; }\r\n    var makeAspVersion = (whichCase === 'UpperFirst') ? true : false;\r\n    var newObj = preserveOriginal ? clone(obj) : obj;\r\n    var regex = makeAspVersion ? /[a-z]/ : /[A-z]/;\r\n    return traverseObject(newObj, function (key, prop) {\r\n        var originals = [key, prop];\r\n        if (typeof key !== 'string')\r\n            return originals;\r\n        if (key.charAt(0).match(regex) === null)\r\n            return originals;\r\n        var newKey = makeAspVersion ? firstCharToUpper(key) : firstCharToLower(key);\r\n        return [newKey, prop];\r\n    }, recursive);\r\n}\r\nexports.changePropsInitialCase = changePropsInitialCase;\r\nfunction firstCharToUpper(str) {\r\n    return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\nexports.firstCharToUpper = firstCharToUpper;\r\nfunction firstCharToLower(str) {\r\n    return str.charAt(0).toLowerCase() + str.slice(1);\r\n}\r\nexports.firstCharToLower = firstCharToLower;\r\nfunction convertPropKeysForAsp(obj) {\r\n    return changePropsInitialCase(obj, 'UpperFirst', true);\r\n}\r\nexports.convertPropKeysForAsp = convertPropKeysForAsp;\r\nfunction convertPropKeysForJs(obj) {\r\n    return changePropsInitialCase(obj, 'lowerFirst', true);\r\n}\r\nexports.convertPropKeysForJs = convertPropKeysForJs;\r\nfunction valuesArrayFromObject(obj) {\r\n    if (!isObject(obj)) {\r\n        throw new Error(\"'obj' was not an object. Was \" + toType(obj));\r\n    }\r\n    return Object.keys(obj).map(function (key) { return obj[key]; });\r\n}\r\nexports.valuesArrayFromObject = valuesArrayFromObject;\r\nfunction objectContainsValue(val, obj) {\r\n    return valuesArrayFromObject(obj).indexOf(val) !== -1;\r\n}\r\nexports.objectContainsValue = objectContainsValue;\r\nfunction objectKeyForValue(val, obj) {\r\n    if (!objectContainsValue(val, obj))\r\n        return false;\r\n    return Object.keys(obj).reduce(function (a, currentKey) {\r\n        if (obj[currentKey] === val) {\r\n            a = currentKey;\r\n        }\r\n        return a;\r\n    }, '');\r\n}\r\nexports.objectKeyForValue = objectKeyForValue;\r\nfunction forceArray(val) {\r\n    var emptyReturns = ['null', 'undefined'];\r\n    if (emptyReturns.indexOf(toType(val)) !== -1)\r\n        return [];\r\n    if (toType(val) !== 'array') {\r\n        return [val];\r\n    }\r\n    return val;\r\n}\r\nexports.forceArray = forceArray;\r\nvar noCircularRefs = function () {\r\n    var valCache = [];\r\n    var keyCache = [];\r\n    var isFirstRun = true;\r\n    return function (key, value) {\r\n        if (typeof value === 'object' && value !== null) {\r\n            if (isFirstRun) {\r\n                key = '__BASE_OBJECT__'; // eslint-disable-line no-param-reassign\r\n                isFirstRun = false;\r\n            }\r\n            var indexOfFoundValue = valCache.indexOf(value);\r\n            if (indexOfFoundValue !== -1) {\r\n                // Circular reference found, discard key\r\n                return \"[circular reference of \" + keyCache[indexOfFoundValue] + \"]\";\r\n            }\r\n            // Store value in our collection\r\n            valCache.push(value);\r\n            keyCache.push(key);\r\n        }\r\n        return value; // eslint-disable-line consistent-return\r\n    };\r\n};\r\nfunction stringify(obj, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var defaults = {\r\n        tabLength: 2,\r\n        stripQuotes: false,\r\n        sort: false,\r\n    };\r\n    var settings = Object.assign({}, defaults, options);\r\n    var tabLength = settings.tabLength, stripQuotes = settings.stripQuotes, sort = settings.sort;\r\n    if (sort) {\r\n        if (toType(obj) === 'array') {\r\n            var newObj = obj.sort();\r\n            return finalStringification(newObj, tabLength, stripQuotes);\r\n        }\r\n        else if (toType(obj) === 'object') {\r\n            var newObj_1 = {};\r\n            var keys = Object.keys(obj).sort();\r\n            keys.forEach(function (key) {\r\n                newObj_1[key] = obj[key];\r\n            });\r\n            return finalStringification(newObj_1, tabLength, stripQuotes);\r\n        }\r\n        return finalStringification(obj, tabLength, stripQuotes);\r\n    }\r\n    return finalStringification(obj, tabLength, stripQuotes);\r\n}\r\nexports.stringify = stringify;\r\nfunction finalStringification(obj, tabLength, stripQuotes) {\r\n    var str = JSON.stringify(obj, noCircularRefs(), tabLength);\r\n    if (stripQuotes) {\r\n        str = str.replace(/\"(.*?)\": /g, '$1: ');\r\n    }\r\n    return str;\r\n}\r\n/**\r\n * Returns true if the deep values of an object are equal.\r\n */\r\nfunction deepEqual(objA, objB) {\r\n    var stringifyOptions = { sort: true };\r\n    return stringify(objA, stringifyOptions) === stringify(objB, stringifyOptions);\r\n}\r\nexports.deepEqual = deepEqual;\r\n/*\r\n  The following are not tested with `npm test` and are unreliable for certain situations.\r\n  see http://stackoverflow.com/a/8876069\r\n*/\r\nfunction mediaWidth() {\r\n    return Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\r\n}\r\nexports.mediaWidth = mediaWidth;\r\nfunction mediaHeight() {\r\n    return Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\r\n}\r\nexports.mediaHeight = mediaHeight;\r\n//# sourceMappingURL=main.js.map","module.exports = (function (nav) {\n    isMobile = function () {\n        var check = false;\n        if (\n            /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(nav) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(nav.substr(0, 4))\n        ) check = true;\n        return check;\n    };\n\n    isMobileOrTablet = function () {\n        var check = false;\n        if (\n            /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(nav) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(nav.substr(0, 4))\n        ) check = true;\n        return check;\n    };\n\n    return {\n        isMobile: isMobile,\n        isMobileOrTablet: isMobileOrTablet\n    }\n\n}(navigator.userAgent || navigator.vendor || window.opera));","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export class IvCommandEngine implements CommandEngine.Class {\r\n  private targetFunctions: Runner.TargetFunctionObject = {};\r\n  private runners: {[x: string]: Runner.Class} = {};\r\n\r\n  constructor(\r\n    private settings: CommandEngine.ctor['settings'],\r\n    private nodes: CommandEngine.ctor['nodes'],\r\n    private commandRunnerClass: CommandEngine.ctor['commandRunnerClass'],\r\n    private variables: CommandEngine.ctor['variables'],\r\n  ) { }\r\n\r\n  public registerTargetFunction(factory: CommandEngine.TargetFunctionFactory) {\r\n    const input = { settings: this.settings , variables: this.variables , commandEngine: this };\r\n    Object.assign(this.targetFunctions, factory(input));\r\n  }\r\n\r\n  public run(name?: string) {\r\n    this.createRunners();\r\n    if (name) {\r\n      this.runNodeByName(name);\r\n    } else {\r\n      this.runFirstNode();\r\n    }\r\n  }\r\n\r\n  public runCommands(commands: ICommand.AnyCommand[]) {\r\n    return this.createCommandRunner(commands).run();\r\n  }\r\n\r\n  private createRunners() {\r\n    const targetFunctions = this.targetFunctions;\r\n    this.nodes.forEach(node => {\r\n      const commands = node.getCommands();\r\n      this.runners[node.name] = this.createCommandRunner(commands);\r\n    })\r\n  }\r\n\r\n  private createCommandRunner(commands: ICommand.AnyCommand[]): Runner.Class {\r\n    return new this.commandRunnerClass({\r\n      variables: this.variables,\r\n      targetFunctions: this.targetFunctions,\r\n      commands\r\n    })\r\n  }\r\n\r\n  private runFirstNode() {\r\n    if (this.nodes[0]) {\r\n      this.getRunnerForNode(this.nodes[0].name).run();\r\n    }\r\n  }\r\n\r\n  public runNodeByName(name: string): Promise<Runner.Class> {\r\n    return this.getRunnerForNode(name).run();\r\n  }\r\n\r\n  private getRunnerForNode(name: string) {\r\n    return this.runners[name];\r\n  }\r\n}\r\n","export const defaults = {\r\n  baseElementId: 'IV-view',\r\n  buttonContainerClass: 'IV-button-container',\r\n}\r\n","import { defaults } from '../lib/config'\r\n\r\nexport function qsaToArray(qsa: NodeListOf<HTMLElement>): HTMLElement[] {\r\n  let index = 0;\r\n  const outArray: HTMLElement[] = []\r\n  for (index = 0; index < qsa.length; index++) {\r\n    outArray.push(qsa[index])\r\n  }\r\n  return outArray;\r\n}\r\n\r\nexport function querySelectorAll(selector: string) {\r\n  return qsaToArray(document.querySelectorAll(selector));\r\n}\r\n\r\nexport function getAllVideos(): HTMLVideoElement[] {\r\n  return qsaToArray(document.querySelectorAll(`#${defaults.baseElementId} video`)) as HTMLVideoElement[];\r\n}\r\n\r\nexport function getCurrentVideo() {\r\n  return document.getElementById('IV-video-player-1') as HTMLVideoElement;\r\n}\r\n\r\nexport function getNextVideo() {\r\n  return document.getElementById('IV-video-player-2') as HTMLVideoElement;\r\n}\r\n\r\nexport function getAllAudioPlayers(): HTMLAudioElement[] {\r\n  return qsaToArray(document.querySelectorAll(`#${defaults.baseElementId} audio`)) as HTMLAudioElement[];\r\n}\r\n\r\nexport function getAudioPlayerNamed(name: string) {\r\n  return document.getElementById(`IV-audio-player-${name.toLowerCase()}`) as HTMLAudioElement;\r\n}\r\n\r\nexport function getBgAudioPlayer() {\r\n  return getAudioPlayerNamed('BG');\r\n}\r\n\r\nexport function getSfxAudioPlayer() {\r\n  return getAudioPlayerNamed('SFX');\r\n}\r\n","import { toType, traverseObject } from 'happy-helpers';\r\nimport { qsaToArray } from '../test-support/dom-commands';\r\nexport { qsaToArray }\r\n\r\nexport function getRandomInt(min: number, max: number): number {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nexport function wait(time?: number) {\r\n  return new Promise(res => {\r\n    setTimeout(res, time);\r\n  })\r\n}\r\n\r\nfunction safeCloneObject<T extends object>(obj: T): T {\r\n  const outgoing = {};\r\n  traverseObject(obj, (prop, value) => {\r\n    if (toType(value) === 'array') {\r\n      outgoing[prop] = nearClone(value);\r\n    } else if (toType(value) === 'object') {\r\n      outgoing[prop] = safeCloneObject(value);\r\n    } else {\r\n      outgoing[prop] = value;\r\n    }\r\n  }, false, false);\r\n  return outgoing as T;\r\n}\r\n\r\nexport function nearClone<T extends any>(obj: T): T {\r\n  const type = toType(obj);\r\n\r\n  if (isObject(obj)) {\r\n    return safeCloneObject(obj);\r\n  } else if (type === 'array') {\r\n    return obj.map(x => nearClone(x))\r\n  } else {\r\n    return obj;\r\n  }\r\n}\r\n\r\nfunction isObject(obj: any): obj is object {\r\n  return toType(obj) === 'object';\r\n}\r\n\r\nexport function directDescendants(element: HTMLElement, selector): HTMLElement[] | [null] {\r\n  const oldClass = element.getAttribute('class');\r\n  element.setAttribute('class', oldClass + \" IV-searching\");\r\n  const qsa: NodeListOf<HTMLElement> = (element.parentNode as HTMLElement).querySelectorAll('.IV-searching > ' + selector);\r\n  element.setAttribute('class', oldClass);\r\n  return qsaToArray(qsa);\r\n}\r\n\r\nexport function urlsMatch(url1: string, url2: string): boolean {\r\n  return sanitizeUrl(url1) === sanitizeUrl(url2);\r\n}\r\n\r\nexport function sanitizeUrl(url: string): string {\r\n  if (url.substr(0, 2) === '//') {\r\n    return `${document.location.protocol}${url}`;\r\n  }\r\n  if (url[0] === '/') {\r\n    return `${document.location.origin}${url}`;\r\n  }\r\n  if (url.indexOf('/') === -1) {\r\n    return `${document.location.origin}/${url}`;    \r\n  }\r\n  return url;\r\n}","// Liquid markup (https://shopify.github.io/liquid/) inspired\r\nimport { toType } from 'happy-helpers';\r\nimport { getRandomInt } from './utils';\r\n\r\nexport class PartialLiquid {\r\n  private LIQUID_ONE = /\\{\\{(.*?)( ?\\| ?(.*)?)?\\}\\}/\r\n  private LIQUID_ALL = new RegExp(this.LIQUID_ONE, 'g');\r\n\r\n  public implementedFilters = {\r\n    'random': this.randomFilter.bind(this)\r\n  }\r\n\r\n  constructor(private variables: IV.Variables) { }\r\n\r\n  public replace(str: string): any {\r\n    const parts = this.getParts(str);\r\n    if (!parts) { return str; }\r\n    if (parts.whole === str) {\r\n      return this.sendRawVar(str);\r\n    } else {\r\n      return this.replaceAsString(str);\r\n    }\r\n  }\r\n\r\n  private replaceAsString(str): string {\r\n    return str.replace(this.LIQUID_ALL, (substring: string) => {\r\n      return this.filteredVariable(substring).toString();\r\n    });\r\n  }\r\n\r\n  private getParts(str: string): {whole: string, varName: string, filter: string} | null {\r\n    const matches = str.match(this.LIQUID_ONE);\r\n    if (!matches) { return null; }\r\n    const [whole, varName, pipePhrase, filter] = matches;\r\n    return { whole, varName, filter };\r\n  }\r\n\r\n  private sendRawVar(str: string): any {\r\n    let variable;\r\n    str.replace(this.LIQUID_ALL, (substring) => {\r\n      variable = this.filteredVariable(substring)\r\n      return substring;\r\n    });\r\n    return variable;\r\n  }\r\n\r\n  private filteredVariable(substring: string): any {\r\n    const { whole, varName, filter } = this.getParts(substring);\r\n    if (filter) {\r\n      return this.doFilter(varName, filter);\r\n    } else {\r\n      return this.variables[varName];\r\n    }\r\n  }\r\n\r\n  private doFilter(varName: string, filter: string) {\r\n    const method = this.implementedFilters[filter];\r\n    if (!method) {\r\n      throw new Error(`There is no filter called \"${filter}\"`)\r\n    }\r\n    return method(varName)\r\n  }\r\n\r\n  private randomFilter(varName: string): any {\r\n    const values = this.variables[varName] as any[];\r\n    if (toType(values) !== 'array') {\r\n      throw new Error('You cannot use the random filter on a non-array');\r\n    }\r\n\r\n    const randomIndex = getRandomInt(0, values.length - 1);\r\n    return values[randomIndex];\r\n  }\r\n}","import { EventEmitter } from 'eventemitter3';\r\nimport { toType, traverseObject } from 'happy-helpers';\r\nimport { PartialLiquid } from '../../lib/partial-liquid';\r\nimport { nearClone } from '../utils';\r\n\r\nexport class CommandRunner implements Runner.Class {\r\n  public status: Runner.Status;\r\n\r\n  private events = new EventEmitter();\r\n  private targets: Runner.ConstructorInput['targetFunctions'] = {};\r\n  private commands: Runner.ConstructorInput['commands'];\r\n  private variables: Runner.ConstructorInput['variables']\r\n  private replacer: PartialLiquid;\r\n  private runQueue: Array<() => void> = [];\r\n\r\n  private getFunctionFor(name: string) {\r\n    if (!this.targets[name]) {\r\n      throw new Error(`There is no registered function to execute the \"${name}\" command.`);\r\n    }\r\n    return this.targets[name];\r\n  }\r\n\r\n  private nextIndex = 0;\r\n\r\n  constructor({commands, targetFunctions, variables}: Runner.ConstructorInput) {\r\n    this.commands = commands;\r\n    this.targets = targetFunctions;\r\n    this.variables = variables;\r\n    this.replacer = new PartialLiquid(this.variables);\r\n    this.setStatus('ready');\r\n  }\r\n\r\n  public run(): Promise<this> {\r\n    if (this.canRun()) {\r\n      return this.doRun();\r\n    } else {\r\n      return this.enqueueRun();\r\n    }\r\n  }\r\n\r\n  public on(event, listener) {\r\n    this.events.on(event, listener);\r\n  }\r\n\r\n  public once(event, listener) {\r\n    this.events.once(event, listener);\r\n  }\r\n\r\n  private doRun(): Promise<this> {\r\n    this.setStatus('running');\r\n    this.runNextCommand();\r\n    return Promise.resolve(this);\r\n  }\r\n\r\n  private enqueueRun(): Promise<this> {\r\n    let doRun: () => void;\r\n    const willRun: Promise<this> = new Promise(resolve => {\r\n      doRun = () => {\r\n        resolve(this.doRun())\r\n      }\r\n    })\r\n    this.runQueue.push(doRun)\r\n    return willRun;\r\n  }\r\n\r\n  private canRun(): boolean {\r\n    return this.status !== 'running' && this.status !== 'waiting'\r\n  }\r\n\r\n  private setStatus(status: Runner.Status) {\r\n    this.events.emit(status);\r\n    this.status = status;\r\n  }\r\n\r\n  private resetIndex() {\r\n    this.nextIndex = 0;\r\n  }\r\n\r\n  private advanceIndex() {\r\n    this.nextIndex++;\r\n  }\r\n\r\n  private runNextCommand() {\r\n    if (this.status !== 'running') { return; }\r\n\r\n    const cmd = this.commands[this.nextIndex]\r\n    if (cmd) {\r\n      this.advanceIndex()\r\n      this.runCommand(cmd)\r\n        .then(cmdReturn => this.evaluateReturn(cmdReturn))\r\n        .then(() => this.runNextCommand())\r\n    } else {\r\n      this.exit();\r\n    }\r\n  }\r\n\r\n  private async evaluateReturn(theReturn: Runner.CommandReturn) {\r\n    const {commands, requests, asyncCommands} = theReturn;\r\n    if (asyncCommands) { this.asyncSeries(asyncCommands); }\r\n    if (commands) { await this.runNewSeries(commands); }\r\n    await this.evaluateRequests(requests);\r\n  }\r\n\r\n  private async evaluateRequests(requests: Runner.CommandReturn['requests']) {\r\n    if (!requests) { return; }\r\n    if (requests.some(r => r === 'exit')) { return this.exit(); }\r\n    if (requests.some(r => r === 'pause')) { return this.pause(); }\r\n    return;\r\n  }\r\n\r\n  private exit() {\r\n    this.resetIndex();\r\n    const nextEnqueuedRun = this.runQueue.shift();\r\n    if (nextEnqueuedRun) {\r\n      nextEnqueuedRun();\r\n    } else {\r\n      this.setStatus('done');\r\n    }\r\n  }\r\n\r\n  private pause() {\r\n    this.setStatus('paused');\r\n  }\r\n\r\n  private asyncSeries(eventualCommands: Promise<Runner.Command[]>) {\r\n    eventualCommands.then(commands => {\r\n      this.runNewSeries(commands)\r\n      .catch((err: Error) => {\r\n        const beginningMessage = err.message.slice(0,10) + '...'\r\n        console.error(`the error thrown above (beginning \"${beginningMessage}\") was in an async branch`);\r\n      })\r\n    })\r\n    .catch(err => {\r\n      if (err === 'cancelled') { return; }\r\n      console.error('An error occurred inside a promise for an asyncCommands object. This occurred before the commands were invoked on a runner:');\r\n      console.error(err);\r\n    })\r\n  }\r\n\r\n  private runNewSeries(commands: Runner.Command[]) {\r\n    return new Promise(res => {\r\n      const runner = new CommandRunner({\r\n        targetFunctions: this.targets,\r\n        commands,\r\n        variables: this.variables\r\n      });\r\n      runner.once('done', res);\r\n      runner.run();\r\n    }).catch(err => {\r\n      console.error('a child runner threw an error:')\r\n      console.error(err)\r\n      throw err;\r\n    })\r\n  }\r\n\r\n  private runCommand(incomingCommand: Runner.Command) {\r\n    const cmd = this.replaceVariables(incomingCommand);\r\n    const targetFunction = this.getFunctionFor(cmd.name);\r\n    return targetFunction(cmd);\r\n  }\r\n\r\n  private replaceVariables(incoming: Runner.Command): Runner.Command {\r\n    let outgoing = nearClone(incoming);\r\n\r\n    outgoing = traverseObject(outgoing, (prop, value) => {\r\n      if (toType(value) === 'string') {\r\n        value = this.replaceVariableInString(value);\r\n      }\r\n      return [prop, value];\r\n    }, true, false);\r\n\r\n    return outgoing;\r\n  }\r\n\r\n\r\n  private replaceVariableInString(str: string): string {\r\n    return this.replacer.replace(str);\r\n  }\r\n}\r\n","export const switchFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'switch':\r\n      (cmd: ICommand.Switch) =>\r\n        Promise.resolve(doSwitch(input, cmd))\r\n  }\r\n}\r\n\r\nexport function doSwitch(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.Switch\r\n): Runner.CommandReturn {\r\n  const { variables } = given;\r\n  let winningCommands;\r\n  cmd.do.forEach(condition => {\r\n    if (winningCommands) { return; }\r\n    winningCommands = winningCommandsOrNull(condition, variables)\r\n  })\r\n  const commands = winningCommands || cmd.defaultCommands\r\n  return {commands};\r\n}\r\n\r\nfunction winningCommandsOrNull(\r\n  condition: SwitchDo.Any,\r\n  variables: CommandEngine.TargetFunctionFactoryInput['variables'],\r\n): SwitchDo.Base['commands'] | null {\r\n  const operator = determineOperator(condition);\r\n  const variable = variables[condition.varName];\r\n  const operand = condition[operator]\r\n  if (checkCondition(operator, variable, operand)) {\r\n    return condition.commands;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction lowest(arr: number[]) {\r\n  return Math.min(...arr)\r\n}\r\n\r\nfunction highest(arr: number[]) {\r\n  return Math.max(...arr)\r\n}\r\n\r\nconst operatorFunctions = {\r\n  is: (variable, operand) => variable === operand,\r\n  isGreaterThan: (variable, operand) => variable > operand,\r\n  isLessThan: (variable, operand) => variable < operand,\r\n  isGreaterThanOrEqualTo: (variable, operand) => variable >= operand,\r\n  isLessThanOrEqualTo: (variable, operand) => variable <= operand,\r\n  isBetween: (variable, arr) => (lowest(arr) <= variable) && (variable <= highest(arr))\r\n}\r\n\r\nfunction determineOperator(singleDo: SwitchDo.Any): string {\r\n  for (const prop in singleDo) {\r\n    if (operatorFunctions.hasOwnProperty(prop)) {\r\n      return prop;\r\n    }\r\n  }\r\n\r\n  const unusedProps = [];\r\n  for (const unusedProp in singleDo) {\r\n    if (singleDo.hasOwnProperty(unusedProp)) {\r\n      unusedProps.push(unusedProp);\r\n    }\r\n  }\r\n  throw new Error(`could not find a valid operator in switch.do. Given these possibilities: ${unusedProps.join(', ')}`)\r\n}\r\n\r\nfunction checkCondition(operator, variable, operand): boolean {\r\n  const opFunc = operatorFunctions[operator];\r\n  return opFunc(variable, operand);\r\n}\r\n","import { IvCommandEngine } from './command-engine';\r\nimport { CommandRunner } from './command-runner';\r\nimport { switchFactory } from './switch';\r\nimport { Omit } from '../../types';\r\n\r\nexport function createEngine(engineConstructorInput: CommandEngine.ctor, ...functionFactories) {\r\n  const { settings, nodes, variables, commandRunnerClass } = engineConstructorInput;\r\n  const engine = new IvCommandEngine(settings, nodes, commandRunnerClass, variables);\r\n  \r\n  functionFactories.forEach(factory => {\r\n    engine.registerTargetFunction(factory);\r\n  })\r\n\r\n  return engine;\r\n}\r\n\r\nexport function createBaseEngine(engineConstructorInput: Omit<CommandEngine.ctor, 'commandRunnerClass'>, ...functionFactories) {\r\n  const { settings, nodes, variables } = engineConstructorInput;\r\n  const engine = createEngine({settings, nodes, variables, commandRunnerClass: CommandRunner}, ...functionFactories);\r\n  \r\n  engine.registerTargetFunction(switchFactory) // This powers the if statements that are necessary for base-node\r\n  \r\n  return engine;\r\n}\r\n","import {Omit} from '../types';\r\n\r\ninterface SwitchBase {\r\n  var: string;\r\n}\r\n\r\ninterface Is extends SwitchBase {\r\n  is: string | number | boolean;\r\n}\r\n\r\ninterface IsGreaterThan extends SwitchBase {\r\n  isGreaterThan: number;\r\n}\r\n\r\ninterface IsLessThan extends SwitchBase {\r\n  isLessThan: number;\r\n}\r\n\r\ninterface IsBetween extends SwitchBase {\r\n  isBetween: number[];\r\n}\r\n\r\n\r\ninterface IsGreaterThanOrEqualTo extends SwitchBase {\r\n  isGreaterThanOrEqualTo: number;\r\n}\r\n\r\ninterface IsLessThanOrEqualTo extends SwitchBase {\r\n  isLessThanOrEqualTo: number;\r\n}\r\n\r\ntype ifOptions = Partial<\r\n    Is\r\n  & IsGreaterThan\r\n  & IsLessThan\r\n  & IsGreaterThanOrEqualTo\r\n  & IsLessThanOrEqualTo\r\n  & IsBetween\r\n>\r\n\r\nexport interface NodeExtensions {} // tslint:disable-line no-empty-interface\r\n\r\ntype ArgumentTypes<T> = T extends (...args: infer U) => infer R ? U : never;\r\ntype ReplaceReturnType<T, TNewReturn> = (...a: ArgumentTypes<T>) => TNewReturn;\r\n\r\ntype NodeExtended = {\r\n  [P in keyof NodeExtensions]: ReplaceReturnType<NodeExtensions[P], IvNode>\r\n};\r\n\r\nexport type IvNode = Omit<Node, 'getCommands'> & NodeExtended\r\n\r\nexport class Node implements BaseNode {\r\n  private commands: ICommand.AnyCommand[] = [];\r\n  private switchDo: ICommand.Switch;\r\n  private pushType: string = 'main';\r\n\r\n  constructor( public name: string ) { }\r\n\r\n\r\n  public getCommands() {\r\n    return this.commands;\r\n  }\r\n\r\n  private pusher(command: ICommand.AnyCommand[] | ICommand.AnyCommand){\r\n    if (Array.isArray(command)) { return command.forEach(c => this.pusher(c)) }\r\n    if(this.pushType === 'condition')\r\n    {\r\n      this.switchDo.do[this.switchDo.do.length - 1].commands.push(command);\r\n    }\r\n    else if(this.pushType === 'default')\r\n    {\r\n      this.switchDo.defaultCommands.push(command);\r\n    }\r\n    else\r\n    {\r\n      this.commands.push(command);\r\n    }\r\n  }\r\n\r\n  public pushCommands(...commands: ICommand.AnyCommand[]): void {\r\n    this.pusher(commands);\r\n  }\r\n\r\n  public if(optionsObj: ifOptions): IvNode {\r\n    // TODO: need to instantiate a new for each if.\r\n    if (this.switchDo == null)\r\n    {\r\n    this.switchDo = {name: 'switch', do: [], defaultCommands: []};\r\n    }\r\n    this.pushType = 'condition';\r\n      if (optionsObj.is)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, is: optionsObj.is, commands: []});\r\n      }\r\n      else if (optionsObj.isGreaterThan)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThan: optionsObj.isGreaterThan, commands: []});\r\n      }\r\n      else if (optionsObj.isLessThan)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isLessThan: optionsObj.isLessThan, commands: []});\r\n      }\r\n      else if (optionsObj.isBetween)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isBetween: optionsObj.isBetween, commands: []});\r\n      }\r\n      else if (optionsObj.isGreaterThanOrEqualTo)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThanOrEqualTo: optionsObj.isGreaterThanOrEqualTo, commands: []});\r\n      }\r\n      else if (optionsObj.isLessThanOrEqualTo)\r\n      {\r\n        this.switchDo.do.push({varName: optionsObj.var, isGreaterThanOrEqualTo: optionsObj.isLessThanOrEqualTo, commands: []});\r\n      }\r\n    return this as any as IvNode;\r\n  }\r\n\r\n  public else(): IvNode {\r\n    this.pushType = 'default';\r\n    return this as any as IvNode;\r\n  }\r\n\r\n  public endIf(): IvNode {\r\n    this.pushType = 'main';\r\n    this.pusher(this.switchDo);\r\n    return this as any as IvNode;\r\n  }\r\n}\r\n","import { isMobileOrTablet } from 'mobile-detector';\r\nimport { createBaseEngine, IvCommandEngine } from './command-engine';\r\nimport { defaults } from './config';\r\nimport { IvNode, Node } from './node';\r\nimport { qsaToArray } from './utils';\r\nimport { forceArray } from 'happy-helpers';\r\n\r\ninterface ConstructorInput {\r\n  variables?: Partial<IV.Variables>;\r\n  settings?: Partial<IV.Settings>;\r\n}\r\n\r\ninterface ApiFunctionRegistration {\r\n  apiExtension: {\r\n    [x: string]: (this: IvNode, ...userArgs: any[]) => void;\r\n  };\r\n}\r\n\r\ninterface TargetFunctionRegistration {\r\n  targetFunctionFactories: CommandEngine.TargetFunctionFactory[],\r\n}\r\n\r\ninterface AliasRegistration {\r\n  aliases: Array<{\r\n    target: string;\r\n    aliasAs: string | string[];\r\n  }>;\r\n}\r\n\r\nexport type PluginRegistration = Partial<(TargetFunctionRegistration & ApiFunctionRegistration & AliasRegistration)>\r\n\r\nfunction isApiRegistration(pr: PluginRegistration): pr is ApiFunctionRegistration {\r\n  return !!(pr as Partial<ApiFunctionRegistration>).apiExtension\r\n}\r\n\r\nfunction isTargetFnRegistration(pr: PluginRegistration): pr is TargetFunctionRegistration {\r\n  return !!(pr as Partial<TargetFunctionRegistration>).targetFunctionFactories\r\n}\r\n\r\nfunction isAliasRegistration(pr: PluginRegistration): pr is AliasRegistration {\r\n  return !!(pr as Partial<AliasRegistration>).aliases\r\n}\r\n\r\nexport class BaseIV {\r\n  public static extend(...registrations: PluginRegistration[]): typeof BaseIV {\r\n    const originalNodeKlass = this.nodeKlass;\r\n    const newNodeKlass = class extends originalNodeKlass { }; // tslint:disable-line max-classes-per-file\r\n    const targetFunctionFactories: CommandEngine.TargetFunctionFactory[] = [];\r\n    registrations.forEach(plugin => {\r\n      if (isApiRegistration(plugin)) {\r\n        Object.keys(plugin.apiExtension).forEach(fnName => {\r\n          newNodeKlass.prototype[fnName] = function() { plugin.apiExtension[fnName].apply(this, arguments); return this; };\r\n        });\r\n      }\r\n      if (isTargetFnRegistration(plugin)) {\r\n        targetFunctionFactories.push(...plugin.targetFunctionFactories);\r\n      }\r\n      if (isAliasRegistration(plugin)) {\r\n        plugin.aliases.forEach(alias => {\r\n          const { target } = alias;\r\n          const aliases = forceArray(alias.aliasAs);\r\n          aliases.forEach(aliasAs => {\r\n            newNodeKlass.prototype[aliasAs] = newNodeKlass.prototype[target];\r\n          });\r\n        })\r\n      }\r\n    });\r\n    return class extends this { // tslint:disable-line max-classes-per-file\r\n      protected additionalFactories = targetFunctionFactories;\r\n      protected static nodeKlass = newNodeKlass;\r\n      protected nodeKlassReference = newNodeKlass;\r\n    };\r\n  }\r\n\r\n  public variables: Partial<IV.Variables> = {};\r\n  public settings: Partial<IV.Settings> = {};\r\n\r\n  private defaultSettings: IV.Settings = {\r\n    baseContainer: document.getElementById(defaults.baseElementId),\r\n    baseVideoUrl: '',\r\n    bgAudioUrl: null,\r\n    bgAudioLoop: true,\r\n  }\r\n\r\n  private engine: IvCommandEngine;\r\n\r\n  private nodes: BaseNode[] = []\r\n  protected static nodeKlass = Node;\r\n  protected nodeKlassReference = Node;\r\n  protected additionalFactories: CommandEngine.TargetFunctionFactory[] = [];\r\n\r\n  constructor(initialState: ConstructorInput = {}) {\r\n    const {variables, settings} = initialState;\r\n    if (variables) {\r\n      this.variables = variables;\r\n    }\r\n    if (settings) {\r\n      this.settings = settings;\r\n    }\r\n    this.validateDom();\r\n  }\r\n\r\n  public node(name: string): IvNode {\r\n    const newNode = new this.nodeKlassReference(name);\r\n    this.nodes.push(newNode);\r\n    return newNode as unknown as IvNode;\r\n  }\r\n\r\n  public defineNode = this.node; // tslint:disable-line member-ordering\r\n\r\n  public run(name?: string) {\r\n    this.runOnAnyPlatform(this.getEngine(), name);\r\n  }\r\n\r\n  public createRunButton(name?: string, node?: string): HTMLButtonElement {\r\n    const engine = this.getEngine();\r\n    const btn = this.createKickoffButton(name)\r\n    this.runViaButton(btn, engine, node);\r\n    return btn;\r\n  }\r\n\r\n  private getEngine(): IvCommandEngine {\r\n    return this.engine ? this.engine : this.engine = createBaseEngine(\r\n      {\r\n        settings: this.getSettings(),\r\n        nodes: this.nodes,\r\n        variables: this.variables,\r\n      },\r\n     ...this.additionalFactories,\r\n    );\r\n  }\r\n\r\n  private validateDom() {\r\n    if (!this.getSetting('baseContainer')) {\r\n      throw new Error(`No valid node present in HTML`)\r\n    }\r\n  }\r\n\r\n  private getSetting(name: keyof IV.Settings) {\r\n    if (this.settings[name] !== undefined) { return this.settings[name]; }\r\n    return this.defaultSettings[name];\r\n  }\r\n\r\n  private getSettings() {\r\n    const settings = {};\r\n    for (const key of Object.keys(this.defaultSettings)) {\r\n      settings[key] = this.getSetting(key as keyof IV.Settings);\r\n    }\r\n    return settings as IV.Settings;\r\n  }\r\n\r\n  private runOnAnyPlatform(engine: IvCommandEngine, name?: string) {\r\n    if (this.isMobileOrTablet()) {\r\n      this.runViaButton(this.createKickoffButton(), engine, name);\r\n    } else {\r\n      engine.run(name);\r\n    }\r\n  }\r\n\r\n  private isMobileOrTablet() {\r\n    return isMobileOrTablet();\r\n  }\r\n\r\n  private createKickoffButton(label = 'Kickoff') {\r\n    const startBtn = document.createElement('button');\r\n    startBtn.type = 'button';\r\n    startBtn.id = 'IV-kickoff';\r\n    startBtn.innerHTML = label;\r\n    (this.getSettings().baseContainer as HTMLElement).appendChild(startBtn);\r\n    return startBtn;\r\n  }\r\n\r\n  private runViaButton(btn: HTMLElement, engine, name?: string) {\r\n    const handleClick = () => {\r\n      btn.removeEventListener('click', handleClick);\r\n      this.prepVideosForMobile();\r\n      btn.remove();\r\n      engine.run(name);\r\n    }\r\n    btn.addEventListener('click', handleClick);\r\n  }\r\n\r\n  private prepVideosForMobile() {\r\n    // TODO: move this method to VideoController\r\n    // and call from here, or with registered kickoff event\r\n    const videos = qsaToArray(document.querySelectorAll('video')) as HTMLVideoElement[]\r\n    videos.forEach(vid => {\r\n      vid.play();\r\n      vid.pause();\r\n    })\r\n  }\r\n}\r\n","interface VideoSettings {\r\n  url: string;\r\n  // loop: boolean; // TODO: implement\r\n  goToNode: string;\r\n  runSync: string;\r\n  runAsync: string;\r\n  js: (...args) => any\r\n}\r\n\r\ntype VideoOptions = Partial<VideoSettings>\r\n\r\nexport type PlayVideoInput = (string | VideoOptions);\r\n\r\nexport class VideoCommandsBuilder {\r\n  public playVideo(...input: PlayVideoInput[]): ICommand.PlayVideo[] {\r\n    if (Array.isArray(input[0])) {\r\n      return this.handleDepricatedArrayInput(input[0] as PlayVideoInput[]);\r\n    } else {\r\n      return this.handleArrayInput(input);\r\n    }\r\n  }\r\n\r\n  public clearVideo(time?: number): Array<ICommand.Wait | ICommand.ClearVideo> {\r\n    const commands = []\r\n\r\n    if (time) {\r\n      const msTime = time * 1000;\r\n      const command: ICommand.Wait = { name: 'wait', time: msTime };\r\n      commands.push(command);\r\n    }\r\n\r\n    const clearVideoCommand: ICommand.ClearVideo = { name: 'clearVideo' };\r\n    commands.push(clearVideoCommand);\r\n\r\n    return commands;\r\n  }\r\n\r\n  private handleDepricatedArrayInput(array: PlayVideoInput[]) {\r\n    console.warn('Passing an array to playVideo is deprecated. Just pass values as individual arguments. (Remove the `[` and `]` from the method call.)')\r\n    return this.playVideo(...array);\r\n  }\r\n\r\n  private handleArrayInput(input: Array<string | VideoOptions>): ICommand.PlayVideo[] {\r\n    const singleCommand = input\r\n      .map(objOrStr => this.guaranteedOptionsObject(objOrStr))\r\n      .reduce(this.mergeMissingUrlsReducer, [])\r\n      .map(vo => this.createPlayCommandFromOptions(vo))\r\n      .reduceRight(this.reduceOnCompleteIntoPrevious, null)\r\n\r\n    return [singleCommand]\r\n  }\r\n\r\n  private mergeMissingUrlsReducer(a: VideoOptions[], current: VideoOptions): VideoOptions[] {\r\n    if (current.url) {\r\n      a.push(current);\r\n    } else {\r\n      const lastObj = a[a.length - 1];\r\n      if (!lastObj) {\r\n        throw new Error('Previous object does not exist. This error can occur if the first object passed to `playVideo` does not contain a url.');\r\n      }\r\n      Object.assign(lastObj, current);\r\n    }\r\n    return a;\r\n  }\r\n\r\n  private reduceOnCompleteIntoPrevious(\r\n    a: ICommand.PlayVideo | null,\r\n    command: ICommand.PlayVideo\r\n  ) {\r\n    if (!a) { return command; }\r\n    command.onComplete = command.onComplete || [];\r\n    command.onComplete.push(a);\r\n    return command;\r\n  }\r\n\r\n  private guaranteedOptionsObject(singleInput: PlayVideoInput): VideoOptions {\r\n    if (typeof singleInput === 'object') {\r\n      return singleInput;\r\n    } else {\r\n      return {url: singleInput};\r\n    }\r\n  }\r\n\r\n  private createPlayCommandFromOptions(obj: VideoOptions) {\r\n    const addedProps = { name: 'playVideo' as 'playVideo' };\r\n    const remappedProps = {file: obj.url};\r\n    const commandProps = this.commandOptionsToCommands(obj);\r\n    const finalObj: ICommand.PlayVideo = {...addedProps, ...remappedProps, ...commandProps};\r\n    return finalObj;\r\n  }\r\n\r\n  private commandOptionsToCommands(inputObj: VideoOptions): Partial<ICommand.PlayVideo> {\r\n    let onComplete: ICommand.AnyCommand[] = [];\r\n    function addCommands(commands: ICommand.AnyCommand | ICommand.AnyCommand[]) {\r\n      onComplete = onComplete.concat(commands)\r\n    }\r\n\r\n    if (inputObj.runAsync) {\r\n      addCommands({\r\n        name: 'executeAsync',\r\n        nodeName: inputObj.runAsync\r\n      });\r\n    }\r\n    if (inputObj.js) {\r\n      addCommands({\r\n        name: 'executeJs',\r\n        func: inputObj.js\r\n      });\r\n    }\r\n    if (inputObj.runSync) {\r\n      addCommands({\r\n        name: 'executeSync',\r\n        nodeName: inputObj.runSync\r\n      });\r\n    }\r\n    if (inputObj.goToNode) {\r\n      addCommands([\r\n        { name: 'goToNode', nodeName: inputObj.goToNode },\r\n        { name: 'stopExecution' }\r\n      ]);\r\n    }\r\n\r\n    return onComplete.length > 0 ? {onComplete} : {};\r\n  }\r\n}\r\n","function createVideoPlayer(id: string) {\r\n  const player = document.createElement('video');\r\n  player.id = id;\r\n  player.setAttribute('playsinline', 'true');\r\n  player.setAttribute('disableRemotePlayback', 'true');\r\n  player.style.display = 'block'; // fixes the android black frame issue.  Aparently it does not like 'inline'\r\n  return player;\r\n}\r\n\r\nfunction createVideoContainer(): HTMLElement {\r\n  const container = document.createElement('div');\r\n  container.className = 'IV-video-container';\r\n  return container;\r\n}\r\n\r\nclass VideoController {\r\n  private baseElement: HTMLElement = document.body;\r\n  private playerContainer = createVideoContainer();\r\n\r\n  private players = {\r\n    current: createVideoPlayer('IV-video-player-1'),\r\n    standby: createVideoPlayer('IV-video-player-2'),\r\n  }\r\n\r\n  public playVideo(url: string): Promise<any> {\r\n    const standby = this.getStandbyPlayer();\r\n    const current = this.getCurrentPlayer();\r\n    standby.onloadeddata = () => {\r\n      current.src = url;\r\n      current.play();\r\n      standby.onloadeddata = () => {}; // tslint:disable-line\r\n    }\r\n    standby.src = url;\r\n    standby.load() // essential for mobile safari\r\n    return this.whenPlayerEnds(current);\r\n  }\r\n\r\n  private whenPlayerEnds(player: HTMLVideoElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('video ended');\r\n        player.removeEventListener('ended', onEnded);\r\n      }\r\n      player.addEventListener('ended', onEnded);\r\n    })\r\n  }\r\n\r\n  public createPlayers(baseElement?: HTMLElement): void {\r\n    this.baseElement = baseElement;\r\n    this.attachPlayers(); // multiple calls are fine... does not duplicate\r\n  }\r\n\r\n  private attachPlayers() {\r\n    this.playerContainer.appendChild(this.players.standby)\r\n    this.playerContainer.appendChild(this.players.current)\r\n    this.baseElement.appendChild(this.playerContainer);\r\n  }\r\n\r\n  public getCurrentPlayer() {\r\n    return this.players.current;\r\n  }\r\n\r\n  public getStandbyPlayer() {\r\n    return this.players.standby;\r\n  }\r\n}\r\n\r\nexport const videoController = new VideoController();","import { IvNode } from '../../../node';\r\nimport { PlayVideoInput, VideoCommandsBuilder } from './video-commands-builder';\r\nimport { urlsMatch } from '../../../utils';\r\nimport { videoController } from './video-controller';\r\n\r\nexport const playVideoFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  videoController.createPlayers(baseEl);\r\n\r\n  return {'playVideo': (cmd: ICommand.PlayVideo) => {\r\n    const videoToPlay = `${input.settings.baseVideoUrl}${cmd.file}`;\r\n    const onPlayerEnd = videoController.playVideo(videoToPlay);\r\n    const returnObj: Runner.CommandReturn = {};\r\n\r\n    if (cmd.onComplete) {\r\n      const completing = new Promise((res, rej) => {\r\n        onPlayerEnd.then(() => {\r\n          if (urlsMatch(videoController.getCurrentPlayer().src, videoToPlay)) {\r\n            res(cmd.onComplete);\r\n          } else {\r\n            rej('cancelled');\r\n          }\r\n        })\r\n      }) as Promise<Runner.Command[]>\r\n\r\n      returnObj.asyncCommands = completing;\r\n    }\r\n    return Promise.resolve(returnObj);\r\n  }}\r\n}\r\n\r\nconst videoCommandBuilder = new VideoCommandsBuilder();\r\n\r\nexport interface AddPlayVideo {\r\n  playVideo(...urlOrInstructions: PlayVideoInput[])\r\n}\r\n\r\nexport const playVideo: AddPlayVideo['playVideo'] = function(this: IvNode, ...input: PlayVideoInput[]) : void {\r\n  this.pushCommands(...videoCommandBuilder.playVideo(...input));\r\n}\r\n","import { IvNode } from '../../../node';\r\nimport { VideoCommandsBuilder } from './video-commands-builder';\r\nimport { videoController } from './video-controller';\r\n\r\nexport const clearVideoFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  videoController.createPlayers(baseEl);\r\n\r\n  return {\r\n    'clearVideo': async (cmd: ICommand.PlayVideo) => {\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nconst videoCommandBuilder = new VideoCommandsBuilder();\r\n\r\nexport interface AddClearVideo {\r\n  clearVideo(time?: number);\r\n}\r\n\r\nexport const clearVideo: AddClearVideo['clearVideo']= function(this: IvNode, time?: number): void {\r\n  this.pushCommands(...videoCommandBuilder.clearVideo(time));\r\n}\r\n","import { playVideo, playVideoFactory, AddPlayVideo } from './play-video'\r\nimport { clearVideo, clearVideoFactory, AddClearVideo } from './clear-video';\r\nimport { PluginRegistration } from '../../../base-iv';\r\n\r\nexport const videoPlugin: PluginRegistration = {\r\n  apiExtension: {\r\n    playVideo,\r\n    clearVideo,\r\n  },\r\n  targetFunctionFactories: [\r\n    playVideoFactory,\r\n    clearVideoFactory\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddClearVideo, AddPlayVideo {\r\n  }\r\n}\r\n","import { wait } from '../../../utils';\r\n\r\nfunction createAudioPlayer(id: string): HTMLAudioElement {\r\n  const player = document.createElement('audio');\r\n  player.id = id;\r\n  return player;\r\n}\r\n\r\nclass AudioController {\r\n  public _fadeInterval = 200;\r\n  private baseElement: HTMLElement = document.body;\r\n\r\n  private players = {\r\n    bg: createAudioPlayer('IV-audio-player-bg'),\r\n    sfx: createAudioPlayer('IV-audio-player-sfx'),\r\n  }\r\n\r\n  public play(playerName: ICommand.AudioSource['target'], url?: string): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (url && player.src !== url) {\r\n      player.src = url;\r\n    }\r\n    player.play();\r\n    return this.whenPlayerEnds(player);\r\n  }\r\n\r\n  public pause(playerName: ICommand.AudioSource['target']): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    player.pause();\r\n    return Promise.resolve('audio paused');\r\n  }\r\n\r\n  public load(playerName: ICommand.AudioSource['target'], url: string): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (url && player.src !== url) {\r\n      player.src = url;\r\n    }\r\n    return this.whenPlayerLoads(player);\r\n  }\r\n\r\n  public loop(playerName: ICommand.AudioSource['target'], loop: boolean): void {\r\n    this.getPlayerNamed(playerName).loop = loop;\r\n  }\r\n\r\n  public volume(playerName, volume, time?): Promise<any> {\r\n    const player = this.getPlayerNamed(playerName);\r\n    if (time && time > this._fadeInterval) {\r\n      this.fadeOverTime(player, volume, time);\r\n    } else {\r\n      player.volume = volume;\r\n    }\r\n    return Promise.resolve('audio volume adjusted');\r\n  }\r\n\r\n  private async fadeOverTime(player, desiredVolume, time) {\r\n    const startTime = Date.now();\r\n    const startVolume = player.volume;\r\n    const totalAdjustment = desiredVolume - startVolume;\r\n    let currentPercent = 0;\r\n\r\n    function percentComplete() {\r\n      const traveled = Date.now() - startTime;\r\n      currentPercent = Math.min(traveled / time, 1);\r\n      return currentPercent;\r\n    }\r\n\r\n    while (currentPercent < 1) {\r\n      player.volume = startVolume + (totalAdjustment * percentComplete());\r\n      if (currentPercent === 1) { player.volume = desiredVolume; }\r\n      await wait(this._fadeInterval)\r\n    }\r\n  }\r\n\r\n  private whenPlayerEnds(player: HTMLAudioElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('audio ended');\r\n        player.removeEventListener('ended', onEnded);\r\n      }\r\n      player.addEventListener('ended', onEnded);\r\n    })\r\n  }\r\n\r\n  private whenPlayerLoads(player: HTMLAudioElement): Promise<any> {\r\n    return new Promise((resolve) => {\r\n      const onEnded = () => {\r\n        resolve('audio loaded');\r\n        player.removeEventListener('loadeddata', onEnded);\r\n      }\r\n      player.addEventListener('loadeddata', onEnded);\r\n    })\r\n  }\r\n\r\n  public createPlayers(baseElement?: HTMLElement): void {\r\n    this.baseElement = baseElement;\r\n    this.attachPlayers(); // multiple calls are fine... does not duplicate\r\n  }\r\n\r\n  private attachPlayers() {\r\n    this.baseElement.appendChild(this.players.bg)\r\n    this.baseElement.appendChild(this.players.sfx)\r\n  }\r\n\r\n  public getBgPlayer() {\r\n    return this.players.bg;\r\n  }\r\n\r\n  public getSfxPlayer() {\r\n    return this.players.sfx;\r\n  }\r\n\r\n  public getPlayerNamed<T extends ICommand.AudioSource['target']>(name: T): HTMLAudioElement {\r\n    return this.players[name.toLowerCase()]\r\n  }\r\n}\r\n\r\nexport const audioController = new AudioController();\r\n","import { IvNode } from '../../../node';\r\nimport { audioController } from './audio-controller';\r\n\r\ninterface AudioAction {\r\n  action: 'play' | 'pause' | 'load';\r\n  url?: string;\r\n  loop?: boolean;\r\n}\r\n\r\ninterface AudioShorthand {\r\n  play?: string;\r\n  load?: string;\r\n  loop?: boolean;\r\n}\r\n\r\ntype AudioInput = 'play' | 'pause' | 'loop' | AudioShorthand | AudioAction;\r\n\r\nexport const audioSourceFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  audioController.createPlayers(baseEl);\r\n\r\n  if (input.settings.bgAudioUrl) {\r\n    audioController.load('BG', input.settings.bgAudioUrl)\r\n  }\r\n  audioController.loop('BG', input.settings.bgAudioLoop)\r\n\r\n  return {'audioSource': (cmd: ICommand.AudioSource) => {\r\n    const {target, file, loop} = cmd;\r\n    switch (cmd.do) {\r\n      case 'play':\r\n        audioController.play(target, file);\r\n        break;\r\n      case 'load':\r\n        audioController.load(target, file);\r\n        break;\r\n      case 'pause':\r\n        audioController.pause(target)\r\n        break;\r\n      default:\r\n        throw new Error(`unexpected command for audio source: \"${cmd.do}\"`);\r\n    }\r\n\r\n    if (loop !== undefined) {\r\n      audioController.loop(target, loop);\r\n    }\r\n\r\n    const returnObj: Runner.CommandReturn = {};\r\n\r\n    return Promise.resolve(returnObj);\r\n  }}\r\n}\r\n\r\nexport interface AddBgAudio {\r\n  bgAudio(input: AudioInput);\r\n}\r\n\r\nexport const bgAudio: AddBgAudio['bgAudio'] = function(this: IvNode, input: AudioInput) {\r\n  this.pushCommands(bgAudioCommand(input));\r\n}\r\n\r\nfunction bgAudioCommand(input: AudioInput): ICommand.AudioSource {\r\n  if (typeof input === 'string') {\r\n    return {\r\n      name: 'audioSource',\r\n      target: 'BG',\r\n      do: input === 'loop' ? null : input,\r\n      loop: input === 'loop' ? true : undefined,\r\n    }\r\n  } else {\r\n    if ((input as AudioAction).action) {\r\n      return {\r\n        name: 'audioSource',\r\n        target: 'BG',\r\n        do: (input as AudioAction).action,\r\n        file: (input as AudioAction).url,\r\n        loop: (input as AudioAction).loop,\r\n      }\r\n    } else {\r\n      const { play, load, loop } = input as AudioShorthand;\r\n      if (play) {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: 'play',\r\n          file: play,\r\n          loop\r\n        }\r\n      } else if (load) {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: 'load',\r\n          file: load,\r\n          loop\r\n        }\r\n      } else {\r\n        return {\r\n          name: 'audioSource',\r\n          target: 'BG',\r\n          do: null,\r\n          file: load,\r\n          loop\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const audioVolumeFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n  audioController.createPlayers(baseEl);\r\n\r\n  return {\r\n    'audioVolume': (cmd: ICommand.AudioVolume) => {\r\n      const returnObj: Runner.CommandReturn = {};\r\n\r\n      if (cmd.time) {\r\n        audioController.volume(cmd.target, cmd.volume, cmd.time)\r\n      } else {\r\n        audioController.volume(cmd.target, cmd.volume)\r\n      }\r\n\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddSetVolume {\r\n  setVolume(input: { target: 'bg' | 'sfx', volume: number, time?: number });\r\n}\r\n\r\nexport const setVolume: AddSetVolume['setVolume'] = function(this: IvNode, input: { target: 'bg' | 'sfx', volume: number, time?: number }) {\r\n  const { volume, target, time } = input;\r\n  const command: ICommand.AudioVolume = {\r\n    name: 'audioVolume',\r\n    target: target.toUpperCase() as 'BG' | 'SFX',\r\n    volume,\r\n    time: time ? time * 1000 : time,\r\n  }\r\n  this.pushCommands(command);\r\n}\r\n","import { audioSourceFactory, audioVolumeFactory, bgAudio, setVolume, AddBgAudio, AddSetVolume } from './audio-commands';\r\nimport { PluginRegistration } from '../../../base-iv';\r\n\r\nexport const audioPlugin: PluginRegistration = {\r\n  apiExtension: {\r\n    bgAudio,\r\n    setVolume,\r\n  },\r\n  targetFunctionFactories: [\r\n    audioVolumeFactory,\r\n    audioSourceFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddBgAudio, AddSetVolume { }\r\n}","export interface ButtonOptions {\r\n  id: string;\r\n  text: string;\r\n  goToNode?: string;\r\n  runAsync?: string;\r\n  remove?: boolean;\r\n  js?: () => any,\r\n}\r\n\r\nexport class ButtonCommandsBuilder {\r\n  public addButton(input: ButtonOptions) {\r\n    const { id, text } = input;\r\n    const cmd: ICommand.AddButton = {\r\n      name: 'addButton',\r\n      id,\r\n      text,\r\n      onClick: this.createCommands(input)\r\n    }\r\n    return cmd;\r\n  }\r\n\r\n  public removeAllButtons(): ICommand.RemoveAllButtons {\r\n    return {\r\n      name: 'removeAllButtons'\r\n    }\r\n  }\r\n\r\n  private createCommands(input: ButtonOptions): ICommand.AnyCommand[] {\r\n    const { runAsync, goToNode, js, remove, id } = input;\r\n    const commands: ICommand.AnyCommand[] = [];\r\n\r\n    if (runAsync) {\r\n      commands.push({\r\n        name: 'executeAsync',\r\n        nodeName: runAsync,\r\n      })\r\n    }\r\n    if (js) {\r\n      commands.push({\r\n        name: 'executeJs',\r\n        func: js\r\n      })\r\n    }\r\n    if (remove) {\r\n      commands.push({\r\n        name: 'removeButton',\r\n        id\r\n      })\r\n    }\r\n    if (goToNode) {\r\n      commands.push({\r\n        name: 'goToNode',\r\n        nodeName: goToNode\r\n      },{\r\n        name: 'stopExecution'\r\n      })\r\n    }\r\n\r\n    return commands;\r\n  }\r\n}\r\n","import { traverseObject } from 'happy-helpers';\r\nimport { defaults } from '../../../config';\r\nimport { directDescendants, nearClone } from '../../../utils'\r\n\r\nexport interface IButtonSettings {\r\n  text: string;\r\n  onClick(): any;\r\n  [s:string]: any;\r\n}\r\n\r\nclass ButtonsController {\r\n  private allButtons: HTMLButtonElement[] = [];\r\n\r\n  public createButton(\r\n    settings: IButtonSettings,\r\n    element?: HTMLElement\r\n  ): HTMLButtonElement {\r\n    const button = this.newButton(settings);\r\n    this.addToButtonStore(button);\r\n    this.appendToDocument(button, element);\r\n    return button;\r\n  }\r\n\r\n  public removeAllButtons() {\r\n    this.allButtons = this.allButtons.reduce((a, b) => {\r\n      b.remove();\r\n      return a;\r\n    }, [])\r\n  }\r\n\r\n  public removeButton(id: string) {\r\n    this.allButtons.filter(b => b.id === id)\r\n      .forEach(b => b.remove());\r\n  }\r\n\r\n  private newButton(settings: IButtonSettings): HTMLButtonElement {\r\n    const button = document.createElement('button');\r\n    this.applySettingsToButton(button, settings);\r\n    return button;\r\n  }\r\n\r\n  private applySettingsToButton(button: HTMLButtonElement, settings: IButtonSettings) {\r\n    const attrs: any = nearClone(settings);\r\n\r\n    attrs.onclick = attrs.onClick;\r\n    delete attrs.onClick;\r\n\r\n    button.innerHTML = attrs.text\r\n    delete attrs.text;\r\n\r\n    traverseObject(attrs, (prop, value) => {\r\n      button[prop] = value\r\n    }, false, false)\r\n  }\r\n\r\n  private addToButtonStore(button: HTMLButtonElement) {\r\n    this.allButtons.push(button);\r\n  }\r\n\r\n  private appendToDocument(button: HTMLButtonElement, parentEl?: HTMLElement) {\r\n    const container = this.getContainer(parentEl);\r\n    container.appendChild(button);\r\n  }\r\n\r\n  private getContainer(parentEl?: HTMLElement): HTMLElement {\r\n    const parent = parentEl || this.baseElement();\r\n    const foundContainer = directDescendants(parent, `.${defaults.buttonContainerClass}`)[0]\r\n    if (foundContainer) { return foundContainer; }\r\n\r\n    const newContainer = document.createElement('div');\r\n    newContainer.setAttribute('class', defaults.buttonContainerClass);\r\n    parent.appendChild(newContainer);\r\n    return newContainer;\r\n  }\r\n\r\n  private baseElement(): HTMLElement {\r\n    return document.getElementById(defaults.baseElementId);\r\n  }\r\n\r\n}\r\n\r\nexport const buttonsController = new ButtonsController();\r\n","import { IvNode } from '../../../node';\r\nimport { ButtonCommandsBuilder, ButtonOptions } from './button-commands-builder';\r\nimport { buttonsController, IButtonSettings } from './buttons-controller';\r\n\r\nconst buttonCommands = new ButtonCommandsBuilder();\r\n\r\nexport const addButtonFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'addButton': (cmd: ICommand.AddButton) => {\r\n    const settings: IButtonSettings = {\r\n      onClick: () => input.commandEngine.runCommands(cmd.onClick),\r\n      text: cmd.text,\r\n      id: cmd.id,\r\n    };\r\n    buttonsController.createButton(settings, baseEl)\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport interface AddAddButton {\r\n  addButton(instructions: ButtonOptions)\r\n}\r\n\r\nexport const addButton: AddAddButton['addButton'] = function(this: IvNode, input: ButtonOptions): void {\r\n  const cmd = buttonCommands.addButton(input);\r\n  this.pushCommands(cmd);\r\n}\r\n\r\nexport const removeButtonFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'removeButton': (cmd: ICommand.RemoveButton) => {\r\n    buttonsController.removeButton(cmd.id)\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport const removeAllButtonsFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  const baseEl = input.settings.baseContainer as HTMLElement;\r\n\r\n  return {'removeAllButtons': (cmd: ICommand.RemoveAllButtons) => {\r\n    buttonsController.removeAllButtons();\r\n    return Promise.resolve({});\r\n  }}\r\n}\r\n\r\nexport interface AddRemoveAllButtons {\r\n  removeAllButtons();\r\n}\r\n\r\nexport const removeAllButtons: AddRemoveAllButtons['removeAllButtons'] = function(this: IvNode): void {\r\n  const cmd = buttonCommands.removeAllButtons();\r\n  this.pushCommands(cmd);\r\n}\r\n","import { PluginRegistration } from '../../base-iv';\r\nimport { videoPlugin } from './video';\r\nimport { audioPlugin } from './audio';\r\nimport { buttonsPlugin } from './buttons';\r\n\r\n// Ensure that the export chain reaches up to our\r\n// IvNode module merges.\r\nexport * from './video';\r\nexport * from './audio';\r\nexport * from './buttons';\r\n\r\nconst plugins: PluginRegistration[] = [\r\n  videoPlugin,\r\n  audioPlugin,\r\n  buttonsPlugin,\r\n]\r\n\r\nexport default plugins;","import { PluginRegistration } from '../../../base-iv';\r\nimport { addButton, removeAllButtons, addButtonFactory, removeAllButtonsFactory, removeButtonFactory, AddRemoveAllButtons, AddAddButton } from './button-commands';\r\n\r\nexport const buttonsPlugin: PluginRegistration = {\r\n  apiExtension: {\r\n    addButton,\r\n    removeAllButtons\r\n  },\r\n  targetFunctionFactories: [\r\n    addButtonFactory,\r\n    removeAllButtonsFactory,\r\n    removeButtonFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddRemoveAllButtons, AddAddButton {\r\n  }\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\ninterface CalculateBase {\r\n  var: string;\r\n  storeIn?: string;\r\n}\r\n\r\n\r\ntype CalcInstructions = CalculateBase & Partial<{\r\n  add: number | string;\r\n  subtract: number | string;\r\n  multiply: number | string;\r\n  divide: number | string;\r\n  remainderAfterDivideBy: number | string;\r\n  roundDownAfterDivideBy: number | string;\r\n  roundUpAfterDivideBy: number | string;\r\n  roundAfterDivideBy: number | string;\r\n  round: any;\r\n  roundUp: any;\r\n  roundDown: any;\r\n\r\n}>;\r\n\r\n\r\nexport const calculateFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'calculate':\r\n      (cmd: ICommand.Calculate) =>\r\n        Promise.resolve(doCalculate(input, cmd))\r\n  }\r\n}\r\n\r\nexport function doCalculate(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.Calculate\r\n): Runner.CommandReturn {\r\n  const { variables } = given;\r\n  const { operation, varName, assignTo } = cmd;\r\n  let { value } = cmd;\r\n\r\n  if (typeof value === 'string') {\r\n    console.warn('The value passed in to the calculate command was not resolved to a number. Attempting to parse it as a number. Beware unexpected results. It is best to ensure that the variable you are using as the operand in the calculate command will evaluate to a number, not a string.')\r\n    const tempValue = parseFloat(value);\r\n    if (Number.isNaN(tempValue)) {\r\n      throw new Error('Could not parse string as number');\r\n    }\r\n    value = tempValue;\r\n  }\r\n\r\n  if (typeof value !== 'number') {\r\n    throw new Error(`The variable that was used in the calculate command did not resolve to anything number-like. Your attempted invocation would have looked something like .calculate({var: '${varName}', ${operation}: 'SOME_VARIABLE_NAME'})...`)\r\n  }\r\n\r\n  const startingValue = variables[varName]\r\n  variables[assignTo] = \r\n    getOperation(operation)(startingValue, value)\r\n  return {};\r\n}\r\n\r\nconst operations = {\r\n  add: (val1, val2) => val1 + val2,\r\n  subtract: (val1, val2) => val1 - val2,\r\n  multiply: (val1, val2) => val1 * val2,\r\n  divide: (val1, val2) => val1 / val2,\r\n  remainderAfterDivideBy: (val1, val2) => val1 % val2,\r\n  roundDownAfterDivideBy: (val1, val2) => Math.floor(val1 / val2),\r\n  roundUpAfterDivideBy: (val1, val2) => Math.ceil(val1 / val2),\r\n  roundAfterDivideBy: (val1, val2) => Math.round(val1 / val2),\r\n  round: (val1) => Math.round(val1),\r\n  roundUp: (val1) => Math.ceil(val1),\r\n  roundDown: (val1) => Math.floor(val1),\r\n}\r\n\r\nfunction getOperation(operator: string) {\r\n  const theOperation = operations[operator];\r\n  if (!theOperation) {\r\n    throw new Error(`There is no \"${operator}\" operation in the calculate command`);\r\n  }\r\n  return theOperation;\r\n}\r\n\r\nfunction testUserInput(optionsObj: CalcInstructions) {\r\n  const failures = [];\r\n  const availableOperations = Object.keys(operations);\r\n  const passedProps = Object.keys(optionsObj);\r\n  const chosenOperations = passedProps.filter(key => availableOperations.indexOf(key) > -1);\r\n  const unknownProps = passedProps\r\n    .filter(passed => ['var', 'storeIn'].concat(availableOperations).indexOf(passed) === -1);\r\n\r\n  if (!optionsObj.var) {\r\n    failures.push('It did not contain a \"var\" property.')\r\n  }\r\n  \r\n  if (chosenOperations.length < 1) {\r\n    failures.push('It contained no known operations (add, subtract, etc).')\r\n  }\r\n\r\n  if (chosenOperations.length > 1) {\r\n    failures.push('It contained more than one operation (add, subtract, etc).')\r\n  }\r\n\r\n  if (unknownProps.length > 0) {\r\n    const unknownPropsList = unknownProps\r\n      .map(prop => `\"${prop}\"`).join(', ')\r\n      .replace(/, ([^,]*)$/, ', and $1');\r\n    failures.push(`It contained unknown ${unknownProps.length > 1 ? 'properties' : 'property'} ${unknownPropsList}.`)\r\n  }\r\n\r\n  if (failures.length > 0) {\r\n    const keyValueStrings = passedProps.map(propName => {\r\n      let theValue = optionsObj[propName];\r\n      theValue = typeof theValue === 'string' ? `\"${theValue}\"` : theValue;\r\n      return `${propName}: ${theValue}`;\r\n    });\r\n    const availableOperationsList = availableOperations\r\n      .map(opName => `\"${opName}\"`).join(', ')\r\n      .replace(/, ([^,]*)$/, ', or $1');\r\n    const message = `${failures.join('\\n')}\\n\\nThe \\`calculate()\\` command expects an object with properties \"var\", and then exactly one of ${availableOperationsList}. Optionally also \"storeIn\" If you don't want to overwrite the current variable.\\n\\nReceived {${keyValueStrings.join(', ')}}`\r\n    throw new Error(message)\r\n  }\r\n\r\n}\r\n\r\nexport interface AddCalculate {\r\n  calculate(instructions: CalcInstructions);\r\n}\r\n\r\nexport const calculate: AddCalculate['calculate'] = function(this: IvNode, optionsObj: CalcInstructions): void {\r\n  testUserInput(optionsObj);\r\n  const availableOperations = Object.keys(operations);\r\n  const operation = Object.keys(optionsObj).filter(key => availableOperations.indexOf(key) > -1)[0] as ICommand.Calculate['operation'];\r\n  const value = optionsObj[operation];\r\n\r\n  const assignTo = optionsObj.storeIn ? optionsObj.storeIn : optionsObj.var;\r\n  \r\n  const command: ICommand.Calculate = {\r\n    name: 'calculate',\r\n    varName: optionsObj.var,\r\n    operation,\r\n    value,\r\n    assignTo,\r\n  };\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\nimport { getRandomInt } from '../../../utils';\r\n\r\nexport interface RandNumInstructions {\r\n  min: number;\r\n  max: number;\r\n  storeIn: string;\r\n}\r\n\r\nexport const getRandomNumberFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'getRandomNumber':\r\n      (cmd: ICommand.GetRandomNumber) =>\r\n        Promise.resolve(getRandomNumber(input, cmd))\r\n  }\r\n}\r\n\r\nexport function getRandomNumber(\r\n  given: CommandEngine.TargetFunctionFactoryInput,\r\n  cmd: ICommand.GetRandomNumber\r\n): Runner.CommandReturn {\r\n\r\n  given.variables[cmd.assignTo] = getRandomInt(cmd.min, cmd.max);\r\n  return {};\r\n}\r\n\r\nexport interface AddGetRandom {\r\n  getRandom(instructions: RandNumInstructions);\r\n}\r\n\r\nexport const getRandomNumberApi: AddGetRandom['getRandom'] = function(this: IvNode, objSettings: RandNumInstructions) : void {\r\n  const command: ICommand.GetRandomNumber = { name:'getRandomNumber', min: objSettings.min, max: objSettings.max, assignTo: objSettings.storeIn };\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const executeAsyncFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'executeAsync': (cmd: ICommand.ExecuteAsync) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      input.commandEngine.runNodeByName(cmd.nodeName)\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddRunAsync {\r\n  runAsync(nodeName: string);\r\n}\r\n\r\nexport const runAsync: AddRunAsync['runAsync'] = function(this: IvNode, nodeName: string) : void {\r\n  const command: ICommand.ExecuteAsync = {name:'executeAsync', nodeName};\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const executeSyncFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'executeSync': (cmd: ICommand.ExecuteSync) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      return new Promise(async (resolve) => {\r\n        (await input.commandEngine.runNodeByName(cmd.nodeName)).once('done', () => resolve(returnObj))\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddRunSync {\r\n  runSync(nodeName: string)\r\n}\r\n\r\nexport const runSync: AddRunSync['runSync'] = function(this: IvNode, nodeName: string) : void {\r\n  const command: ICommand.ExecuteSync = {name:'executeSync', nodeName};\r\n  this.pushCommands(command);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const stopExecutionFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'stopExecution': (cmd: ICommand.StopExecution) => {\r\n      const returnObj: Runner.CommandReturn = {\r\n        requests: ['exit'],\r\n      };\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport const pauseExecutionFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'pauseExecution': (cmd: ICommand.PauseExecution) => {\r\n      const returnObj: Runner.CommandReturn = {\r\n        requests: ['pause'],\r\n      };\r\n      return Promise.resolve(returnObj);\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddStopExecution {\r\n  endAllNodes();\r\n}\r\n\r\nexport const stopExecution: AddStopExecution['endAllNodes'] = function(this: IvNode) : void {\r\n  const commandStop: ICommand.StopExecution = {name:'stopExecution'};\r\n  this.pushCommands(commandStop);\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const waitFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n\r\n  return {\r\n    'wait': (cmd: ICommand.Wait) => {\r\n      const returnObj: Runner.CommandReturn = { };\r\n      \r\n      return new Promise(resolve => {\r\n        setTimeout(() => resolve(returnObj), cmd.time)\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddWait {\r\n  wait(time: number);\r\n}\r\n\r\nexport const wait: AddWait['wait'] = function(this: IvNode, time: number) : void {\r\n  const msTime = time * 1000;\r\n  const command: ICommand.Wait = { name:'wait', time: msTime };\r\n  this.pushCommands(command);\r\n}\r\n\r\n","import { PluginRegistration } from '../../../base-iv';\r\nimport { runAsync, executeAsyncFactory, AddRunAsync } from './execute-async';\r\nimport { runSync, executeSyncFactory, AddRunSync } from './execute-sync';\r\nimport { stopExecution, stopExecutionFactory, pauseExecutionFactory, AddStopExecution } from './execution-requests';\r\nimport { goToNode, goToNodeFactory, AddGoToNode } from './go-to-node';\r\nimport { wait, waitFactory, AddWait } from './wait';\r\n\r\nconst deprecate = (oldName: string, newName:string, fn: (...args: any[]) => any) => function (...args: any[]) {\r\n  console.warn(`The ${oldName} command has been deprecated. Please use ${newName} instead. If you like the old name better, consider aliasing the function. See IVjs documentaion regarding plugins for an explanation.`);\r\n  return fn.apply(this, args);\r\n};\r\n\r\nexport const executionModifiersPlugin: PluginRegistration = {\r\n  apiExtension: {\r\n    return: deprecate('return', 'endAllNodes', stopExecution),\r\n    goSub: deprecate('goSub', 'runSync', runSync),\r\n    execute: deprecate('execute', 'runAsync', runAsync),\r\n    endAllNodes: stopExecution,\r\n    runSync,\r\n    runAsync,\r\n    goToNode,\r\n    wait,\r\n  },\r\n  targetFunctionFactories: [\r\n    stopExecutionFactory,\r\n    pauseExecutionFactory,\r\n    executeAsyncFactory,\r\n    executeSyncFactory,\r\n    goToNodeFactory,\r\n    waitFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddStopExecution, AddRunAsync, AddRunSync, AddGoToNode, AddWait {\r\n    /**\r\n     * Deprecated in favor of `endAllNodes()`\r\n     */\r\n    return: typeof stopExecution\r\n    /**\r\n     * Deprecated in favor of `runSync()`\r\n     */\r\n    goSub: typeof runSync\r\n    /**\r\n     * Deprecated in favor of `runAsync()`\r\n     */\r\n    execute: typeof runAsync\r\n  }\r\n}\r\n","import { PluginRegistration } from '../../base-iv';\r\n\r\nimport { variableManipulationPlugin } from './variable-modification';\r\nimport { executionModifiersPlugin } from './execution-modifiers';\r\n\r\n// Ensure that the export chain reaches up to our\r\n// IvNode module merges.\r\nexport * from './variable-modification';\r\nexport * from './variable-modification/get-random-number';\r\nexport * from './execution-modifiers';\r\nexport * from './execution-modifiers/wait';\r\n\r\nconst plugins: PluginRegistration[] = [\r\n  variableManipulationPlugin,\r\n  executionModifiersPlugin,\r\n];\r\n\r\nexport default plugins;","import { PluginRegistration } from '../../../base-iv';\r\nimport { assignVariableFactory, assignFromVariableFactory, setVariable, AddSetVariable } from './set-variable';\r\nimport { calculate, calculateFactory, AddCalculate } from '../variable-modification/calculate';\r\nimport { getRandomNumberApi, getRandomNumberFactory, AddGetRandom } from './get-random-number';\r\n\r\nexport const variableManipulationPlugin: PluginRegistration = {\r\n  apiExtension: {\r\n    calculate,\r\n    setVariable,\r\n    getRandom: getRandomNumberApi,\r\n  },\r\n  targetFunctionFactories: [\r\n    assignVariableFactory,\r\n    assignFromVariableFactory,\r\n    calculateFactory,\r\n    getRandomNumberFactory,\r\n  ],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddCalculate, AddGetRandom, AddSetVariable { }\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\ninterface BaseAssignVariable {\r\n  storeIn: string;\r\n}\r\n\r\ninterface AssignVariableWithVar extends BaseAssignVariable {\r\n  var: string;\r\n}\r\n\r\ninterface AssignVariableWithValue extends BaseAssignVariable  {\r\n  value: string | number | Array<string | number>;\r\n}\r\n\r\ntype SetVarInstructions =  BaseAssignVariable & Partial<AssignVariableWithVar & AssignVariableWithValue>;\r\n\r\nexport const assignFromVariableFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'assignFromVariable': (cmd: ICommand.AssignFromVariable) => {\r\n      input.variables[cmd.assignTo] = input.variables[cmd.varName];\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport const assignVariableFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'assignVariable': (cmd: ICommand.AssignVariable) => {\r\n      input.variables[cmd.assignTo] = cmd.value;\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddSetVariable {\r\n  setVariable(instructions: SetVarInstructions);\r\n}\r\n\r\nexport const setVariable: AddSetVariable['setVariable'] = function(this: IvNode, objSettings: SetVarInstructions) : IvNode {\r\n  if (objSettings.var)\r\n  {\r\n    const command: ICommand.AssignFromVariable = { name:'assignFromVariable', varName : objSettings.var,  assignTo: objSettings.storeIn };\r\n    this.pushCommands(command);\r\n  }\r\n  else\r\n  {\r\n    if(objSettings.value)\r\n    {\r\n      const command: ICommand.AssignVariable = { name:'assignVariable', value: objSettings.value , assignTo: objSettings.storeIn };\r\n      this.pushCommands(command);\r\n    }\r\n\r\n  }\r\n  return this as any as IvNode;\r\n}\r\n","import { IvNode } from '../../../node';\r\n\r\nexport const goToNodeFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'goToNode': (cmd: ICommand.GoToNode) => {\r\n      input.commandEngine.runNodeByName(cmd.nodeName);\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\nexport interface AddGoToNode {\r\n  goToNode(nodeName: string);\r\n}\r\n\r\nexport const goToNode: AddGoToNode['goToNode'] = function(this: IvNode, nodeName: string) : void {\r\n  const commands = buildGoToNodeCommandSet(nodeName);\r\n  this.pushCommands(...commands);\r\n}\r\n\r\nfunction buildGoToNodeCommandSet(nodeName: string): [\r\n  ICommand.GoToNode,\r\n  ICommand.StopExecution\r\n] {\r\n  return [\r\n    { name: 'goToNode', nodeName },\r\n    { name: 'stopExecution' }\r\n  ];\r\n}\r\n","import { PluginRegistration } from '../../base-iv';\r\nimport {logPlugin} from './log';\r\n\r\n// Ensure that the export chain reaches up to our\r\n// IvNode module merges.\r\nexport * from './log';\r\n\r\nconst plugins: PluginRegistration[] = [\r\n  logPlugin,\r\n];\r\n\r\nexport default plugins;","import { PluginRegistration } from '../../base-iv';\r\nimport { IvNode } from '../../node';\r\n\r\nexport const logFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'log': (cmd: ICommand.Log) => {\r\n      if (cmd.value == null) {\r\n        console.log(input.variables);\r\n      } else {\r\n        console.log(cmd.value)\r\n      }\r\n      return Promise.resolve({});\r\n    }\r\n  }\r\n}\r\n\r\ninterface AddLog {\r\n  log(anything: any);\r\n}\r\n\r\nconst log: AddLog['log'] = function(this: IvNode, anything: any): void {\r\n  const command: ICommand.Log = {\r\n    name: 'log',\r\n    value: anything,\r\n  };\r\n  this.pushCommands(command);\r\n}\r\n\r\nexport const logPlugin: PluginRegistration = {\r\n  apiExtension: { log },\r\n  targetFunctionFactories: [logFactory],\r\n};\r\n\r\ndeclare module '../../node' {\r\n  interface NodeExtensions extends AddLog { } // tslint:disable-line no-empty-interface\r\n}","import { PluginRegistration } from '../../base-iv';\r\nimport {runJsPlugin} from './execute-js/execute-js'\r\n\r\n// Ensure that the export chain reaches up to our\r\n// IvNode module merges.\r\nexport * from './execute-js/execute-js'\r\n\r\nconst plugins: PluginRegistration[] = [\r\n  runJsPlugin\r\n];\r\n\r\nexport default plugins;","import { PluginRegistration } from '../../../base-iv';\r\nimport { IvNode } from '../../../node';\r\n\r\nexport const executeJsFactory: CommandEngine.TargetFunctionFactory = (input): Runner.TargetFunctionObject => {\r\n  return {\r\n    'executeJs': async (cmd: ICommand.ExecuteJs) => {\r\n      await Promise.resolve(cmd.func());\r\n      return ({});\r\n    }\r\n  }\r\n}\r\n\r\ntype AnyArgsReturnVoid = (...args: any[]) => void\r\n\r\ninterface AddJs {\r\n  js(func: AnyArgsReturnVoid);\r\n}\r\n\r\nconst js: AddJs['js'] = function jsDefinition(this: IvNode, func: AnyArgsReturnVoid) {\r\n  this.pushCommands({ name: 'executeJs', func });\r\n}\r\n\r\nexport const runJsPlugin: PluginRegistration = {\r\n  apiExtension: { js },\r\n  targetFunctionFactories: [executeJsFactory],\r\n}\r\n\r\ndeclare module '../../../node' {\r\n  interface NodeExtensions extends AddJs { } // tslint:disable-line no-empty-interface\r\n}\r\n","import { PluginRegistration } from '../base-iv';\r\n\r\nimport domCommandsPlugins from './dom-commands';\r\nimport generalCommmandsPlugins from './general-commands';\r\nimport loggingCommandsPlugins from './logging-commands';\r\nimport unserializablePlugins from './unserializable-plugins';\r\n\r\n// Ensure that the export chain reaches up to our\r\n// IvNode module merges.\r\nexport * from './dom-commands';\r\nexport * from './general-commands';\r\nexport * from './logging-commands';\r\nexport * from './unserializable-plugins';\r\n\r\nconst plugins: PluginRegistration[] = [\r\n  ...domCommandsPlugins,\r\n  ...generalCommmandsPlugins,\r\n  ...loggingCommandsPlugins,\r\n  ...unserializablePlugins,\r\n]\r\n\r\nexport default plugins;","import { BaseIV } from './base-iv';\r\nimport allPlugins from './plugins';\r\nexport const IV = BaseIV.extend(...allPlugins)\r\n\r\nexport type IV = BaseIV;\r\n\r\n// The next line helps ensure that our IvNode module merges are\r\n// visible in typings without the user needing to import each\r\n// one individually. So, it is really more like an export.\r\nimport './plugins'; // tslint:disable-line no-duplicate-imports\r\n","import './styles/base.scss';\r\nexport * from './lib/iv';\r\n"],"sourceRoot":""}